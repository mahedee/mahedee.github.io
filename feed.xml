<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="https://mahedee.net/feed.xml" rel="self" type="application/atom+xml" /><link href="https://mahedee.net/" rel="alternate" type="text/html" /><updated>2025-11-01T18:11:34-04:00</updated><id>https://mahedee.net/feed.xml</id><title type="html">Think Simple</title><subtitle>Think Simple</subtitle><author><name>Mahedee Hasan</name></author><entry><title type="html">Binary Tree Traversal Algorithms in Java: Complete Guide to Preorder, Inorder, Postorder, and Level Order Traversals</title><link href="https://mahedee.net/Binary_Tree_Traversal_Algorithms_using_java/" rel="alternate" type="text/html" title="Binary Tree Traversal Algorithms in Java: Complete Guide to Preorder, Inorder, Postorder, and Level Order Traversals" /><published>2025-07-05T00:00:00-04:00</published><updated>2025-07-05T00:00:00-04:00</updated><id>https://mahedee.net/Binary_Tree_Traversal_Algorithms_using_java</id><content type="html" xml:base="https://mahedee.net/Binary_Tree_Traversal_Algorithms_using_java/"><![CDATA[<!-- Article banner image (optional) -->
<!-- ![Binary Tree Traversal Banner](./images/binary-tree-traversal-banner.png) -->

<h2 id="introduction">Introduction</h2>

<p>Binary tree traversal algorithms are <strong>fundamental techniques</strong> in computer science that allow us to systematically visit every node in a binary tree exactly once. These algorithms form the backbone of many tree-based operations and are essential for understanding more complex data structures and algorithms.</p>

<p>üå≥ <strong>What makes tree traversal special?</strong><br />
 Unlike linear data structures (arrays, linked lists), trees have multiple paths to reach different nodes, making the <strong>order of visitation</strong> crucial for different applications.</p>

<p>In this comprehensive guide, we‚Äôll explore:</p>
<ul>
  <li>‚úÖ <strong>Four major traversal algorithms</strong> with step-by-step explanations</li>
  <li>üîß <strong>Complete Java implementations</strong> ready to use</li>
  <li>üìä <strong>Performance analysis</strong> and complexity comparisons</li>
  <li>üéØ <strong>Real-world applications</strong> and use cases</li>
  <li>üí° <strong>Best practices</strong> and optimization techniques</li>
</ul>

<hr />

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
  <li><a href="#what-is-tree-traversal">What is Tree Traversal?</a></li>
  <li><a href="#types-of-tree-traversal">Types of Tree Traversal</a></li>
  <li><a href="#depth-first-traversals">Depth-First Traversals</a>
    <ul>
      <li><a href="#preorder-traversal">Preorder Traversal</a></li>
      <li><a href="#inorder-traversal">Inorder Traversal</a></li>
      <li><a href="#postorder-traversal">Postorder Traversal</a></li>
    </ul>
  </li>
  <li><a href="#breadth-first-traversal">Breadth-First Traversal</a></li>
  <li><a href="#complete-implementation">Complete Implementation</a></li>
  <li><a href="#performance-analysis">Performance Analysis</a></li>
  <li><a href="#practical-applications">Practical Applications</a></li>
  <li><a href="#comparison-guide">Comparison Guide</a></li>
  <li><a href="#advanced-techniques">Advanced Techniques</a></li>
  <li><a href="#conclusion">Conclusion</a></li>
</ol>

<hr />

<h2 id="what-is-tree-traversal">What is Tree Traversal?</h2>

<p>Tree traversal is the process of <strong>visiting each node</strong> in a tree data structure exactly once in a systematic way. Think of it as taking a tour through a family tree or organizational chart - you want to visit everyone, but the order matters depending on your purpose.</p>

<h3 id="key-characteristics">Key Characteristics:</h3>
<ul>
  <li><strong>üìç Systematic</strong>: Follows a consistent, predictable pattern</li>
  <li><strong>‚úÖ Complete</strong>: Visits every node exactly once</li>
  <li><strong>üîÑ Ordered</strong>: The sequence of visits matters for different applications</li>
  <li><strong>‚ö° Efficient</strong>: Optimized for specific use cases</li>
</ul>

<h3 id="why-traversal-order-matters">Why Traversal Order Matters:</h3>

<p align="center">
    <img src="/assets/images/posts/2025/org-diagram.png" alt="Organizational Chart" />
</p>

<p>Different traversal orders serve different purposes:
‚Ä¢ Top-down: CEO ‚Üí Managers ‚Üí Employees (authority flow)
‚Ä¢ Bottom-up: Employees ‚Üí Managers ‚Üí CEO (reporting flow)
‚Ä¢ Left-to-right: Process departments in sequence</p>

<hr />

<h2 id="types-of-tree-traversal">Types of Tree Traversal</h2>

<p>Tree traversal algorithms can be broadly categorized into <strong>two main types</strong>:</p>

<h3 id="-1-depth-first-traversal-dfs">üîΩ <strong>1. Depth-First Traversal (DFS)</strong></h3>
<p>Explores as far as possible along each branch before backtracking.</p>

<table>
  <thead>
    <tr>
      <th><strong>Type</strong></th>
      <th><strong>Order</strong></th>
      <th><strong>Best For</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Preorder</strong></td>
      <td>Root ‚Üí Left ‚Üí Right</td>
      <td>Tree copying, prefix expressions</td>
    </tr>
    <tr>
      <td><strong>Inorder</strong></td>
      <td>Left ‚Üí Root ‚Üí Right</td>
      <td>BST sorted output, expression trees</td>
    </tr>
    <tr>
      <td><strong>Postorder</strong></td>
      <td>Left ‚Üí Right ‚Üí Root</td>
      <td>Tree deletion, postfix expressions</td>
    </tr>
  </tbody>
</table>

<h3 id="-2-breadth-first-traversal-bfs">üîÑ <strong>2. Breadth-First Traversal (BFS)</strong></h3>
<p>Explores all nodes at the current depth before moving to the next level.</p>

<table>
  <thead>
    <tr>
      <th><strong>Type</strong></th>
      <th><strong>Order</strong></th>
      <th><strong>Best For</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Level Order</strong></td>
      <td>Level by level, left to right</td>
      <td>Tree printing, shortest path, BFS</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="depth-first-traversals">Depth-First Traversals</h2>

<p>Depth-first traversals use a <strong>recursive approach</strong> (or stack-based iterative approach) and differ in the order they visit the current node relative to its children.</p>

<h3 id="example-tree-for-all-demonstrations">Example Tree for All Demonstrations:</h3>
<p align="center">
    <img src="/assets/images/posts/2025/tree-for-demo2.png" alt="Tree Diagram" />
</p>

<hr />

<h2 id="preorder-traversal">Preorder Traversal</h2>
<p>Preorder traversal is a type of depth-first traversal where the current node is processed first, then the left subtree, followed by the right subtree.</p>

<h3 id="order-root--left-subtree--right-subtree"><strong>Order</strong>: Root ‚Üí Left Subtree ‚Üí Right Subtree</h3>

<p><strong>Think of it as</strong>: ‚ÄúVisit me first, then explore my left side, then my right side‚Äù</p>

<h3 id="-algorithm">üîß Algorithm:</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">preorder</span><span class="o">(</span><span class="n">node</span><span class="o">):</span>
    <span class="k">if</span> <span class="n">node</span> <span class="n">is</span> <span class="n">not</span> <span class="kc">null</span><span class="o">:</span>
        <span class="n">visit</span><span class="o">(</span><span class="n">node</span><span class="o">)</span>           <span class="c1">// ‚úÖ Process current node FIRST</span>
        <span class="n">preorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">)</span>   <span class="c1">// üîÑ Traverse left subtree</span>
        <span class="n">preorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">)</span>  <span class="c1">// üîÑ Traverse right subtree</span>
</code></pre></div></div>

<h3 id="preorder-result-a--b--d--g--e--c--f"><strong>Preorder Result</strong>: A ‚Üí B ‚Üí D ‚Üí G ‚Üí E ‚Üí C ‚Üí F</h3>

<h3 id="use-cases--applications"><strong>Use Cases &amp; Applications:</strong></h3>

<h4 id="1-tree-copying--cloning">1. <strong>Tree Copying &amp; Cloning</strong></h4>
<p><strong>Purpose</strong>: Creating an exact duplicate of a tree structure<br />
<strong>Why Preorder</strong>: Parent nodes must be created before their children to maintain proper structure<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input Tree</strong>: Company hierarchy with CEO ‚Üí Managers ‚Üí Employees</li>
  <li><strong>Process</strong>: Clone CEO first, then managers under CEO, then employees under each manager</li>
  <li><strong>Output</strong>: Identical organizational structure in a backup system</li>
</ul>

<h4 id="2-prefix-expression-evaluation">2. <strong>Prefix Expression Evaluation</strong></h4>
<p><strong>Purpose</strong>: Processing mathematical expressions in prefix notation (Polish notation)<br />
<strong>Why Preorder</strong>: Operators appear before operands, matching preorder‚Äôs root-first approach<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: <code class="language-plaintext highlighter-rouge">+ * 3 4 5</code> (meaning: (3 √ó 4) + 5)</li>
  <li><strong>Process</strong>: Process ‚Äò+‚Äô operator first, then evaluate ‚Äò* 3 4‚Äô, then add ‚Äò5‚Äô</li>
  <li><strong>Output</strong>: Result = 17</li>
</ul>

<h4 id="3-directory--file-system-traversal">3. <strong>Directory &amp; File System Traversal</strong></h4>
<p><strong>Purpose</strong>: Listing folder hierarchies with directories appearing before their contents<br />
<strong>Why Preorder</strong>: Folders must be displayed before showing what‚Äôs inside them<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Project folder structure</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üìÅ src/
  üìÅ main/
    üìÅ java/
      üìÑ Main.java
      üìÑ Utils.java
  üìÅ test/
    üìÑ TestMain.java
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Hierarchical directory listing where folders appear before their files</li>
</ul>

<h4 id="4-tree-serialization--storage">4. <strong>Tree Serialization &amp; Storage</strong></h4>
<p><strong>Purpose</strong>: Converting tree structure to a linear format for storage or transmission<br />
<strong>Why Preorder</strong>: Root-first order ensures proper reconstruction sequence<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input Tree</strong>: Binary tree with nodes [A, B, C, D, E]</li>
  <li><strong>Process</strong>: Serialize in preorder sequence with null markers</li>
  <li><strong>Output</strong>: <code class="language-plaintext highlighter-rouge">"A,B,D,null,null,E,null,null,C,null,null"</code></li>
</ul>

<h4 id="5-htmlxml-document-processing">5. <strong>HTML/XML Document Processing</strong></h4>
<p><strong>Purpose</strong>: Processing nested document structures where parent elements contain children<br />
<strong>Why Preorder</strong>: Parent tags must be opened before processing child elements<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: HTML structure <code class="language-plaintext highlighter-rouge">&lt;div&gt;&lt;p&gt;Text&lt;/p&gt;&lt;span&gt;More&lt;/span&gt;&lt;/div&gt;</code></li>
  <li><strong>Process</strong>: Process <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> first, then <code class="language-plaintext highlighter-rouge">&lt;p&gt;</code>, then <code class="language-plaintext highlighter-rouge">&lt;span&gt;</code></li>
  <li><strong>Output</strong>: Properly rendered HTML with correct nesting</li>
</ul>

<h4 id="6-game-scene-graph-rendering">6. <strong>Game Scene Graph Rendering</strong></h4>
<p><strong>Purpose</strong>: Rendering 3D scenes where parent transformations affect children<br />
<strong>Why Preorder</strong>: Parent transformations must be applied before children inherit them<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Character ‚Üí Body ‚Üí Arm ‚Üí Hand hierarchy</li>
  <li><strong>Process</strong>: Apply character position first, then body rotation, then arm movement</li>
  <li><strong>Output</strong>: Correctly transformed 3D model where hand moves with arm and body</li>
</ul>

<h4 id="7-organizational-chart-generation">7. <strong>Organizational Chart Generation</strong></h4>
<p><strong>Purpose</strong>: Creating visual representations of company or project hierarchies<br />
<strong>Why Preorder</strong>: Management levels must be established before showing subordinates<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Employee database with reporting relationships</li>
  <li><strong>Process</strong>: Display CEO first, then VPs, then managers, then individual contributors</li>
  <li><strong>Output</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CEO: John Smith
  VP Engineering: Jane Doe
    Senior Developer: Bob Wilson
    Junior Developer: Alice Brown
  VP Marketing: Mike Johnson
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="8-dependency-analysis--build-systems">8. <strong>Dependency Analysis &amp; Build Systems</strong></h4>
<p><strong>Purpose</strong>: Identifying what components depend on others in software projects<br />
<strong>Why Preorder</strong>: Dependencies must be identified before they can be resolved<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Module dependency tree where App ‚Üí Database ‚Üí Logger ‚Üí FileSystem</li>
  <li><strong>Process</strong>: Map dependencies starting from root application</li>
  <li><strong>Output</strong>: Dependency list showing what needs to be built first: [FileSystem, Logger, Database, App]</li>
</ul>

<h3 id="Ô∏è-complexity">‚è±Ô∏è <strong>Complexity:</strong></h3>
<ul>
  <li><strong>Time</strong>: O(n) - visits each node once</li>
  <li><strong>Space</strong>: O(h) - where h is tree height (recursion stack)</li>
</ul>

<hr />

<h2 id="inorder-traversal">Inorder Traversal</h2>

<p>Inorder traversal is a type of depth-first traversal where the left subtree is processed first, then the current node, followed by the right subtree.</p>

<h3 id="order-left-subtree--root--right-subtree"><strong>Order</strong>: Left Subtree ‚Üí Root ‚Üí Right Subtree</h3>

<p><strong>Think of it as</strong>: ‚ÄúExplore my left side first, then visit me, then my right side‚Äù</p>

<h3 id="algorithm">Algorithm:</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inorder</span><span class="o">(</span><span class="n">node</span><span class="o">):</span>
    <span class="k">if</span> <span class="n">node</span> <span class="n">is</span> <span class="n">not</span> <span class="kc">null</span><span class="o">:</span>
        <span class="n">inorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">)</span>    <span class="c1">// üîÑ Traverse left subtree FIRST</span>
        <span class="n">visit</span><span class="o">(</span><span class="n">node</span><span class="o">)</span>           <span class="c1">// ‚úÖ Process current node</span>
        <span class="n">inorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">)</span>   <span class="c1">// üîÑ Traverse right subtree</span>
</code></pre></div></div>

<h3 id="inorder-result-g--d--b--e--a--c--f"><strong>Inorder Result</strong>: G ‚Üí D ‚Üí B ‚Üí E ‚Üí A ‚Üí C ‚Üí F</h3>

<h3 id="use-cases--applications-1"><strong>Use Cases &amp; Applications:</strong></h3>

<h4 id="1-binary-search-tree-bst-data-retrieval">1. <strong>Binary Search Tree (BST) Data Retrieval</strong></h4>
<p><strong>Purpose</strong>: Extracting data from BSTs in sorted order without additional sorting<br />
<strong>Why Inorder</strong>: BST property ensures left &lt; root &lt; right, making inorder naturally sorted<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input BST</strong>: Employee database with salary nodes [50K, 30K, 70K, 25K, 35K, 60K, 80K]</li>
  <li><strong>Process</strong>: Traverse left subtree, visit root, traverse right subtree</li>
  <li><strong>Output</strong>: Sorted salary list [25K, 30K, 35K, 50K, 60K, 70K, 80K]</li>
</ul>

<h4 id="2-mathematical-expression-trees--infix-conversion">2. <strong>Mathematical Expression Trees &amp; Infix Conversion</strong></h4>
<p><strong>Purpose</strong>: Converting expression trees to human-readable infix notation<br />
<strong>Why Inorder</strong>: Matches natural mathematical notation where operators appear between operands<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Expression tree representing ((3 + 5) * 2)</li>
  <li><strong>Process</strong>: Traverse left operand, visit operator, traverse right operand</li>
  <li><strong>Output</strong>: ‚Äú((3 + 5) * 2)‚Äù - properly parenthesized infix expression</li>
</ul>

<h4 id="3-threaded-binary-tree-construction">3. <strong>Threaded Binary Tree Construction</strong></h4>
<p><strong>Purpose</strong>: Creating threading pointers for efficient traversal without recursion or stack<br />
<strong>Why Inorder</strong>: Threading follows inorder sequence to connect nodes<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Regular binary tree with nodes [A, B, C, D, E]</li>
  <li><strong>Process</strong>: Connect each node‚Äôs right pointer to its inorder successor when right child is null</li>
  <li><strong>Output</strong>: Threaded tree allowing O(1) space traversal</li>
</ul>

<h4 id="4-binary-search-tree-validation">4. <strong>Binary Search Tree Validation</strong></h4>
<p><strong>Purpose</strong>: Verifying if a binary tree satisfies BST properties<br />
<strong>Why Inorder</strong>: BST must produce strictly ascending sequence in inorder traversal<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input Tree 1</strong>: [10, 5, 15, 3, 7, 12, 18] ‚Üí Inorder: [3, 5, 7, 10, 12, 15, 18] ‚úÖ Valid BST</li>
  <li><strong>Input Tree 2</strong>: [10, 5, 15, 3, 7, 12, 6] ‚Üí Inorder: [3, 5, 7, 10, 6, 12, 15] ‚ùå Invalid (6 &lt; 10)</li>
  <li><strong>Output</strong>: Boolean validation result based on sequence ordering</li>
</ul>

<h4 id="5-range-query-processing">5. <strong>Range Query Processing</strong></h4>
<p><strong>Purpose</strong>: Finding all values within a specific range in sorted trees<br />
<strong>Why Inorder</strong>: Natural sorted order allows efficient range processing<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Customer age BST with range query [25, 35]</li>
  <li><strong>Process</strong>: Traverse inorder, collect nodes where 25 ‚â§ age ‚â§ 35</li>
  <li><strong>Output</strong>: All customers aged 25-35 in sorted order: [26, 28, 31, 34, 35]</li>
</ul>

<h4 id="6-database-index-scanning">6. <strong>Database Index Scanning</strong></h4>
<p><strong>Purpose</strong>: Efficient sequential access to database records in sorted order<br />
<strong>Why Inorder</strong>: Database B-tree indexes use inorder for range scans<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Product database with price index</li>
  <li><strong>Process</strong>: Inorder scan from $10 to $50 price range</li>
  <li><strong>Output</strong>: All products in price order: [$12 Widget, $25 Gadget, $45 Tool]</li>
</ul>

<h4 id="7-median--statistical-operations">7. <strong>Median &amp; Statistical Operations</strong></h4>
<p><strong>Purpose</strong>: Finding median, percentiles, and order statistics in BSTs<br />
<strong>Why Inorder</strong>: Sorted sequence makes statistical calculations straightforward<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Test scores BST [85, 72, 93, 68, 78, 90, 96]</li>
  <li><strong>Process</strong>: Inorder traversal gives sorted scores</li>
  <li><strong>Output</strong>: Median = 85 (middle element), 75th percentile = 93</li>
</ul>

<h4 id="8-tree-serialization-for-reconstruction">8. <strong>Tree Serialization for Reconstruction</strong></h4>
<p><strong>Purpose</strong>: Saving BST structure in a way that preserves sorting properties<br />
<strong>Why Inorder</strong>: Combined with preorder/postorder enables efficient BST reconstruction<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: BST with nodes [50, 30, 70, 20, 40, 60, 80]</li>
  <li><strong>Process</strong>: Store inorder sequence for sorted data, preorder for structure</li>
  <li><strong>Output</strong>: Inorder: [20,30,40,50,60,70,80] + Preorder: [50,30,20,40,70,60,80]</li>
</ul>

<h4 id="9-sorted-data-processing">9. <strong>Sorted Data Processing</strong></h4>
<p><strong>Purpose</strong>: Processing data that needs to maintain sorted order during operations<br />
<strong>Why Inorder</strong>: Eliminates need for separate sorting step<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Stock price BST updated throughout trading day</li>
  <li><strong>Process</strong>: Generate end-of-day report using inorder traversal</li>
  <li><strong>Output</strong>: Price movement report in ascending order: [AAPL:$150, GOOGL:$175, MSFT:$200]</li>
</ul>

<h4 id="10-successorpredecessor-finding">10. <strong>Successor/Predecessor Finding</strong></h4>
<p><strong>Purpose</strong>: Locating next/previous elements in sorted order<br />
<strong>Why Inorder</strong>: Natural sequence makes finding adjacent elements efficient<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Dictionary BST, find word after ‚Äúprogram‚Äù</li>
  <li><strong>Process</strong>: Use inorder sequence to identify next word</li>
  <li><strong>Output</strong>: Successor of ‚Äúprogram‚Äù is ‚Äúprogramming‚Äù</li>
</ul>

<h3 id="-special-property">‚≠ê <strong>Special Property:</strong></h3>
<p>For <strong>Binary Search Trees</strong>, inorder traversal <strong>always produces elements in sorted (ascending) order</strong>.</p>

<h3 id="Ô∏è-complexity-1">‚è±Ô∏è <strong>Complexity:</strong></h3>
<ul>
  <li><strong>Time</strong>: O(n)</li>
  <li><strong>Space</strong>: O(h)</li>
</ul>

<hr />

<h2 id="postorder-traversal">Postorder Traversal</h2>

<p>Postorder traversal is a type of depth-first traversal where the left subtree is processed first, then the right subtree, followed by the current node (root).</p>

<h3 id="order-left-subtree--right-subtree--root"><strong>Order</strong>: Left Subtree ‚Üí Right Subtree ‚Üí Root</h3>

<p><strong>Think of it as</strong>: ‚ÄúHandle my children first, then deal with me‚Äù</p>

<h3 id="-algorithm-1">üîß Algorithm:</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">postorder</span><span class="o">(</span><span class="n">node</span><span class="o">):</span>
    <span class="k">if</span> <span class="n">node</span> <span class="n">is</span> <span class="n">not</span> <span class="kc">null</span><span class="o">:</span>
        <span class="n">postorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">)</span>   <span class="c1">// üîÑ Traverse left subtree FIRST</span>
        <span class="n">postorder</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">)</span>  <span class="c1">// üîÑ Traverse right subtree SECOND</span>
        <span class="n">visit</span><span class="o">(</span><span class="n">node</span><span class="o">)</span>            <span class="c1">// ‚úÖ Process current node LAST</span>
</code></pre></div></div>

<h3 id="postorder-result-g--d--e--b--f--c--a"><strong>Postorder Result</strong>: G ‚Üí D ‚Üí E ‚Üí B ‚Üí F ‚Üí C ‚Üí A</h3>

<h3 id="use-cases--applications-2"><strong>Use Cases &amp; Applications:</strong></h3>

<h4 id="1-tree-deletion--memory-cleanup">1. <strong>Tree Deletion &amp; Memory Cleanup</strong></h4>
<p><strong>Purpose</strong>: Safely deleting tree nodes by removing children before parents<br />
<strong>Why Postorder</strong>: Children must be deleted before parent to avoid memory leaks and dangling pointers. Dangling pointers mean references to nodes that have already been deleted, which can lead to errors or crashes if accessed later.<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input Tree</strong>: File system tree with folders and files</li>
  <li><strong>Process</strong>: Delete all files first, then empty folders, finally root folder</li>
  <li><strong>Output</strong>: Clean memory deallocation: Files ‚Üí Subfolders ‚Üí Main folder ‚Üí Root</li>
</ul>

<h4 id="2-postfix-expression-evaluation-reverse-polish-notation">2. <strong>Postfix Expression Evaluation (Reverse Polish Notation)</strong></h4>
<p><strong>Purpose</strong>: Evaluating mathematical expressions in postfix notation<br />
<strong>Why Postorder</strong>: Operands must be processed before operators, matching postfix structure<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Expression tree for ‚Äú3 4 + 2 *‚Äù (meaning: (3 + 4) √ó 2)</li>
  <li><strong>Process</strong>: Calculate 3, then 4, then +, then 2, finally *</li>
  <li><strong>Output</strong>: Result = 14 (first 3+4=7, then 7√ó2=14)</li>
</ul>

<h4 id="3-directory-size-calculation">3. <strong>Directory Size Calculation</strong></h4>
<p><strong>Purpose</strong>: Computing folder sizes by calculating subfolder sizes first<br />
<strong>Why Postorder</strong>: Must know children sizes before calculating parent size<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Project folder with subfolders</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üìÑ file1.txt (2KB) 
üìÑ file2.java (5KB)
üìÅ src/ = 7KB (calculated after files)
üìÅ project/ = 7KB (calculated after src/)
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Total project size: 7KB</li>
</ul>

<h4 id="4-dependency-resolution--build-systems">4. <strong>Dependency Resolution &amp; Build Systems</strong></h4>
<p><strong>Purpose</strong>: Processing dependencies before the components that depend on them<br />
<strong>Why Postorder</strong>: Dependencies must be built/resolved before their dependents<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Software modules: App depends on Database, Database depends on Logger</li>
  <li><strong>Process</strong>: Build Logger first, then Database, finally App</li>
  <li><strong>Output</strong>: Build order: [Logger, Database, App]</li>
</ul>

<h4 id="5-garbage-collection--resource-cleanup">5. <strong>Garbage Collection &amp; Resource Cleanup</strong></h4>
<p><strong>Purpose</strong>: Cleaning up system resources in proper order<br />
<strong>Why Postorder</strong>: Child resources must be freed before parent resources<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Process tree with parent and child processes</li>
  <li><strong>Process</strong>: Terminate child processes first, then parent processes</li>
  <li><strong>Output</strong>: Clean shutdown without orphaned processes</li>
</ul>

<h4 id="6-bottom-up-tree-calculations">6. <strong>Bottom-up Tree Calculations</strong></h4>
<p><strong>Purpose</strong>: Computing values that depend on children‚Äôs computed values<br />
<strong>Why Postorder</strong>: Parent calculations need children‚Äôs results<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Employee hierarchy with salary calculations</li>
  <li><strong>Process</strong>: Calculate team budgets bottom-up</li>
  <li><strong>Output</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Employee A: $50K
Employee B: $60K  
Manager: $110K (team total)
Director: $170K (includes manager + own salary)
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="7-game-object-destruction">7. <strong>Game Object Destruction</strong></h4>
<p><strong>Purpose</strong>: Destroying game objects and their components in correct order<br />
<strong>Why Postorder</strong>: Child objects must be destroyed before parent containers<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Character with weapons, armor, and inventory items</li>
  <li><strong>Process</strong>: Destroy items first, then equipment, finally character</li>
  <li><strong>Output</strong>: Clean game object removal without references to destroyed objects</li>
</ul>

<h4 id="8-abstract-syntax-tree-ast-code-generation">8. <strong>Abstract Syntax Tree (AST) Code Generation</strong></h4>
<p><strong>Purpose</strong>: Generating assembly or machine code from expression trees<br />
<strong>Why Postorder</strong>: Operands must be loaded before operations can be performed<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Expression tree for ‚Äúa + b * c‚Äù</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>LOAD b
LOAD c  
MULTIPLY
LOAD a
ADD
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Stack-based code where operands are processed before operators</li>
</ul>

<h4 id="9-tree-validation--structure-checking">9. <strong>Tree Validation &amp; Structure Checking</strong></h4>
<p><strong>Purpose</strong>: Validating tree properties by checking children first<br />
<strong>Why Postorder</strong>: Parent validity often depends on children being valid<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Binary tree to check if it‚Äôs a complete binary tree</li>
  <li><strong>Process</strong>: Validate leaf nodes first, then internal nodes, finally root</li>
  <li><strong>Output</strong>: Boolean result after checking all subtrees</li>
</ul>

<h4 id="10-tree-transformation--reconstruction">10. <strong>Tree Transformation &amp; Reconstruction</strong></h4>
<p><strong>Purpose</strong>: Converting tree structures while preserving relationships<br />
<strong>Why Postorder</strong>: Children must be transformed before parent transformation can occur<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Parse tree to be converted to different format</li>
  <li><strong>Process</strong>: Transform leaf nodes first, then internal nodes, finally root</li>
  <li><strong>Output</strong>: Transformed tree maintaining structural integrity</li>
</ul>

<h4 id="11-ui-component-disposal">11. <strong>UI Component Disposal</strong></h4>
<p><strong>Purpose</strong>: Properly disposing user interface components and their resources<br />
<strong>Why Postorder</strong>: Child UI elements must be disposed before parent containers<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Window with buttons, text fields, and panels</li>
  <li><strong>Process</strong>: Dispose buttons and text fields first, then panels, finally window</li>
  <li><strong>Output</strong>: Clean UI shutdown without memory leaks</li>
</ul>

<h4 id="12-database-transaction-rollback">12. <strong>Database Transaction Rollback</strong></h4>
<p><strong>Purpose</strong>: Rolling back nested transactions in reverse order<br />
<strong>Why Postorder</strong>: Inner transactions must be rolled back before outer transactions<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Nested transaction tree with savepoints</li>
  <li><strong>Process</strong>: Rollback deepest savepoints first, then parent transactions</li>
  <li><strong>Output</strong>: Database restored to consistent state before transaction began</li>
</ul>

<h3 id="Ô∏è-complexity-2">‚è±Ô∏è <strong>Complexity:</strong></h3>
<ul>
  <li><strong>Time</strong>: O(n)</li>
  <li><strong>Space</strong>: O(h)</li>
</ul>

<hr />

<h2 id="breadth-first-traversal">Breadth-First Traversal</h2>
<p>Breadth-first traversal (BFS) explores all nodes at the present depth level before moving on to nodes at the next depth level. It uses a queue to keep track of nodes to visit.</p>

<h3 id="level-order-traversal">Level Order Traversal</h3>
<p>Level order traversal is a type of breadth-first traversal where nodes are visited level by level, starting from the root and moving left to right.</p>

<h3 id="order-level-by-level-left-to-right"><strong>Order</strong>: Level by level, left to right</h3>

<p><strong>Think of it as</strong>: ‚ÄúVisit everyone at my level, then go to the next level‚Äù</p>

<h3 id="-algorithm-2">üîß Algorithm:</h3>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">levelOrder</span><span class="o">(</span><span class="n">root</span><span class="o">):</span>
    <span class="k">if</span> <span class="n">root</span> <span class="n">is</span> <span class="kc">null</span><span class="o">:</span>
        <span class="k">return</span>
    
    <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Queue</span><span class="o">()</span>
    <span class="n">queue</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="n">root</span><span class="o">)</span>
    
    <span class="k">while</span> <span class="n">queue</span> <span class="n">is</span> <span class="n">not</span> <span class="nl">empty:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="na">dequeue</span><span class="o">()</span>
        <span class="n">visit</span><span class="o">(</span><span class="n">node</span><span class="o">)</span>                     <span class="c1">// ‚úÖ Process current node</span>
        
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="na">left</span> <span class="n">is</span> <span class="n">not</span> <span class="kc">null</span><span class="o">:</span>       <span class="c1">// üì• Add left child to queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">)</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="na">right</span> <span class="n">is</span> <span class="n">not</span> <span class="kc">null</span><span class="o">:</span>      <span class="c1">// üì• Add right child to queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="na">enqueue</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">)</span>
</code></pre></div></div>

<h3 id="level-order-result-a--b--c--d--e--f--g"><strong>Level Order Result</strong>: A ‚Üí B ‚Üí C ‚Üí D ‚Üí E ‚Üí F ‚Üí G</h3>

<h3 id="use-cases--applications-3"><strong>Use Cases &amp; Applications:</strong></h3>

<h4 id="1-tree-printing--visualization">1. <strong>Tree Printing &amp; Visualization</strong></h4>
<p><strong>Purpose</strong>: Displaying tree structure level by level for easy understanding<br />
<strong>Why Level Order</strong>: Natural visual representation matches how humans perceive hierarchies<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Company organization tree</li>
  <li><strong>Process</strong>: Print CEO first, then VPs, then managers, then employees</li>
  <li><strong>Output</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 0: [CEO]
Level 1: [VP Sales, VP Engineering]  
Level 2: [Sales Manager, Dev Manager, QA Manager]
Level 3: [Sales Rep 1, Sales Rep 2, Developer 1, Developer 2, Tester 1]
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="2-shortest-path--minimum-depth-finding">2. <strong>Shortest Path &amp; Minimum Depth Finding</strong></h4>
<p><strong>Purpose</strong>: Finding shortest distance or minimum steps to reach a target<br />
<strong>Why Level Order</strong>: BFS guarantees finding shortest path first<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Family tree, find shortest relationship between two people</li>
  <li><strong>Process</strong>: Explore immediate family first, then extended family</li>
  <li><strong>Output</strong>: ‚ÄúAlice and Bob are cousins (3 steps apart)‚Äù vs ‚ÄúAlice and Charlie are siblings (2 steps apart)‚Äù</li>
</ul>

<h4 id="3-tree-width--level-analysis">3. <strong>Tree Width &amp; Level Analysis</strong></h4>
<p><strong>Purpose</strong>: Finding maximum width and analyzing tree structure per level<br />
<strong>Why Level Order</strong>: Processes entire levels at once for width calculation<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Website navigation menu tree</li>
  <li><strong>Process</strong>: Count items at each menu level</li>
  <li><strong>Output</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 1: 3 main categories (Home, Products, About)
Level 2: 8 subcategories (max width = 8)
Level 3: 12 specific pages
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="4-tree-serialization--level-wise-storage">4. <strong>Tree Serialization &amp; Level-wise Storage</strong></h4>
<p><strong>Purpose</strong>: Storing tree data in level-order format for reconstruction<br />
<strong>Why Level Order</strong>: Enables breadth-first reconstruction and balanced loading<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Binary tree [A, B, C, D, E, null, F]</li>
  <li><strong>Process</strong>: Store nodes level by level with null markers</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td><strong>Output</strong>: ‚ÄúA</td>
          <td>B,C</td>
          <td>D,E,null,F</td>
          <td>null,null,null,null‚Äù (levels separated by</td>
          <td>)</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h4 id="5-priority-processing--urgent-task-handling">5. <strong>Priority Processing &amp; Urgent Task Handling</strong></h4>
<p><strong>Purpose</strong>: Processing items by priority levels (urgent first, then important, then normal)<br />
<strong>Why Level Order</strong>: Higher priority levels processed completely before lower ones<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Hospital patient queue with priority levels</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 1 (Critical): [Heart Attack, Stroke]
Level 2 (Urgent): [Broken Bone, Deep Cut]  
Level 3 (Normal): [Check-up, Vaccination]
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: All critical patients treated first, then urgent, then normal</li>
</ul>

<h4 id="6-game-level-design--wave-spawning">6. <strong>Game Level Design &amp; Wave Spawning</strong></h4>
<p><strong>Purpose</strong>: Spawning enemies or challenges in waves/levels<br />
<strong>Why Level Order</strong>: Each wave must be completed before next wave starts<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Tower defense game enemy tree</li>
  <li><strong>Process</strong>: Spawn Wave 1 enemies, then Wave 2, then Wave 3</li>
  <li><strong>Output</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Wave 1: [3 Basic Enemies] (must be defeated first)
Wave 2: [2 Advanced Enemies, 1 Tank] 
Wave 3: [1 Boss Enemy]
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="7-educational-content-progression">7. <strong>Educational Content Progression</strong></h4>
<p><strong>Purpose</strong>: Learning prerequisites where each level builds on previous level<br />
<strong>Why Level Order</strong>: Students must complete current level before advancing<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Programming course curriculum tree</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 1: [Programming Basics]
Level 2: [Data Types, Variables] 
Level 3: [Arrays, Functions, Objects]
Level 4: [Advanced Data Structures]
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Sequential learning path ensuring solid foundation</li>
</ul>

<h4 id="8-organizational-communication--announcements">8. <strong>Organizational Communication &amp; Announcements</strong></h4>
<p><strong>Purpose</strong>: Distributing information through hierarchy levels<br />
<strong>Why Level Order</strong>: Information flows level by level through management chain<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Company announcement about policy change</li>
  <li><strong>Process</strong>: CEO tells VPs, VPs tell Directors, Directors tell Managers, Managers tell employees</li>
  <li><strong>Output</strong>: Systematic information distribution ensuring everyone at each level is informed</li>
</ul>

<h4 id="9-breadth-first-search-in-decision-trees">9. <strong>Breadth-First Search in Decision Trees</strong></h4>
<p><strong>Purpose</strong>: Exploring all options at current decision level before going deeper<br />
<strong>Why Level Order</strong>: Avoids getting stuck in deep but poor decision paths<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Investment decision tree</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 1: [Stocks, Bonds, Real Estate] (explore all first)
Level 2: [Tech Stocks, Blue Chip | Government Bonds, Corporate Bonds | Residential, Commercial]
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Comprehensive analysis of all options at each decision level</li>
</ul>

<h4 id="10-network-topology--router-configuration">10. <strong>Network Topology &amp; Router Configuration</strong></h4>
<p><strong>Purpose</strong>: Configuring network devices level by level from core to edge<br />
<strong>Why Level Order</strong>: Core routers must be configured before distribution and access layers<br />
<strong>Example</strong>:</p>
<ul>
  <li><strong>Input</strong>: Corporate network infrastructure</li>
  <li><strong>Process</strong>:
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Level 1: [Core Router] (configure first)
Level 2: [Distribution Switch A, Distribution Switch B]
Level 3: [Access Switch 1, Access Switch 2, Access Switch 3, Access Switch 4]
</code></pre></div>    </div>
  </li>
  <li><strong>Output</strong>: Properly configured network with connectivity flowing from core outward</li>
</ul>

<h3 id="complexity"><strong>Complexity:</strong></h3>
<ul>
  <li><strong>Time</strong>: O(n)</li>
  <li><strong>Space</strong>: O(w) - where w is the maximum width of the tree</li>
</ul>

<hr />

<h2 id="complete-implementation-of-inorder-preorder-postorder-and-level-order-traversals">Complete Implementation of Inorder, Preorder, Postorder, and Level Order Traversals</h2>

<h3 id="create-a-treenode-class---the-building-block">Create a TreeNode Class - The Building Block</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">import</span> <span class="nn">java.util.*</span><span class="o">;</span>

<span class="cm">/**
 * TreeNode represents a single node in our binary tree
 * Think of it as a container that holds data and references to children
 */</span>
<span class="kd">class</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="no">E</span> <span class="n">element</span><span class="o">;</span>              <span class="c1">// üì¶ The data stored in this node</span>
    <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">left</span><span class="o">;</span>       <span class="c1">// ‚¨ÖÔ∏è Points to the left child</span>
    <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">right</span><span class="o">;</span>      <span class="c1">// ‚û°Ô∏è Points to the right child</span>
    <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">;</span>     <span class="c1">// ‚¨ÜÔ∏è Points to the parent (optional)</span>
    
    <span class="c1">// Create a new node with data</span>
    <span class="kd">public</span> <span class="nf">TreeNode</span><span class="o">(</span><span class="no">E</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">left</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Create a new node with data and parent reference</span>
    <span class="kd">public</span> <span class="nf">TreeNode</span><span class="o">(</span><span class="no">E</span> <span class="n">element</span><span class="o">,</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">left</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
    
    
    <span class="c1">// Override toString for easy printing of node data</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="create-a-binarytree-class-to-implement-all-four-traversal-algorithms">Create a BinaryTree Class to implement all four traversal algorithms</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * BinaryTree implementation with all four traversal methods
 * Supports both recursive and iterative approaches
 */</span>
<span class="kd">class</span> <span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">root</span><span class="o">;</span>  <span class="c1">// The root of our tree</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">size</span><span class="o">;</span>          <span class="c1">// Number of nodes in the tree</span>
    
    <span class="kd">public</span> <span class="nf">BinaryTree</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">root</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">size</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Tree Construction Methods</span>
    <span class="c1">// Here IllegalStateException is an unchecked exception that indicates the tree already has a root</span>
    <span class="c1">// serves as explicit documentation to inform developers about potential exceptions. But it works fine without it.</span>
    <span class="kd">public</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">addRoot</span><span class="o">(</span><span class="no">E</span> <span class="n">element</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IllegalStateException</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">root</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalStateException</span><span class="o">(</span><span class="s">"Tree already has a root"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">root</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeNode</span><span class="o">&lt;&gt;(</span><span class="n">element</span><span class="o">);</span>
        <span class="n">size</span><span class="o">++;</span>
        <span class="k">return</span> <span class="n">root</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">addLeft</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">,</span> <span class="no">E</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">left</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Node already has a left child"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeNode</span><span class="o">&lt;&gt;(</span><span class="n">element</span><span class="o">,</span> <span class="n">parent</span><span class="o">);</span>
        <span class="n">parent</span><span class="o">.</span><span class="na">left</span> <span class="o">=</span> <span class="n">child</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
        <span class="k">return</span> <span class="n">child</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">public</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">addRight</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">parent</span><span class="o">,</span> <span class="no">E</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">IllegalArgumentException</span><span class="o">(</span><span class="s">"Node already has a right child"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TreeNode</span><span class="o">&lt;&gt;(</span><span class="n">element</span><span class="o">,</span> <span class="n">parent</span><span class="o">);</span>
        <span class="n">parent</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">child</span><span class="o">;</span>
        <span class="n">size</span><span class="o">++;</span>
        <span class="k">return</span> <span class="n">child</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Basic Tree Properties</span>
    <span class="c1">// These methods provide basic information about the tree structure</span>
    <span class="c1">// Not required for all the cases, but useful for understanding the tree</span>
    <span class="kd">public</span> <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">getRoot</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">root</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">size</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEmpty</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="o">;</span> <span class="o">}</span>
    
    <span class="c1">// PREORDER TRAVERSAL: Root ‚Üí Left ‚Üí Right</span>
    <span class="c1">// Public method to setup, initialize and call the actual algorithm</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">preorderTraversal</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">preorderHelper</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Core algorithm for preorder traversal</span>
    <span class="c1">// Recursively visit the root first, then left subtree, then right subtree</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">preorderHelper</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">node</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">node</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">element</span><span class="o">);</span>                    <span class="c1">// ‚úÖ Visit root first</span>
            <span class="n">preorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>          <span class="c1">// üîÑ Then left subtree</span>
            <span class="n">preorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>         <span class="c1">// üîÑ Finally right subtree</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// INORDER TRAVERSAL: Left ‚Üí Root ‚Üí Right</span>
    <span class="c1">// Public method to setup, initialize and call the actual algorithm</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">inorderTraversal</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">inorderHelper</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    

    <span class="c1">// Core algorithm for inorder traversal</span>
    <span class="c1">// Recursively visit the left subtree first, then root, then right subtree</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">inorderHelper</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">node</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">node</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">inorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>           <span class="c1">// üîÑ Left subtree first</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">element</span><span class="o">);</span>                   <span class="c1">// ‚úÖ Then visit root</span>
            <span class="n">inorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>          <span class="c1">// üîÑ Finally right subtree</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// üîç POSTORDER TRAVERSAL: Left ‚Üí Right ‚Üí Root</span>
    <span class="c1">// Public method to setup, initialize and call the actual algorithm</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">postorderTraversal</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">postorderHelper</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// Core algorithm for postorder traversal</span>
    <span class="c1">// Recursively visit the left subtree first, then right subtree, then root</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">postorderHelper</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">node</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">node</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">postorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>         <span class="c1">// üîÑ Left subtree first</span>
            <span class="n">postorderHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="n">result</span><span class="o">);</span>        <span class="c1">// üîÑ Then right subtree</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">element</span><span class="o">);</span>                   <span class="c1">// ‚úÖ Finally visit root</span>
        <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// LEVEL ORDER TRAVERSAL: Level by level</span>
    <span class="c1">// Also known as Breadth-First Search (BFS)</span>

    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="nf">levelOrderTraversal</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
        
        <span class="c1">// Start from the root and use a queue to explore each level</span>
        <span class="nc">Queue</span><span class="o">&lt;</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;&gt;</span> <span class="n">queue</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LinkedList</span><span class="o">&lt;&gt;();</span>
        <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">root</span><span class="o">);</span>
        
        <span class="k">while</span> <span class="o">(!</span><span class="n">queue</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">())</span> <span class="o">{</span>
            <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">current</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="na">poll</span><span class="o">();</span>
            <span class="n">result</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">element</span><span class="o">);</span>                <span class="c1">// ‚úÖ Visit current node and add to result list</span>
            
            <span class="c1">// Add children to queue for next level</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">left</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">left</span><span class="o">);</span> <span class="c1">// Add left child to queue</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">queue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">current</span><span class="o">.</span><span class="na">right</span><span class="o">);</span> <span class="c1">// Add right child to queue</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="c1">// üé® Tree Visualization</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printTreeStructure</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üå≥ Tree Structure:"</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"(empty tree)"</span><span class="o">);</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="n">printHelper</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">printHelper</span><span class="o">(</span><span class="nc">TreeNode</span><span class="o">&lt;</span><span class="no">E</span><span class="o">&gt;</span> <span class="n">node</span><span class="o">,</span> <span class="nc">String</span> <span class="n">prefix</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">isLast</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">node</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="o">(</span><span class="n">isLast</span> <span class="o">?</span> <span class="s">"‚îî‚îÄ‚îÄ "</span> <span class="o">:</span> <span class="s">"‚îú‚îÄ‚îÄ "</span><span class="o">)</span> <span class="o">+</span> <span class="n">node</span><span class="o">.</span><span class="na">element</span><span class="o">);</span>
            
            <span class="c1">// üìù Handle children</span>
            <span class="kt">boolean</span> <span class="n">hasLeft</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">left</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="kt">boolean</span> <span class="n">hasRight</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
            
            <span class="k">if</span> <span class="o">(</span><span class="n">hasLeft</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">printHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="o">(</span><span class="n">isLast</span> <span class="o">?</span> <span class="s">"    "</span> <span class="o">:</span> <span class="s">"‚îÇ   "</span><span class="o">),</span> <span class="o">!</span><span class="n">hasRight</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">hasRight</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">printHelper</span><span class="o">(</span><span class="n">node</span><span class="o">.</span><span class="na">right</span><span class="o">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="o">(</span><span class="n">isLast</span> <span class="o">?</span> <span class="s">"    "</span> <span class="o">:</span> <span class="s">"‚îÇ   "</span><span class="o">),</span> <span class="kc">true</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="-complete-demo-with-practical-examples">üöÄ Complete Demo with Practical Examples</h3>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TreeTraversalDemo</span> <span class="o">{</span>
    
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"BINARY TREE TRAVERSAL ALGORITHMS DEMO"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Author: Mahedee Hasan"</span><span class="o">);</span>

        <span class="c1">//  Creates a string by repeating the double horizontal line character (‚ïê) 50 times</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"‚ïê"</span><span class="o">.</span><span class="na">repeat</span><span class="o">(</span><span class="mi">50</span><span class="o">));</span>
        
        <span class="c1">// Build example tree</span>
        <span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">tree</span> <span class="o">=</span> <span class="n">buildExampleTree</span><span class="o">();</span>
        
        <span class="c1">// Show tree structure</span>
        <span class="c1">// Show original tree in a structured format</span>
        <span class="n">tree</span><span class="o">.</span><span class="na">printTreeStructure</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
        
        <span class="c1">// Demonstrate all traversals</span>
        <span class="n">demonstrateTraversals</span><span class="o">(</span><span class="n">tree</span><span class="o">);</span>
        
        <span class="c1">// üìä Show practical applications</span>
        <span class="n">demonstratePracticalApplications</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">buildExampleTree</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Building this tree:</span>
        <span class="c1">//       A</span>
        <span class="c1">//      / \</span>
        <span class="c1">//     B   C</span>
        <span class="c1">//    / \   \</span>
        <span class="c1">//   D   E   F</span>
        <span class="c1">//  /</span>
        <span class="c1">// G</span>
        
        <span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">tree</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BinaryTree</span><span class="o">&lt;&gt;();</span>
        
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addRoot</span><span class="o">(</span><span class="s">"A"</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s">"B"</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s">"C"</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="s">"D"</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">b</span><span class="o">,</span> <span class="s">"E"</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">c</span><span class="o">,</span> <span class="s">"F"</span><span class="o">);</span>
        <span class="n">tree</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">d</span><span class="o">,</span> <span class="s">"G"</span><span class="o">);</span>
        
        <span class="k">return</span> <span class="n">tree</span><span class="o">;</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">demonstrateTraversals</span><span class="o">(</span><span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">tree</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"TRAVERSAL RESULTS:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"‚îÄ"</span><span class="o">.</span><span class="na">repeat</span><span class="o">(</span><span class="mi">40</span><span class="o">));</span>
        
        <span class="c1">// Preorder traversal</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">preorder</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">preorderTraversal</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Preorder  (Root‚ÜíLeft‚ÜíRight): "</span> <span class="o">+</span> <span class="n">preorder</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Use case: Tree copying, directory listing"</span><span class="o">);</span>
        <span class="c1">// Output: [A, B, D, G, E, C, F]</span>

        <span class="c1">// Inorder</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">inorder</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">inorderTraversal</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üü© Inorder   (Left‚ÜíRoot‚ÜíRight): "</span> <span class="o">+</span> <span class="n">inorder</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   üí° Use case: BST sorted output, expression trees"</span><span class="o">);</span>
        
        <span class="c1">// Postorder</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">postorder</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">postorderTraversal</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üü® Postorder (Left‚ÜíRight‚ÜíRoot): "</span> <span class="o">+</span> <span class="n">postorder</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   üí° Use case: Tree deletion, folder size calculation"</span><span class="o">);</span>
        
        <span class="c1">// Level Order</span>
        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">levelOrder</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="na">levelOrderTraversal</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üü™ Level Order (Top‚ÜíBottom): "</span> <span class="o">+</span> <span class="n">levelOrder</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   üí° Use case: BFS, shortest path, tree printing"</span><span class="o">);</span>
        
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">demonstratePracticalApplications</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üéØ PRACTICAL APPLICATIONS:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"‚îÄ"</span><span class="o">.</span><span class="na">repeat</span><span class="o">(</span><span class="mi">40</span><span class="o">));</span>
        
        <span class="c1">// BST example</span>
        <span class="n">demonstrateBSTSorting</span><span class="o">();</span>
        
        <span class="c1">// Expression tree example</span>
        <span class="n">demonstrateExpressionEvaluation</span><span class="o">();</span>
        
        <span class="c1">// File system example</span>
        <span class="n">demonstrateFileSystemOperations</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">demonstrateBSTSorting</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üìä Binary Search Tree Sorting:"</span><span class="o">);</span>
        
        <span class="nc">BinaryTree</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">bst</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BinaryTree</span><span class="o">&lt;&gt;();</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">root</span> <span class="o">=</span> <span class="n">bst</span><span class="o">.</span><span class="na">addRoot</span><span class="o">(</span><span class="mi">50</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">left</span> <span class="o">=</span> <span class="n">bst</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="mi">30</span><span class="o">);</span>
        <span class="nc">TreeNode</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">right</span> <span class="o">=</span> <span class="n">bst</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="mi">70</span><span class="o">);</span>
        <span class="n">bst</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
        <span class="n">bst</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">left</span><span class="o">,</span> <span class="mi">40</span><span class="o">);</span>
        <span class="n">bst</span><span class="o">.</span><span class="na">addLeft</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="mi">60</span><span class="o">);</span>
        <span class="n">bst</span><span class="o">.</span><span class="na">addRight</span><span class="o">(</span><span class="n">right</span><span class="o">,</span> <span class="mi">80</span><span class="o">);</span>
        
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Input BST: [50, 30, 70, 20, 40, 60, 80]"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Inorder:   "</span> <span class="o">+</span> <span class="n">bst</span><span class="o">.</span><span class="na">inorderTraversal</span><span class="o">());</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   ‚úÖ Automatically sorted!"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">demonstrateExpressionEvaluation</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üßÆ Expression Tree Evaluation:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Expression: (3 + 5) * 2"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Inorder:    3 + 5 * 2     (infix notation)"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Postorder:  3 5 + 2 *     (postfix notation)"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   ‚úÖ Different traversals = Different notations!"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
    
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">demonstrateFileSystemOperations</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"üìÅ File System Operations:"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Preorder:   List directories before contents"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Postorder:  Calculate sizes (children first)"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   Level Order: Show hierarchy level by level"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"   ‚úÖ Each traversal serves different purposes!"</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="-expected-output">üìã Expected Output</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>üå≥ BINARY TREE TRAVERSAL ALGORITHMS DEMO
Author: Mahedee Hasan
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üå≥ Tree Structure:
‚îî‚îÄ‚îÄ A
    ‚îú‚îÄ‚îÄ B
    ‚îÇ   ‚îú‚îÄ‚îÄ D
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ G
    ‚îÇ   ‚îî‚îÄ‚îÄ E
    ‚îî‚îÄ‚îÄ C
        ‚îî‚îÄ‚îÄ F

üîç TRAVERSAL RESULTS:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üü¶ Preorder  (Root‚ÜíLeft‚ÜíRight): [A, B, D, G, E, C, F]
   üí° Use case: Tree copying, directory listing
üü© Inorder   (Left‚ÜíRoot‚ÜíRight): [G, D, B, E, A, C, F]
   üí° Use case: BST sorted output, expression trees
üü® Postorder (Left‚ÜíRight‚ÜíRoot): [G, D, E, B, F, C, A]
   üí° Use case: Tree deletion, folder size calculation
üü™ Level Order (Top‚ÜíBottom): [A, B, C, D, E, F, G]
   üí° Use case: BFS, shortest path, tree printing

üéØ PRACTICAL APPLICATIONS:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìä Binary Search Tree Sorting:
   Input BST: [50, 30, 70, 20, 40, 60, 80]
   Inorder:   [20, 30, 40, 50, 60, 70, 80]
   ‚úÖ Automatically sorted!

üßÆ Expression Tree Evaluation:
   Expression: (3 + 5) * 2
   Inorder:    3 + 5 * 2     (infix notation)
   Postorder:  3 5 + 2 *     (postfix notation)
   ‚úÖ Different traversals = Different notations!

üìÅ File System Operations:
   Preorder:   List directories before contents
   Postorder:  Calculate sizes (children first)
   Level Order: Show hierarchy level by level
   ‚úÖ Each traversal serves different purposes!
</code></pre></div></div>

<hr />

<h2 id="performance-analysis">Performance Analysis</h2>

<h3 id="-complexity-comparison">üìä Complexity Comparison</h3>

<table>
  <thead>
    <tr>
      <th><strong>Traversal</strong></th>
      <th><strong>Time Complexity</strong></th>
      <th><strong>Space Complexity</strong></th>
      <th><strong>Best Use Case</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Preorder</strong></td>
      <td>O(n)</td>
      <td>O(h)</td>
      <td>Tree copying, prefix expressions</td>
    </tr>
    <tr>
      <td><strong>Inorder</strong></td>
      <td>O(n)</td>
      <td>O(h)</td>
      <td>BST sorted output, expression trees</td>
    </tr>
    <tr>
      <td><strong>Postorder</strong></td>
      <td>O(n)</td>
      <td>O(h)</td>
      <td>Tree deletion, postfix expressions</td>
    </tr>
    <tr>
      <td><strong>Level Order</strong></td>
      <td>O(n)</td>
      <td>O(w)</td>
      <td>Level-wise processing, BFS</td>
    </tr>
  </tbody>
</table>

<p><strong>Where:</strong></p>
<ul>
  <li><strong>n</strong> = number of nodes</li>
  <li><strong>h</strong> = height of the tree (O(log n) for balanced, O(n) for skewed)</li>
  <li><strong>w</strong> = maximum width of the tree</li>
</ul>

<h3 id="-performance-considerations">‚ö° Performance Considerations</h3>

<h4 id="-recursive-vs-iterative">üîÑ <strong>Recursive vs Iterative:</strong></h4>

<table>
  <thead>
    <tr>
      <th><strong>Approach</strong></th>
      <th><strong>Pros</strong></th>
      <th><strong>Cons</strong></th>
      <th><strong>Best For</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Recursive</strong></td>
      <td>‚úÖ Intuitive, clean code</td>
      <td>‚ùå Stack overflow risk</td>
      <td>Small to medium trees</td>
    </tr>
    <tr>
      <td><strong>Iterative</strong></td>
      <td>‚úÖ No stack overflow</td>
      <td>‚ùå More complex code</td>
      <td>Large, deep trees</td>
    </tr>
  </tbody>
</table>

<!--- Reviewed up to --->

<h2 id="conclusion">Conclusion</h2>

<p>Binary tree traversal algorithms are <strong>fundamental building blocks</strong> in computer science, providing systematic ways to process tree structures efficiently. Each traversal method has unique characteristics that make it optimal for specific scenarios:</p>

<h3 id="-key-takeaways">üéØ <strong>Key Takeaways:</strong></h3>

<table>
  <thead>
    <tr>
      <th><strong>Algorithm</strong></th>
      <th><strong>Strength</strong></th>
      <th><strong>Best Application</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>üü¶ Preorder</strong></td>
      <td>Root-first processing</td>
      <td>Tree copying, directory listing</td>
    </tr>
    <tr>
      <td><strong>üü© Inorder</strong></td>
      <td>Natural BST sorting</td>
      <td>Sorted data retrieval, expression parsing</td>
    </tr>
    <tr>
      <td><strong>üü® Postorder</strong></td>
      <td>Children-first processing</td>
      <td>Tree deletion, size calculation</td>
    </tr>
    <tr>
      <td><strong>üü™ Level Order</strong></td>
      <td>Level-wise exploration</td>
      <td>BFS, shortest path, tree printing</td>
    </tr>
  </tbody>
</table>

<h3 id="-why-these-algorithms-matter">üí° <strong>Why These Algorithms Matter:</strong></h3>

<ol>
  <li><strong>Foundation Knowledge</strong>: Essential for advanced data structures</li>
  <li><strong>Problem Solving</strong>: Core technique for tree-based problems</li>
  <li><strong>Performance</strong>: Choose right algorithm for optimal efficiency</li>
  <li><strong>Practical Applications</strong>: Used in databases, compilers, file systems</li>
  <li><strong>Algorithmic Thinking</strong>: Develops recursive and iterative thinking skills</li>
</ol>

<h3 id="-next-steps-for-learning">üöÄ <strong>Next Steps for Learning:</strong></h3>

<ul>
  <li><strong>üå≥ Advanced Trees</strong>: AVL trees, Red-Black trees, B-trees</li>
  <li><strong>üìä Graph Algorithms</strong>: DFS and BFS on graphs</li>
  <li><strong>üîÑ Dynamic Programming</strong>: Tree-based DP problems</li>
  <li><strong>üéÆ Real Projects</strong>: Implement file explorers, expression evaluators</li>
  <li><strong>üìà Optimization</strong>: Study cache-efficient traversal techniques</li>
</ul>

<h3 id="-academic-and-professional-value">üéì <strong>Academic and Professional Value:</strong></h3>

<p>Understanding these algorithms is crucial for:</p>
<ul>
  <li><strong>üìö Computer Science Education</strong>: Fundamental CS concepts</li>
  <li><strong>üíº Technical Interviews</strong>: Common algorithm questions</li>
  <li><strong>üè¢ Software Development</strong>: Building tree-based applications</li>
  <li><strong>üî¨ Research</strong>: Foundation for advanced algorithmic research</li>
</ul>

<p>The mastery of tree traversal algorithms represents a significant milestone in your journey through data structures and algorithms. These techniques will serve as building blocks for more complex algorithms and real-world applications throughout your career in computer science.</p>

<p><strong>Remember</strong>: The choice of traversal algorithm should always be based on your specific requirements - there‚Äôs no ‚Äúone size fits all‚Äù solution, but there‚Äôs always an optimal choice for each scenario! üéØ</p>

<hr />

<p><a href="https://github.com/mahedee/code-sample02/tree/master/binary-tree-traversal-app">‚¨áÔ∏è <strong>Source code</strong></a></p>

<p><strong>Connect with me</strong>:</p>
<ul>
  <li>üíº <a href="https://www.linkedin.com/in/mahedee/">LinkedIn</a></li>
  <li>üêô <a href="https://github.com/mahedee">GitHub</a></li>
  <li>
    <h2 id="-blog">üìù <a href="https://mahedee.net/">Blog</a></h2>
  </li>
</ul>

<p>üåü <em>Found this helpful? Please share it with others who might benefit from understanding binary tree traversal algorithms.</em> üåü</p>]]></content><author><name>Mahedee Hasan</name></author><category term="Data Structures" /><category term="Algorithms" /><category term="Computer Science" /><category term="Java" /><category term="binary-trees" /><category term="tree-traversal" /><category term="depth-first-search" /><category term="breadth-first-search" /><category term="dfs" /><category term="bfs" /><category term="preorder" /><category term="inorder" /><category term="postorder" /><category term="level-order" /><category term="recursion" /><category term="java" /><category term="algorithms" /><category term="data-structures" /><category term="computer-science" /><category term="programming-tutorial" /><summary type="html"><![CDATA[Binary tree traversal algorithms are fundamental techniques that allow systematic visiting of every node in a tree. This comprehensive guide covers all four major traversal methods with complete implementations, real-world applications, and performance analysis.]]></summary></entry><entry><title type="html">Developing and Testing a Multi-Environment ASP.NET Core Application with SQL Server</title><link href="https://mahedee.net/Developing-and-Testing-a-Multi-Environment-ASP-NET-Core-Application-with-SQL-Server/" rel="alternate" type="text/html" title="Developing and Testing a Multi-Environment ASP.NET Core Application with SQL Server" /><published>2025-06-08T00:00:00-04:00</published><updated>2025-06-08T00:00:00-04:00</updated><id>https://mahedee.net/Developing-and-Testing-a-Multi-Environment-ASP-NET-Core-Application-with-SQL-Server</id><content type="html" xml:base="https://mahedee.net/Developing-and-Testing-a-Multi-Environment-ASP-NET-Core-Application-with-SQL-Server/"><![CDATA[<p><strong>Introduction</strong></p>

<p>Running the same code across environments demands clear configuration boundaries, safe database migrations, and repeatable tests. In this comprehensive step-by-step guide, you‚Äôll develop and configure an ASP.NET Core Web API project from scratch to work consistently in Development, QA, and Production using ASP.NET Core, EF Core, and SQL Server. At the end of this guide, you‚Äôll have a production-ready HRM (Human Resource Management) API with automated testing workflows for multiple environments.</p>

<p><strong>Why it is important?</strong></p>
<ul>
  <li>Environment parity reduces ‚Äúworks on my machine‚Äù issues.</li>
  <li>Safer deployments with gated migrations and smoke tests.</li>
  <li>Clean separation of secrets and settings for Dev/QA/Prod.</li>
  <li>Faster troubleshooting with predictable diagnostics and seed data.</li>
  <li>Production-ready architecture with proper testing infrastructure.</li>
</ul>

<p><strong>Tools and Technology Used</strong></p>
<ul>
  <li>.NET 9 SDK</li>
  <li>ASP.NET Core Web API</li>
  <li>C#</li>
  <li>Entity Framework Core 9 (SQL Server)</li>
  <li>SQL Server (LocalDB, Express, or full version)</li>
  <li>xUnit (testing framework)</li>
  <li>PowerShell (automation scripts)</li>
  <li>Visual Studio 2022 or VS Code</li>
</ul>

<p><strong>Implementation:</strong></p>

<p><strong>Step 1: Prepare Development Environment</strong></p>

<p><strong>Option A ‚Äî Local SQL Server Installation:</strong>
Install SQL Server, or use LocalDB. Ensure SQL Server is accessible with your credentials.</p>

<p><strong>Option B ‚Äî Docker SQL Server (Windows PowerShell):</strong>
If you don‚Äôt have SQL Server installed, use Docker to run a SQL Server container:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Pull and run SQL Server 2022 in Docker</span><span class="w">
</span><span class="n">docker</span><span class="w"> </span><span class="nx">pull</span><span class="w"> </span><span class="nx">mcr.microsoft.com/mssql/server:2022-latest</span><span class="w">
</span><span class="n">docker</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"ACCEPT_EULA=Y"</span><span class="w"> </span><span class="nt">-e</span><span class="w"> </span><span class="s2">"SA_PASSWORD=YourPassword123!"</span><span class="w"> </span><span class="nt">-p</span><span class="w"> </span><span class="nx">1433:1433</span><span class="w"> </span><span class="nt">--name</span><span class="w"> </span><span class="nx">sql2022</span><span class="w"> </span><span class="nt">-d</span><span class="w"> </span><span class="nx">mcr.microsoft.com/mssql/server:2022-latest</span><span class="w">

</span><span class="c"># Verify connection</span><span class="w">
</span><span class="n">sqlcmd</span><span class="w"> </span><span class="nt">-S</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nt">-U</span><span class="w"> </span><span class="nx">sa</span><span class="w"> </span><span class="nt">-P</span><span class="w"> </span><span class="s2">"YourPassword123!"</span><span class="w"> </span><span class="nt">-Q</span><span class="w"> </span><span class="s2">"SELECT @@VERSION"</span><span class="w">
</span></code></pre></div></div>

<p><strong>Verify Prerequisites:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Check .NET 9 SDK</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nt">--version</span><span class="w">
</span><span class="c"># Expected: 9.0.x</span><span class="w">

</span><span class="c"># Test SQL Server connection</span><span class="w">
</span><span class="n">sqlcmd</span><span class="w"> </span><span class="nt">-S</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nt">-E</span><span class="w"> </span><span class="nt">-Q</span><span class="w"> </span><span class="s2">"SELECT @@VERSION"</span><span class="w">

</span><span class="c"># Check PowerShell version</span><span class="w">
</span><span class="bp">$PSVersionTable</span><span class="o">.</span><span class="nf">PSVersion</span><span class="w">
</span></code></pre></div></div>

<p><strong>Step 2: Create Project Structure from Scratch</strong></p>

<ul>
  <li>Create the solution and project structure using the following commands:</li>
</ul>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Create solution structure</span><span class="w">
</span><span class="n">mkdir</span><span class="w"> </span><span class="nx">multi-env-app</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">multi-env-app</span><span class="w">
</span><span class="n">mkdir</span><span class="w"> </span><span class="nx">src</span><span class="p">,</span><span class="w"> </span><span class="nx">doc</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">src</span><span class="w">
</span><span class="n">mkdir</span><span class="w"> </span><span class="nx">HRM</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HRM</span><span class="w">

</span><span class="c"># Create solution and Web API project</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">sln</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nx">HRM</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">webapi</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nx">HRM.API</span><span class="w"> </span><span class="nt">--framework</span><span class="w"> </span><span class="nx">net9.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">sln</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">HRM.API/HRM.API.csproj</span><span class="w">

</span><span class="c"># Navigate to API project and install packages</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HRM.API</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.EntityFrameworkCore.SqlServer</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.EntityFrameworkCore.Tools</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.EntityFrameworkCore.Design</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.AspNetCore.OpenApi</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Swashbuckle.AspNetCore</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">6.8.1</span><span class="w">

</span><span class="c"># Create project folders</span><span class="w">
</span><span class="n">mkdir</span><span class="w"> </span><span class="nx">Controllers</span><span class="p">,</span><span class="w"> </span><span class="nx">Models</span><span class="p">,</span><span class="w"> </span><span class="nx">DTOs</span><span class="p">,</span><span class="w"> </span><span class="nx">Services</span><span class="p">,</span><span class="w"> </span><span class="nx">Data</span><span class="p">,</span><span class="w"> </span><span class="nx">Migrations</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>You can use visual studio to create the solution and project structure if you prefer a GUI.</li>
</ul>

<p><strong>Project Structure Overview:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HRM/
‚îú‚îÄ‚îÄ HRM.sln                     # Solution file
‚îú‚îÄ‚îÄ HRM.API/                    # Main Web API project
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/            # API endpoints (DepartmentsController, EmployeesController)
‚îÇ   ‚îú‚îÄ‚îÄ Services/              # Business logic services and interfaces
‚îÇ   ‚îú‚îÄ‚îÄ Data/                  # Entity Framework DbContext
‚îÇ   ‚îú‚îÄ‚îÄ Models/                # Entity models (Department, Employee)
‚îÇ   ‚îú‚îÄ‚îÄ DTOs/                  # Data transfer objects with validation
‚îÇ   ‚îú‚îÄ‚îÄ Migrations/            # EF Core database migrations
‚îÇ   ‚îú‚îÄ‚îÄ Properties/            # Launch settings with multiple profiles
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json       # Production configuration (base settings)
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.Development.json # Development environment settings
‚îÇ   ‚îú‚îÄ‚îÄ appsettings.QA.json    # QA environment settings
‚îÇ   ‚îú‚îÄ‚îÄ Program.cs             # Application entry point
‚îÇ   ‚îî‚îÄ‚îÄ HRM.API.csproj         # Project file with dependencies
‚îî‚îÄ‚îÄ HRM.Tests/                 # Test project (created later)
</code></pre></div></div>

<p><strong>Step 3: Create Data Models and Database Context</strong></p>

<p><strong>Create Entity Models:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">Models/Department.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.API.Models</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Department</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">DepartmentId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">100</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">500</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span><span class="p">?</span> <span class="n">Description</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="kt">bool</span> <span class="n">IsActive</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">CreatedDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>

        <span class="k">public</span> <span class="n">DateTime</span><span class="p">?</span> <span class="n">UpdatedDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Navigation property</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="n">ICollection</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">Employees</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;();</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Create <code class="language-plaintext highlighter-rouge">Models/Employee.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel.DataAnnotations.Schema</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.API.Models</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Employee</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">EmployeeId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">100</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">FirstName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">100</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">LastName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="p">[</span><span class="n">EmailAddress</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">255</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Email</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

        <span class="p">[</span><span class="nf">StringLength</span><span class="p">(</span><span class="m">20</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">string</span><span class="p">?</span> <span class="n">PhoneNumber</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">HireDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="p">[</span><span class="nf">Column</span><span class="p">(</span><span class="n">TypeName</span> <span class="p">=</span> <span class="s">"decimal(10,2)"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Salary</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="p">[</span><span class="n">Required</span><span class="p">]</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">DepartmentId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">CreatedDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>

        <span class="k">public</span> <span class="n">DateTime</span><span class="p">?</span> <span class="n">UpdatedDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Navigation property</span>
        <span class="k">public</span> <span class="k">virtual</span> <span class="n">Department</span> <span class="n">Department</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="k">null</span><span class="p">!;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Create Database Context with Seed Data:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">Data/HrmDbContext.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.API.Data</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">HrmDbContext</span> <span class="p">:</span> <span class="n">DbContext</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">HrmDbContext</span><span class="p">(</span><span class="n">DbContextOptions</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;</span> <span class="n">options</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">DbSet</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">Employees</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">DbSet</span><span class="p">&lt;</span><span class="n">Department</span><span class="p">&gt;</span> <span class="n">Departments</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnModelCreating</span><span class="p">(</span><span class="n">ModelBuilder</span> <span class="n">modelBuilder</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnModelCreating</span><span class="p">(</span><span class="n">modelBuilder</span><span class="p">);</span>

            <span class="c1">// Configure relationships</span>
            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;()</span>
                <span class="p">.</span><span class="nf">HasOne</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Department</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">WithMany</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Employees</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">HasForeignKey</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">OnDelete</span><span class="p">(</span><span class="n">DeleteBehavior</span><span class="p">.</span><span class="n">Restrict</span><span class="p">);</span>

            <span class="c1">// Configure unique constraints</span>
            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;()</span>
                <span class="p">.</span><span class="nf">HasIndex</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Email</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">IsUnique</span><span class="p">();</span>

            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Department</span><span class="p">&gt;()</span>
                <span class="p">.</span><span class="nf">HasIndex</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Name</span><span class="p">)</span>
                <span class="p">.</span><span class="nf">IsUnique</span><span class="p">();</span>

            <span class="c1">// Seed sample data for testing</span>
            <span class="nf">SeedData</span><span class="p">(</span><span class="n">modelBuilder</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">SeedData</span><span class="p">(</span><span class="n">ModelBuilder</span> <span class="n">modelBuilder</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Seed Departments</span>
            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Department</span><span class="p">&gt;().</span><span class="nf">HasData</span><span class="p">(</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Human Resources"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Manages employee relations, recruitment, and benefits"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Information Technology"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Handles all technology infrastructure and software development"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Finance"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Manages company finances, budgeting, and accounting"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Marketing"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Handles marketing campaigns, branding, and customer outreach"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Sales"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Manages customer relationships and sales processes"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">);</span>

            <span class="c1">// Seed Employees</span>
            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;().</span><span class="nf">HasData</span><span class="p">(</span>
                <span class="k">new</span> <span class="n">Employee</span> <span class="p">{</span> <span class="n">EmployeeId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Sarah"</span><span class="p">,</span> <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Johnson"</span><span class="p">,</span> <span class="n">Email</span> <span class="p">=</span> <span class="s">"sarah.johnson@company.com"</span><span class="p">,</span> <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-0101"</span><span class="p">,</span> <span class="n">HireDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2023</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">15</span><span class="p">),</span> <span class="n">Salary</span> <span class="p">=</span> <span class="m">75000m</span><span class="p">,</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span> <span class="p">{</span> <span class="n">EmployeeId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Michael"</span><span class="p">,</span> <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Chen"</span><span class="p">,</span> <span class="n">Email</span> <span class="p">=</span> <span class="s">"michael.chen@company.com"</span><span class="p">,</span> <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-0102"</span><span class="p">,</span> <span class="n">HireDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2022</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">22</span><span class="p">),</span> <span class="n">Salary</span> <span class="p">=</span> <span class="m">95000m</span><span class="p">,</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span> <span class="p">{</span> <span class="n">EmployeeId</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Emily"</span><span class="p">,</span> <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Davis"</span><span class="p">,</span> <span class="n">Email</span> <span class="p">=</span> <span class="s">"emily.davis@company.com"</span><span class="p">,</span> <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-0103"</span><span class="p">,</span> <span class="n">HireDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2023</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">Salary</span> <span class="p">=</span> <span class="m">82000m</span><span class="p">,</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">CreatedDate</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">2024</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeKind</span><span class="p">.</span><span class="n">Utc</span><span class="p">)</span> <span class="p">}</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Step 4: Configure Multi-Environment Settings</strong></p>

<p>ASP.NET Core loads <code class="language-plaintext highlighter-rouge">appsettings.json</code> plus <code class="language-plaintext highlighter-rouge">appsettings.{Environment}.json</code>. Create environment-specific configuration files:</p>

<p><strong>Create <code class="language-plaintext highlighter-rouge">appsettings.json</code> (Production base):</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"ConnectionStrings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"DefaultConnection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Server=prod-server;Database=HRM_Prod;User Id=hrm_user;Password=secure_prod_password;TrustServerCertificate=true;Encrypt=true;"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"Logging"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"LogLevel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.AspNetCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.EntityFrameworkCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Warning"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"AllowedHosts"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"ApiSettings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HRM API - Production"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableSwagger"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableDetailedErrors"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Create <code class="language-plaintext highlighter-rouge">appsettings.Development.json</code>:</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"ConnectionStrings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"DefaultConnection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Server=localhost;Database=HRM_DEV;User Id=sa;Password=YourPassword123!;TrustServerCertificate=true;"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"Logging"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"LogLevel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Debug"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.AspNetCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.EntityFrameworkCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.EntityFrameworkCore.Database.Command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"ApiSettings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HRM API - Development"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableSwagger"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableDetailedErrors"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Create <code class="language-plaintext highlighter-rouge">appsettings.QA.json</code>:</strong></p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"ConnectionStrings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"DefaultConnection"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Server=localhost;Database=HRM_QA;User Id=sa;Password=YourPassword123!;TrustServerCertificate=true;"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"Logging"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"LogLevel"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"Default"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.AspNetCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Microsoft.EntityFrameworkCore"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Information"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"ApiSettings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v1"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HRM API - QA Environment"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableSwagger"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"EnableDetailedErrors"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Configure Multiple Launch Profiles:</strong></p>

<p>Update <code class="language-plaintext highlighter-rouge">Properties/launchSettings.json</code>:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"profiles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"development"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"commandName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Project"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"applicationUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://localhost:7285;http://localhost:5152"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"launchBrowser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"launchUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swagger"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"environmentVariables"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"ASPNETCORE_ENVIRONMENT"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"qa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"commandName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Project"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"applicationUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://localhost:7286;http://localhost:5153"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"launchBrowser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"launchUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"swagger"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"environmentVariables"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"ASPNETCORE_ENVIRONMENT"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QA"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"commandName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Project"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"applicationUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://localhost:7287;http://localhost:5154"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"launchBrowser"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="nl">"environmentVariables"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"ASPNETCORE_ENVIRONMENT"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Production"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Set environment when running:</strong></p>
<ul>
  <li>Run the following command in PowerShell to set the environment variable:
    <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">   </span><span class="c"># or "QA", "Production"</span><span class="w">
</span></code></pre></div>    </div>
  </li>
</ul>

<p><strong>Step 5: Create Business Logic Services</strong></p>

<p><strong>Create service interfaces and implementations (key files):</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">Services/IDepartmentService.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">HRM.API.DTOs</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.API.Services</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IDepartmentService</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;</span> <span class="nf">GetAllDepartmentsAsync</span><span class="p">();</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">?&gt;</span> <span class="nf">GetDepartmentByIdAsync</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">);</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;</span> <span class="nf">CreateDepartmentAsync</span><span class="p">(</span><span class="n">CreateDepartmentDto</span> <span class="n">createDepartmentDto</span><span class="p">);</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="nf">DeleteDepartmentAsync</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">);</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;</span> <span class="nf">DepartmentExistsAsync</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Create <code class="language-plaintext highlighter-rouge">Services/DepartmentService.cs</code> (implementing business logic with EF Core operations).</p>

<p><strong>Step 6: Create API Controllers</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">Controllers/DepartmentsController.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.DTOs</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Services</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.API.Controllers</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">ApiController</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">Route</span><span class="p">(</span><span class="s">"api/[controller]"</span><span class="p">)]</span>
    <span class="p">[</span><span class="nf">Produces</span><span class="p">(</span><span class="s">"application/json"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DepartmentsController</span> <span class="p">:</span> <span class="n">ControllerBase</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IDepartmentService</span> <span class="n">_departmentService</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">DepartmentsController</span><span class="p">(</span><span class="n">IDepartmentService</span> <span class="n">departmentService</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_departmentService</span> <span class="p">=</span> <span class="n">departmentService</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;&gt;</span> <span class="nf">GetDepartments</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">departments</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_departmentService</span><span class="p">.</span><span class="nf">GetAllDepartmentsAsync</span><span class="p">();</span>
            <span class="k">return</span> <span class="nf">Ok</span><span class="p">(</span><span class="n">departments</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;</span> <span class="nf">GetDepartment</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">department</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_departmentService</span><span class="p">.</span><span class="nf">GetDepartmentByIdAsync</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">department</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
                <span class="k">return</span> <span class="nf">NotFound</span><span class="p">(</span><span class="s">$"Department with ID </span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="s"> not found."</span><span class="p">);</span>

            <span class="k">return</span> <span class="nf">Ok</span><span class="p">(</span><span class="n">department</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;</span> <span class="nf">CreateDepartment</span><span class="p">(</span><span class="n">CreateDepartmentDto</span> <span class="n">createDepartmentDto</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">ModelState</span><span class="p">.</span><span class="n">IsValid</span><span class="p">)</span>
                <span class="k">return</span> <span class="nf">BadRequest</span><span class="p">(</span><span class="n">ModelState</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">department</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_departmentService</span><span class="p">.</span><span class="nf">CreateDepartmentAsync</span><span class="p">(</span><span class="n">createDepartmentDto</span><span class="p">);</span>
            <span class="k">return</span> <span class="nf">CreatedAtAction</span><span class="p">(</span><span class="k">nameof</span><span class="p">(</span><span class="n">GetDepartment</span><span class="p">),</span> <span class="k">new</span> <span class="p">{</span> <span class="n">id</span> <span class="p">=</span> <span class="n">department</span><span class="p">.</span><span class="n">DepartmentId</span> <span class="p">},</span> <span class="n">department</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="nf">HttpDelete</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">DeleteDepartment</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_departmentService</span><span class="p">.</span><span class="nf">DeleteDepartmentAsync</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">result</span><span class="p">)</span>
                <span class="k">return</span> <span class="nf">NotFound</span><span class="p">(</span><span class="s">$"Department with ID </span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="s"> not found."</span><span class="p">);</span>

            <span class="k">return</span> <span class="nf">NoContent</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Step 7: Configure Program.cs for Multi-Environment Support</strong></p>

<p>Update <code class="language-plaintext highlighter-rouge">Program.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Data</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Services</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">WebApplication</span><span class="p">.</span><span class="nf">CreateBuilder</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>

<span class="c1">// Add services to the container</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddControllers</span><span class="p">();</span>

<span class="c1">// Configure Entity Framework with environment-specific connection string</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddDbContext</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
    <span class="n">options</span><span class="p">.</span><span class="nf">UseSqlServer</span><span class="p">(</span><span class="n">builder</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="nf">GetConnectionString</span><span class="p">(</span><span class="s">"DefaultConnection"</span><span class="p">)));</span>

<span class="c1">// Register business services for dependency injection</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IDepartmentService</span><span class="p">,</span> <span class="n">DepartmentService</span><span class="p">&gt;();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IEmployeeService</span><span class="p">,</span> <span class="n">EmployeeService</span><span class="p">&gt;();</span>

<span class="c1">// Configure API documentation</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddEndpointsApiExplorer</span><span class="p">();</span>

<span class="c1">// Conditionally add Swagger based on environment configuration</span>
<span class="kt">var</span> <span class="n">apiSettings</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="n">Configuration</span><span class="p">.</span><span class="nf">GetSection</span><span class="p">(</span><span class="s">"ApiSettings"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">apiSettings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;(</span><span class="s">"EnableSwagger"</span><span class="p">))</span>
<span class="p">{</span>
    <span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddSwaggerGen</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">c</span><span class="p">.</span><span class="nf">SwaggerDoc</span><span class="p">(</span><span class="s">"v1"</span><span class="p">,</span> <span class="k">new</span><span class="p">()</span> 
        <span class="p">{</span> 
            <span class="n">Title</span> <span class="p">=</span> <span class="n">apiSettings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(</span><span class="s">"Title"</span><span class="p">),</span> 
            <span class="n">Version</span> <span class="p">=</span> <span class="n">apiSettings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(</span><span class="s">"Version"</span><span class="p">)</span> 
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="kt">var</span> <span class="n">app</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="nf">Build</span><span class="p">();</span>

<span class="c1">// Configure the HTTP request pipeline based on environment</span>
<span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">Environment</span><span class="p">.</span><span class="nf">IsDevelopment</span><span class="p">()</span> <span class="p">||</span> <span class="n">app</span><span class="p">.</span><span class="n">Environment</span><span class="p">.</span><span class="n">EnvironmentName</span> <span class="p">==</span> <span class="s">"QA"</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">apiSettings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">&lt;</span><span class="kt">bool</span><span class="p">&gt;(</span><span class="s">"EnableSwagger"</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">app</span><span class="p">.</span><span class="nf">UseSwagger</span><span class="p">();</span>
        <span class="n">app</span><span class="p">.</span><span class="nf">UseSwaggerUI</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
            <span class="n">c</span><span class="p">.</span><span class="nf">SwaggerEndpoint</span><span class="p">(</span><span class="s">"/swagger/v1/swagger.json"</span><span class="p">,</span> <span class="n">apiSettings</span><span class="p">.</span><span class="n">GetValue</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(</span><span class="s">"Title"</span><span class="p">));</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseHttpsRedirection</span><span class="p">();</span>
<span class="n">app</span><span class="p">.</span><span class="nf">UseAuthorization</span><span class="p">();</span>
<span class="n">app</span><span class="p">.</span><span class="nf">MapControllers</span><span class="p">();</span>

<span class="c1">// Ensure database is created (for development/demo purposes)</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">CreateScope</span><span class="p">())</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">context</span> <span class="p">=</span> <span class="n">scope</span><span class="p">.</span><span class="n">ServiceProvider</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;();</span>
    <span class="n">context</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="nf">EnsureCreated</span><span class="p">();</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">Run</span><span class="p">();</span>
</code></pre></div></div>

<p>Note: <code class="language-plaintext highlighter-rouge">EnsureCreated()</code> is used for demo purposes. For production, use <code class="language-plaintext highlighter-rouge">Database.Migrate()</code> and controlled migrations.</p>

<p><strong>Step 8: Create and Apply Database Migrations</strong></p>

<p>Navigate to the API project and create/apply migrations for each environment:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cd</span><span class="w"> </span><span class="nx">d:/Projects/GitHub/rnd/projects/in-progress/multi-env-app/src/HRM/HRM.API</span><span class="w">

</span><span class="c"># Create initial migration</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">migrations</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">InitialCreate</span><span class="w">

</span><span class="c"># Apply migration to Development database</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">update</span><span class="w">

</span><span class="c"># Apply migration to QA database</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"QA"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">update</span><span class="w">

</span><span class="c"># Apply migration to Production database (when ready)</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Production"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">update</span><span class="w">
</span></code></pre></div></div>

<p><strong>When models change, add new migrations:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">migrations</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">AddNewField</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">ef</span><span class="w"> </span><span class="nx">database</span><span class="w"> </span><span class="nx">update</span><span class="w">
</span></code></pre></div></div>

<p><strong>Verify Database Creation:</strong>
After running migrations, you should have three separate databases:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">HRM_DEV</code> (Development)</li>
  <li><code class="language-plaintext highlighter-rouge">HRM_QA</code> (QA)</li>
  <li><code class="language-plaintext highlighter-rouge">HRM_Prod</code> (Production)</li>
</ul>

<p>Each database contains the seeded data from <code class="language-plaintext highlighter-rouge">HrmDbContext</code>, providing consistent test data across environments.</p>

<p><strong>Step 9: Run and Test the API Across Environments</strong></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cd</span><span class="w"> </span><span class="nx">d:/Projects/GitHub/rnd/projects/in-progress/multi-env-app/src/HRM/HRM.API</span><span class="w">

</span><span class="c"># Run in Development with Swagger UI</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--launch-profile</span><span class="w"> </span><span class="nx">development</span><span class="w">
</span><span class="c"># Access: http://localhost:5152/swagger</span><span class="w">

</span><span class="c"># Run in QA environment</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"QA"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--launch-profile</span><span class="w"> </span><span class="nx">qa</span><span class="w">
</span><span class="c"># Access: http://localhost:5153/swagger</span><span class="w">

</span><span class="c"># Run in Production mode (no Swagger)</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Production"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--launch-profile</span><span class="w"> </span><span class="nx">production</span><span class="w">
</span><span class="c"># Access: http://localhost:5154/api/departments</span><span class="w">
</span></code></pre></div></div>

<p><strong>Environment-Specific Features:</strong></p>
<ul>
  <li><strong>Development</strong>: Swagger UI enabled, detailed logging, debug information</li>
  <li><strong>QA</strong>: Swagger UI enabled, moderate logging, similar to production but with testing features</li>
  <li><strong>Production</strong>: Swagger disabled, minimal logging, optimized for performance</li>
</ul>

<p><strong>Run the application for different environments using Visual Studio</strong></p>
<ul>
  <li>Select the desired profile (development, qa, production) from the debug dropdown and run.</li>
</ul>

<p><strong>Step 10: API Testing and Validation</strong></p>

<p><strong>Manual Testing with PowerShell:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test Development environment</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="c"># Start the API in another terminal: dotnet run --launch-profile development</span><span class="w">

</span><span class="c"># Get all departments</span><span class="w">
</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"http://localhost:5152/api/departments"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">

</span><span class="c"># Get all employees</span><span class="w">
</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"http://localhost:5152/api/employees"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">

</span><span class="c"># Create a new department</span><span class="w">
</span><span class="nv">$newDept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Research &amp; Development"</span><span class="w">
    </span><span class="nx">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Innovation and product development"</span><span class="w">
    </span><span class="nx">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">

</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">POST</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"http://localhost:5152/api/departments"</span><span class="w"> </span><span class="nt">-ContentType</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$newDept</span><span class="w">

</span><span class="c"># Create a new employee</span><span class="w">
</span><span class="nv">$newEmployee</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="nx">firstName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"John"</span><span class="w">
    </span><span class="nx">lastName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Doe"</span><span class="w">
    </span><span class="nx">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"john.doe@company.com"</span><span class="w">
    </span><span class="nx">phoneNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"+1-555-1234"</span><span class="w">
    </span><span class="nx">hireDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2024-10-12T00:00:00"</span><span class="w">
    </span><span class="nx">salary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">75000.00</span><span class="w">
    </span><span class="nx">departmentId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">

</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">POST</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"http://localhost:5152/api/employees"</span><span class="w"> </span><span class="nt">-ContentType</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$newEmployee</span><span class="w">
</span></code></pre></div></div>

<p><strong>Using VS Code REST Client:</strong>
Create <code class="language-plaintext highlighter-rouge">test-requests.http</code> in the HRM.API project:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">### Get all departments
GET http://localhost:5152/api/departments
Accept: application/json

### Get all employees
GET http://localhost:5152/api/employees
Accept: application/json

### Create new department
POST http://localhost:5152/api/departments
Content-Type: application/json

{
  "name": "Quality Assurance",
  "description": "Software testing and quality control",
  "isActive": true
}

### Create new employee
POST http://localhost:5152/api/employees
Content-Type: application/json

{
  "firstName": "Jane",
  "lastName": "Smith",
  "email": "jane.smith@company.com",
  "phoneNumber": "+1-555-5678",
  "hireDate": "2024-10-12T00:00:00",
  "salary": 80000.00,
  "departmentId": 1
}
</span></code></pre></div></div>

<p><strong>Step 11: Create Automated Testing Infrastructure</strong></p>

<p><strong>Create Test Project:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Navigate to HRM solution directory</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="c"># from HRM.API to HRM</span><span class="w">

</span><span class="c"># Create test project</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">xunit</span><span class="w"> </span><span class="nt">-n</span><span class="w"> </span><span class="nx">HRM.Tests</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">sln</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">HRM.Tests/HRM.Tests.csproj</span><span class="w">

</span><span class="c"># Add test packages and project reference</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HRM.Tests</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.AspNetCore.Mvc.Testing</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">Microsoft.EntityFrameworkCore.InMemory</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">9.0.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">package</span><span class="w"> </span><span class="nx">FluentAssertions</span><span class="w"> </span><span class="nt">--version</span><span class="w"> </span><span class="nx">6.12.0</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">reference</span><span class="w"> </span><span class="o">..</span><span class="nx">/HRM.API/HRM.API.csproj</span><span class="w">
</span></code></pre></div></div>

<p><strong>Create Integration Test Infrastructure:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.Tests/TestWebApplicationFactory.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Hosting</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc.Testing</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Extensions.DependencyInjection</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.Extensions.Logging</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Data</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.Tests</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">TStartup</span><span class="p">&gt;</span> <span class="p">:</span> <span class="n">WebApplicationFactory</span><span class="p">&lt;</span><span class="n">TStartup</span><span class="p">&gt;</span> <span class="k">where</span> <span class="n">TStartup</span> <span class="p">:</span> <span class="k">class</span>
    <span class="err">{</span>
        <span class="nc">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">ConfigureWebHost</span><span class="p">(</span><span class="n">IWebHostBuilder</span> <span class="n">builder</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">builder</span><span class="p">.</span><span class="nf">ConfigureServices</span><span class="p">(</span><span class="n">services</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="c1">// Remove the real database context</span>
                <span class="kt">var</span> <span class="n">descriptor</span> <span class="p">=</span> <span class="n">services</span><span class="p">.</span><span class="nf">SingleOrDefault</span><span class="p">(</span>
                    <span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">ServiceType</span> <span class="p">==</span> <span class="k">typeof</span><span class="p">(</span><span class="n">DbContextOptions</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;));</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">descriptor</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">services</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">descriptor</span><span class="p">);</span>
                <span class="p">}</span>

                <span class="c1">// Add in-memory database for testing</span>
                <span class="n">services</span><span class="p">.</span><span class="n">AddDbContext</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
                <span class="p">{</span>
                    <span class="n">options</span><span class="p">.</span><span class="nf">UseInMemoryDatabase</span><span class="p">(</span><span class="s">"InMemoryDbForTesting"</span><span class="p">);</span>
                <span class="p">});</span>

                <span class="c1">// Build the service provider and create the database</span>
                <span class="kt">var</span> <span class="n">sp</span> <span class="p">=</span> <span class="n">services</span><span class="p">.</span><span class="nf">BuildServiceProvider</span><span class="p">();</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">sp</span><span class="p">.</span><span class="nf">CreateScope</span><span class="p">())</span>
                <span class="p">{</span>
                    <span class="kt">var</span> <span class="n">scopedServices</span> <span class="p">=</span> <span class="n">scope</span><span class="p">.</span><span class="n">ServiceProvider</span><span class="p">;</span>
                    <span class="kt">var</span> <span class="n">db</span> <span class="p">=</span> <span class="n">scopedServices</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;();</span>
                    <span class="kt">var</span> <span class="n">logger</span> <span class="p">=</span> <span class="n">scopedServices</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="p">&lt;</span><span class="n">ILogger</span><span class="p">&lt;</span><span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">TStartup</span><span class="p">&gt;&gt;&gt;();</span>

                    <span class="c1">// Ensure the database is created</span>
                    <span class="n">db</span><span class="p">.</span><span class="n">Database</span><span class="p">.</span><span class="nf">EnsureCreated</span><span class="p">();</span>

                    <span class="k">try</span>
                    <span class="p">{</span>
                        <span class="c1">// Seed test data if needed</span>
                        <span class="nf">SeedTestData</span><span class="p">(</span><span class="n">db</span><span class="p">);</span>
                    <span class="p">}</span>
                    <span class="k">catch</span> <span class="p">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">logger</span><span class="p">.</span><span class="nf">LogError</span><span class="p">(</span><span class="n">ex</span><span class="p">,</span> <span class="s">"An error occurred seeding the database with test messages. Error: {Message}"</span><span class="p">,</span> <span class="n">ex</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">});</span>

            <span class="n">builder</span><span class="p">.</span><span class="nf">UseEnvironment</span><span class="p">(</span><span class="s">"Testing"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SeedTestData</span><span class="p">(</span><span class="n">HrmDbContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Add additional test data if needed beyond what's in OnModelCreating</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">context</span><span class="p">.</span><span class="n">Departments</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">context</span><span class="p">.</span><span class="n">Departments</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span>
                    <span class="k">new</span> <span class="n">HRM</span><span class="p">.</span><span class="n">API</span><span class="p">.</span><span class="n">Models</span><span class="p">.</span><span class="n">Department</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Test HR"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Test HR Department"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span> <span class="p">},</span>
                    <span class="k">new</span> <span class="n">HRM</span><span class="p">.</span><span class="n">API</span><span class="p">.</span><span class="n">Models</span><span class="p">.</span><span class="n">Department</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Test IT"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Test IT Department"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span> <span class="p">}</span>
                <span class="p">);</span>
                <span class="n">context</span><span class="p">.</span><span class="nf">SaveChanges</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Create Department Integration Tests:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.Tests/IntegrationTests/DepartmentControllerTests.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Net.Http.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">FluentAssertions</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.DTOs</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.Tests.IntegrationTests</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DepartmentControllerTests</span> <span class="p">:</span> <span class="n">IClassFixture</span><span class="p">&lt;</span><span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">_client</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;</span> <span class="n">_factory</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">DepartmentControllerTests</span><span class="p">(</span><span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;</span> <span class="n">factory</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_factory</span> <span class="p">=</span> <span class="n">factory</span><span class="p">;</span>
            <span class="n">_client</span> <span class="p">=</span> <span class="n">_factory</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartments_ReturnsSuccessAndCorrectContentType</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span><span class="p">?.</span><span class="nf">ToString</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Contain</span><span class="p">(</span><span class="s">"application/json"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartments_ReturnsListOfDepartments</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">departments</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;(</span><span class="n">content</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">departments</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">departments</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">HaveCountGreaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">departments</span><span class="p">!.</span><span class="nf">First</span><span class="p">().</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNullOrEmpty</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartment_WithValidId_ReturnsSuccessAndCorrectDepartment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange - First get all departments to find a valid ID</span>
            <span class="kt">var</span> <span class="n">allDepartmentsResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">allDepartmentsContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">allDepartmentsResponse</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">allDepartments</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;(</span><span class="n">allDepartmentsContent</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">firstDepartment</span> <span class="p">=</span> <span class="n">allDepartments</span><span class="p">!.</span><span class="nf">First</span><span class="p">();</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">$"/api/departments/</span><span class="p">{</span><span class="n">firstDepartment</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">department</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;(</span><span class="n">content</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">department</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">department</span><span class="p">!.</span><span class="n">DepartmentId</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">firstDepartment</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">);</span>
            <span class="n">department</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">firstDepartment</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartment_WithInvalidId_ReturnsNotFound</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments/99999"</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">NotFound</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">CreateDepartment_WithValidData_ReturnsCreated</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange</span>
            <span class="kt">var</span> <span class="n">newDepartment</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CreateDepartmentDto</span>
            <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="s">$"Test Department </span><span class="p">{</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">()}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">Description</span> <span class="p">=</span> <span class="s">"Integration test department"</span><span class="p">,</span>
                <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span>
            <span class="p">};</span>

            <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">newDepartment</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">responseContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">createdDepartment</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;(</span><span class="n">responseContent</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">Created</span><span class="p">);</span>
            <span class="n">createdDepartment</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">createdDepartment</span><span class="p">!.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newDepartment</span><span class="p">.</span><span class="n">Name</span><span class="p">);</span>
            <span class="n">createdDepartment</span><span class="p">.</span><span class="n">Description</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newDepartment</span><span class="p">.</span><span class="n">Description</span><span class="p">);</span>
            <span class="n">createdDepartment</span><span class="p">.</span><span class="n">IsActive</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newDepartment</span><span class="p">.</span><span class="n">IsActive</span><span class="p">);</span>
            <span class="n">createdDepartment</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeGreaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">CreateDepartment_WithInvalidData_ReturnsBadRequest</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange - Create department with missing required field</span>
            <span class="kt">var</span> <span class="n">invalidDepartment</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Missing name field"</span> <span class="p">};</span>
            <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">invalidDepartment</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">BadRequest</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DeleteDepartment_WithValidId_ReturnsNoContent</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange - First create a department to delete</span>
            <span class="kt">var</span> <span class="n">newDepartment</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CreateDepartmentDto</span>
            <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="s">$"Department to Delete </span><span class="p">{</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">()}</span><span class="s">"</span><span class="p">,</span>
                <span class="n">Description</span> <span class="p">=</span> <span class="s">"Will be deleted"</span><span class="p">,</span>
                <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span>
            <span class="p">};</span>

            <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">newDepartment</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">createResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">createContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">createResponse</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">createdDepartment</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;(</span><span class="n">createContent</span><span class="p">);</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">deleteResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">DeleteAsync</span><span class="p">(</span><span class="s">$"/api/departments/</span><span class="p">{</span><span class="n">createdDepartment</span><span class="p">!.</span><span class="n">DepartmentId</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">deleteResponse</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">NoContent</span><span class="p">);</span>

            <span class="c1">// Verify it's actually deleted</span>
            <span class="kt">var</span> <span class="n">getResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">$"/api/departments/</span><span class="p">{</span><span class="n">createdDepartment</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
            <span class="n">getResponse</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">NotFound</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DeleteDepartment_WithInvalidId_ReturnsNotFound</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">DeleteAsync</span><span class="p">(</span><span class="s">"/api/departments/99999"</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">NotFound</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Create Employee Integration Tests:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.Tests/IntegrationTests/EmployeeControllerTests.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System.Net.Http.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">FluentAssertions</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.DTOs</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.Tests.IntegrationTests</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">EmployeeControllerTests</span> <span class="p">:</span> <span class="n">IClassFixture</span><span class="p">&lt;</span><span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;&gt;</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">_client</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;</span> <span class="n">_factory</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">EmployeeControllerTests</span><span class="p">(</span><span class="n">TestWebApplicationFactory</span><span class="p">&lt;</span><span class="n">Program</span><span class="p">&gt;</span> <span class="n">factory</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_factory</span> <span class="p">=</span> <span class="n">factory</span><span class="p">;</span>
            <span class="n">_client</span> <span class="p">=</span> <span class="n">_factory</span><span class="p">.</span><span class="nf">CreateClient</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetEmployees_ReturnsSuccessAndCorrectContentType</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/employees"</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="n">Headers</span><span class="p">.</span><span class="n">ContentType</span><span class="p">?.</span><span class="nf">ToString</span><span class="p">()</span>
                <span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Contain</span><span class="p">(</span><span class="s">"application/json"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetEmployees_ReturnsListOfEmployees</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/employees"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">EmployeeDto</span><span class="p">&gt;&gt;(</span><span class="n">content</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">employees</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">employees</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">HaveCountGreaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
            <span class="n">employees</span><span class="p">!.</span><span class="nf">First</span><span class="p">().</span><span class="n">FirstName</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNullOrEmpty</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">CreateEmployee_WithValidData_ReturnsCreated</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange - Get a valid department ID first</span>
            <span class="kt">var</span> <span class="n">departmentsResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">departmentsContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">departmentsResponse</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">departments</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;(</span><span class="n">departmentsContent</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">validDepartmentId</span> <span class="p">=</span> <span class="n">departments</span><span class="p">!.</span><span class="nf">First</span><span class="p">().</span><span class="n">DepartmentId</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">newEmployee</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CreateEmployeeDto</span>
            <span class="p">{</span>
                <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Integration"</span><span class="p">,</span>
                <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Test"</span><span class="p">,</span>
                <span class="n">Email</span> <span class="p">=</span> <span class="s">$"integration.test.</span><span class="p">{</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">()}</span><span class="s">@company.com"</span><span class="p">,</span>
                <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-TEST"</span><span class="p">,</span>
                <span class="n">HireDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
                <span class="n">Salary</span> <span class="p">=</span> <span class="m">75000m</span><span class="p">,</span>
                <span class="n">DepartmentId</span> <span class="p">=</span> <span class="n">validDepartmentId</span>
            <span class="p">};</span>

            <span class="kt">var</span> <span class="n">json</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">newEmployee</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">json</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/api/employees"</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">responseContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">createdEmployee</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">EmployeeDto</span><span class="p">&gt;(</span><span class="n">responseContent</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">Created</span><span class="p">);</span>
            <span class="n">createdEmployee</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">createdEmployee</span><span class="p">!.</span><span class="n">FirstName</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newEmployee</span><span class="p">.</span><span class="n">FirstName</span><span class="p">);</span>
            <span class="n">createdEmployee</span><span class="p">.</span><span class="n">LastName</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newEmployee</span><span class="p">.</span><span class="n">LastName</span><span class="p">);</span>
            <span class="n">createdEmployee</span><span class="p">.</span><span class="n">Email</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">newEmployee</span><span class="p">.</span><span class="n">Email</span><span class="p">);</span>
            <span class="n">createdEmployee</span><span class="p">.</span><span class="n">EmployeeId</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeGreaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">UpdateEmployee_WithValidData_ReturnsSuccess</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange - First create an employee</span>
            <span class="kt">var</span> <span class="n">departmentsResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">GetAsync</span><span class="p">(</span><span class="s">"/api/departments"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">departmentsContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">departmentsResponse</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">departments</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">List</span><span class="p">&lt;</span><span class="n">DepartmentDto</span><span class="p">&gt;&gt;(</span><span class="n">departmentsContent</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">validDepartmentId</span> <span class="p">=</span> <span class="n">departments</span><span class="p">!.</span><span class="nf">First</span><span class="p">().</span><span class="n">DepartmentId</span><span class="p">;</span>

            <span class="kt">var</span> <span class="n">newEmployee</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CreateEmployeeDto</span>
            <span class="p">{</span>
                <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Original"</span><span class="p">,</span>
                <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Name"</span><span class="p">,</span>
                <span class="n">Email</span> <span class="p">=</span> <span class="s">$"original.</span><span class="p">{</span><span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">()}</span><span class="s">@company.com"</span><span class="p">,</span>
                <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-ORIG"</span><span class="p">,</span>
                <span class="n">HireDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
                <span class="n">Salary</span> <span class="p">=</span> <span class="m">70000m</span><span class="p">,</span>
                <span class="n">DepartmentId</span> <span class="p">=</span> <span class="n">validDepartmentId</span>
            <span class="p">};</span>

            <span class="kt">var</span> <span class="n">createJson</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">newEmployee</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">createContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">createJson</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">createResponse</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="s">"/api/employees"</span><span class="p">,</span> <span class="n">createContent</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">createResponseContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">createResponse</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">createdEmployee</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">EmployeeDto</span><span class="p">&gt;(</span><span class="n">createResponseContent</span><span class="p">);</span>

            <span class="c1">// Update the employee</span>
            <span class="kt">var</span> <span class="n">updateEmployee</span> <span class="p">=</span> <span class="k">new</span> <span class="n">UpdateEmployeeDto</span>
            <span class="p">{</span>
                <span class="n">FirstName</span> <span class="p">=</span> <span class="s">"Updated"</span><span class="p">,</span>
                <span class="n">LastName</span> <span class="p">=</span> <span class="s">"Name"</span><span class="p">,</span>
                <span class="n">Email</span> <span class="p">=</span> <span class="n">createdEmployee</span><span class="p">!.</span><span class="n">Email</span><span class="p">,</span> <span class="c1">// Keep same email</span>
                <span class="n">PhoneNumber</span> <span class="p">=</span> <span class="s">"+1-555-UPDT"</span><span class="p">,</span>
                <span class="n">HireDate</span> <span class="p">=</span> <span class="n">createdEmployee</span><span class="p">.</span><span class="n">HireDate</span><span class="p">,</span>
                <span class="n">Salary</span> <span class="p">=</span> <span class="m">80000m</span><span class="p">,</span>
                <span class="n">DepartmentId</span> <span class="p">=</span> <span class="n">validDepartmentId</span>
            <span class="p">};</span>

            <span class="kt">var</span> <span class="n">updateJson</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">updateEmployee</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">updateContent</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">updateJson</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_client</span><span class="p">.</span><span class="nf">PutAsync</span><span class="p">(</span><span class="s">$"/api/employees/</span><span class="p">{</span><span class="n">createdEmployee</span><span class="p">.</span><span class="n">EmployeeId</span><span class="p">}</span><span class="s">"</span><span class="p">,</span> <span class="n">updateContent</span><span class="p">);</span>
            <span class="kt">var</span> <span class="n">responseContent</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">updatedEmployee</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="n">DeserializeObject</span><span class="p">&lt;</span><span class="n">EmployeeDto</span><span class="p">&gt;(</span><span class="n">responseContent</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">response</span><span class="p">.</span><span class="n">StatusCode</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">HttpStatusCode</span><span class="p">.</span><span class="n">OK</span><span class="p">);</span>
            <span class="n">updatedEmployee</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">updatedEmployee</span><span class="p">!.</span><span class="n">FirstName</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"Updated"</span><span class="p">);</span>
            <span class="n">updatedEmployee</span><span class="p">.</span><span class="n">Salary</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="m">80000m</span><span class="p">);</span>
            <span class="n">updatedEmployee</span><span class="p">.</span><span class="n">EmployeeId</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="n">createdEmployee</span><span class="p">.</span><span class="n">EmployeeId</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Create Unit Tests for Services:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.Tests/UnitTests/DepartmentServiceTests.cs</code>:</p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">FluentAssertions</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Data</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Services</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.Models</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">HRM.API.DTOs</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Xunit</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">HRM.Tests.UnitTests</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">DepartmentServiceTests</span> <span class="p">:</span> <span class="n">IDisposable</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">HrmDbContext</span> <span class="n">_context</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">DepartmentService</span> <span class="n">_service</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">DepartmentServiceTests</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">options</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbContextOptionsBuilder</span><span class="p">&lt;</span><span class="n">HrmDbContext</span><span class="p">&gt;()</span>
                <span class="p">.</span><span class="nf">UseInMemoryDatabase</span><span class="p">(</span><span class="n">databaseName</span><span class="p">:</span> <span class="n">Guid</span><span class="p">.</span><span class="nf">NewGuid</span><span class="p">().</span><span class="nf">ToString</span><span class="p">())</span>
                <span class="p">.</span><span class="n">Options</span><span class="p">;</span>

            <span class="n">_context</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HrmDbContext</span><span class="p">(</span><span class="n">options</span><span class="p">);</span>
            <span class="n">_service</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">DepartmentService</span><span class="p">(</span><span class="n">_context</span><span class="p">);</span>

            <span class="c1">// Seed test data</span>
            <span class="nf">SeedTestData</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">SeedTestData</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_context</span><span class="p">.</span><span class="n">Departments</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"HR"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Human Resources"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"IT"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Information Technology"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span> <span class="p">},</span>
                <span class="k">new</span> <span class="n">Department</span> <span class="p">{</span> <span class="n">DepartmentId</span> <span class="p">=</span> <span class="m">3</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">"Finance"</span><span class="p">,</span> <span class="n">Description</span> <span class="p">=</span> <span class="s">"Finance Department"</span><span class="p">,</span> <span class="n">IsActive</span> <span class="p">=</span> <span class="k">false</span> <span class="p">}</span>
            <span class="p">);</span>
            <span class="n">_context</span><span class="p">.</span><span class="nf">SaveChanges</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetAllDepartmentsAsync_ReturnsAllDepartments</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">GetAllDepartmentsAsync</span><span class="p">();</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">HaveCount</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Contain</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">"HR"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Contain</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">"IT"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Contain</span><span class="p">(</span><span class="n">d</span> <span class="p">=&gt;</span> <span class="n">d</span><span class="p">.</span><span class="n">Name</span> <span class="p">==</span> <span class="s">"Finance"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartmentByIdAsync_WithValidId_ReturnsDepartment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">GetDepartmentByIdAsync</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">result</span><span class="p">!.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"HR"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="n">Description</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"Human Resources"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="n">IsActive</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeTrue</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">GetDepartmentByIdAsync_WithInvalidId_ReturnsNull</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">GetDepartmentByIdAsync</span><span class="p">(</span><span class="m">999</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeNull</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">CreateDepartmentAsync_WithValidData_CreatesDepartment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Arrange</span>
            <span class="kt">var</span> <span class="n">createDto</span> <span class="p">=</span> <span class="k">new</span> <span class="n">CreateDepartmentDto</span>
            <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="s">"New Department"</span><span class="p">,</span>
                <span class="n">Description</span> <span class="p">=</span> <span class="s">"A new test department"</span><span class="p">,</span>
                <span class="n">IsActive</span> <span class="p">=</span> <span class="k">true</span>
            <span class="p">};</span>

            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">CreateDepartmentAsync</span><span class="p">(</span><span class="n">createDto</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">result</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"New Department"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="n">Description</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"A new test department"</span><span class="p">);</span>
            <span class="n">result</span><span class="p">.</span><span class="n">IsActive</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeTrue</span><span class="p">();</span>
            <span class="n">result</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeGreaterThan</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>

            <span class="c1">// Verify it was actually saved</span>
            <span class="kt">var</span> <span class="n">savedDepartment</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Departments</span><span class="p">.</span><span class="nf">FindAsync</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">DepartmentId</span><span class="p">);</span>
            <span class="n">savedDepartment</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">NotBeNull</span><span class="p">();</span>
            <span class="n">savedDepartment</span><span class="p">!.</span><span class="n">Name</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">Be</span><span class="p">(</span><span class="s">"New Department"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DeleteDepartmentAsync_WithValidId_DeletesDepartment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">DeleteDepartmentAsync</span><span class="p">(</span><span class="m">3</span><span class="p">);</span> <span class="c1">// Delete Finance department</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeTrue</span><span class="p">();</span>

            <span class="c1">// Verify it was actually deleted</span>
            <span class="kt">var</span> <span class="n">deletedDepartment</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Departments</span><span class="p">.</span><span class="nf">FindAsync</span><span class="p">(</span><span class="m">3</span><span class="p">);</span>
            <span class="n">deletedDepartment</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeNull</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DeleteDepartmentAsync_WithInvalidId_ReturnsFalse</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">DeleteDepartmentAsync</span><span class="p">(</span><span class="m">999</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeFalse</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DepartmentExistsAsync_WithValidId_ReturnsTrue</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">DepartmentExistsAsync</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeTrue</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="p">[</span><span class="n">Fact</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">DepartmentExistsAsync_WithInvalidId_ReturnsFalse</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Act</span>
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_service</span><span class="p">.</span><span class="nf">DepartmentExistsAsync</span><span class="p">(</span><span class="m">999</span><span class="p">);</span>

            <span class="c1">// Assert</span>
            <span class="n">result</span><span class="p">.</span><span class="nf">Should</span><span class="p">().</span><span class="nf">BeFalse</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_context</span><span class="p">.</span><span class="nf">Dispose</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Run All Tests:</strong></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Navigate to test project directory</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HRM.Tests</span><span class="w">

</span><span class="c"># Run all tests</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w">

</span><span class="c"># Run tests with verbose output</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--verbosity</span><span class="w"> </span><span class="nx">normal</span><span class="w">

</span><span class="c"># Run tests and generate coverage report</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--collect</span><span class="p">:</span><span class="s2">"XPlat Code Coverage"</span><span class="w">

</span><span class="c"># Run specific test class</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--filter</span><span class="w"> </span><span class="s2">"DepartmentControllerTests"</span><span class="w">

</span><span class="c"># Run specific test method</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--filter</span><span class="w"> </span><span class="s2">"GetDepartments_ReturnsSuccessAndCorrectContentType"</span><span class="w">

</span><span class="c"># Run tests by category</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--filter</span><span class="w"> </span><span class="s2">"Category=Integration"</span><span class="w">
</span></code></pre></div></div>

<p><strong>Run Tests for Different Environments:</strong></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test against Development environment database</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--settings</span><span class="w"> </span><span class="nx">test.runsettings</span><span class="w">

</span><span class="c"># Test against QA environment database  </span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"QA"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">test</span><span class="w"> </span><span class="nt">--settings</span><span class="w"> </span><span class="nx">test.runsettings</span><span class="w">
</span></code></pre></div></div>

<p><strong>Create Test Configuration:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.Tests/test.runsettings</code>:</p>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;RunSettings&gt;</span>
  <span class="nt">&lt;DataCollectionRunSettings&gt;</span>
    <span class="nt">&lt;DataCollectors&gt;</span>
      <span class="nt">&lt;DataCollector</span> <span class="na">friendlyName=</span><span class="s">"XPlat code coverage"</span> <span class="na">uri=</span><span class="s">"datacollector://Microsoft/CodeCoverage/2.0"</span> <span class="na">assemblyQualifiedName=</span><span class="s">"Microsoft.CodeCoverage.Extensions.DataCollectors.DotNetCodeCoverageCollector, Microsoft.CodeCoverage.Extensions, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Configuration&gt;</span>
          <span class="nt">&lt;Format&gt;</span>json,cobertura,lcov,teamcity,opencover<span class="nt">&lt;/Format&gt;</span>
        <span class="nt">&lt;/Configuration&gt;</span>
      <span class="nt">&lt;/DataCollector&gt;</span>
    <span class="nt">&lt;/DataCollectors&gt;</span>
  <span class="nt">&lt;/DataCollectionRunSettings&gt;</span>
<span class="nt">&lt;/RunSettings&gt;</span>
</code></pre></div></div>

<p><strong>Test Output Analysis:</strong></p>

<p>Expected test results should show:</p>
<ul>
  <li>‚úÖ <strong>Integration Tests</strong>: Verify API endpoints work correctly across environments</li>
  <li>‚úÖ <strong>Unit Tests</strong>: Validate business logic in isolation with in-memory database</li>
  <li>‚úÖ <strong>Code Coverage</strong>: Measure how much of your code is tested</li>
  <li>‚úÖ <strong>Performance</strong>: Ensure tests run quickly (under 30 seconds total)</li>
</ul>

<p><strong>Benefits of This Testing Approach:</strong></p>
<ul>
  <li><strong>Isolation</strong>: Each test uses fresh in-memory database</li>
  <li><strong>Speed</strong>: Fast execution without real database overhead</li>
  <li><strong>Reliability</strong>: Consistent results across different environments</li>
  <li><strong>Coverage</strong>: Both API layer (integration) and service layer (unit) testing</li>
  <li><strong>CI/CD Ready</strong>: Can run in automated build pipelines</li>
</ul>

<p><strong>Create PowerShell Automation Script:</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">Scripts/Test-HRM-API.ps1</code>:</p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">param</span><span class="p">(</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$Environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="p">,</span><span class="w">
    </span><span class="p">[</span><span class="n">string</span><span class="p">]</span><span class="nv">$BaseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"http://localhost:5152"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"=======================================</span><span class="se">`n</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Cyan</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"HRM API AUTOMATED TEST SUITE</span><span class="se">`n</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Yellow</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Environment: </span><span class="nv">$Environment</span><span class="se">`n</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Base URL: </span><span class="nv">$BaseUrl</span><span class="se">`n</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"======================================="</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Cyan</span><span class="w">

</span><span class="nv">$tests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@()</span><span class="w">
</span><span class="nv">$startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w">

</span><span class="c"># Test 1: Get all departments</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"</span><span class="nv">$BaseUrl</span><span class="s2">/api/departments"</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Get</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Get Departments"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PASS"</span><span class="p">;</span><span class="w"> </span><span class="nx">Count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$response</span><span class="err">.</span><span class="nx">Count</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚úÖ Get Departments: PASSED (</span><span class="si">$(</span><span class="nv">$response</span><span class="o">.</span><span class="nf">Count</span><span class="si">)</span><span class="s2"> departments)"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Get Departments"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FAIL"</span><span class="p">;</span><span class="w"> </span><span class="nx">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$_</span><span class="err">.</span><span class="nx">Exception</span><span class="err">.</span><span class="nx">Message</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚ùå Get Departments: FAILED - </span><span class="si">$(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Exception</span><span class="o">.</span><span class="nf">Message</span><span class="si">)</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Test 2: Get all employees</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"</span><span class="nv">$BaseUrl</span><span class="s2">/api/employees"</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Get</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Get Employees"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PASS"</span><span class="p">;</span><span class="w"> </span><span class="nx">Count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$response</span><span class="err">.</span><span class="nx">Count</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚úÖ Get Employees: PASSED (</span><span class="si">$(</span><span class="nv">$response</span><span class="o">.</span><span class="nf">Count</span><span class="si">)</span><span class="s2"> employees)"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Get Employees"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FAIL"</span><span class="p">;</span><span class="w"> </span><span class="nx">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$_</span><span class="err">.</span><span class="nx">Exception</span><span class="err">.</span><span class="nx">Message</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚ùå Get Employees: FAILED - </span><span class="si">$(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Exception</span><span class="o">.</span><span class="nf">Message</span><span class="si">)</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Test 3: Create department</span><span class="w">
</span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$newDept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
        </span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test Department </span><span class="si">$(</span><span class="n">Get-Random</span><span class="p">)</span><span class="s2">"</span><span class="w">
        </span><span class="nx">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Automated test department"</span><span class="w">
        </span><span class="nx">isActive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$true</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertTo-Json</span><span class="w">
    
    </span><span class="nv">$response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"</span><span class="nv">$BaseUrl</span><span class="s2">/api/departments"</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Post</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$newDept</span><span class="w"> </span><span class="nt">-ContentType</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Create Department"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PASS"</span><span class="p">;</span><span class="w"> </span><span class="nx">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$response</span><span class="err">.</span><span class="nx">departmentId</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚úÖ Create Department: PASSED (ID: </span><span class="si">$(</span><span class="nv">$response</span><span class="o">.</span><span class="nf">departmentId</span><span class="si">)</span><span class="s2">)"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$tests</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">@{</span><span class="w"> </span><span class="nx">Name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Create Department"</span><span class="p">;</span><span class="w"> </span><span class="nx">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FAIL"</span><span class="p">;</span><span class="w"> </span><span class="nx">Error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$_</span><span class="err">.</span><span class="nx">Exception</span><span class="err">.</span><span class="nx">Message</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"‚ùå Create Department: FAILED - </span><span class="si">$(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">Exception</span><span class="o">.</span><span class="nf">Message</span><span class="si">)</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c"># Calculate summary</span><span class="w">
</span><span class="nv">$endTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-Date</span><span class="w">
</span><span class="nv">$duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$endTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nv">$startTime</span><span class="p">)</span><span class="o">.</span><span class="nf">TotalSeconds</span><span class="w">
</span><span class="nv">$passedTests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$tests</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Status</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s2">"PASS"</span><span class="w"> </span><span class="p">})</span><span class="o">.</span><span class="nf">Count</span><span class="w">
</span><span class="nv">$failedTests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$tests</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Where-Object</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">Status</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="s2">"FAIL"</span><span class="w"> </span><span class="p">})</span><span class="o">.</span><span class="nf">Count</span><span class="w">
</span><span class="nv">$successRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">math</span><span class="p">]::</span><span class="n">Round</span><span class="p">((</span><span class="nv">$passedTests</span><span class="w"> </span><span class="n">/</span><span class="w"> </span><span class="nv">$tests</span><span class="o">.</span><span class="nf">Count</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">100</span><span class="p">,</span><span class="w"> </span><span class="nx">2</span><span class="p">)</span><span class="w">

</span><span class="c"># Display summary</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"</span><span class="se">`n</span><span class="s2">======================================="</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Cyan</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"TEST SUMMARY"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Yellow</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"======================================="</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Cyan</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Duration: </span><span class="nv">$duration</span><span class="s2"> seconds"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">White</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Total Tests: </span><span class="si">$(</span><span class="nv">$tests</span><span class="o">.</span><span class="nf">Count</span><span class="si">)</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">White</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Passed: </span><span class="nv">$passedTests</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Green</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Failed: </span><span class="nv">$failedTests</span><span class="s2">"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Red</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"Success Rate: </span><span class="nv">$successRate</span><span class="s2">%"</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="err">$</span><span class="p">(</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$successRate</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="mi">80</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Green"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"Red"</span><span class="w"> </span><span class="p">})</span><span class="w">
</span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"======================================="</span><span class="w"> </span><span class="nt">-ForegroundColor</span><span class="w"> </span><span class="nx">Cyan</span><span class="w">

</span><span class="kr">return</span><span class="w"> </span><span class="nv">$successRate</span><span class="w"> </span><span class="o">-ge</span><span class="w"> </span><span class="mi">80</span><span class="w">
</span></code></pre></div></div>

<p><strong>Run Automated Tests:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Test Development environment</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">HRM.Tests\Scripts</span><span class="w">
</span><span class="o">.</span><span class="n">\Test-HRM-API.ps1</span><span class="w"> </span><span class="nt">-Environment</span><span class="w"> </span><span class="s2">"Development"</span><span class="w"> </span><span class="nt">-BaseUrl</span><span class="w"> </span><span class="s2">"http://localhost:5152"</span><span class="w">

</span><span class="c"># Test QA environment</span><span class="w">
</span><span class="o">.</span><span class="n">\Test-HRM-API.ps1</span><span class="w"> </span><span class="nt">-Environment</span><span class="w"> </span><span class="s2">"QA"</span><span class="w"> </span><span class="nt">-BaseUrl</span><span class="w"> </span><span class="s2">"http://localhost:5153"</span><span class="w">

</span><span class="c"># Test Production environment</span><span class="w">
</span><span class="o">.</span><span class="n">\Test-HRM-API.ps1</span><span class="w"> </span><span class="nt">-Environment</span><span class="w"> </span><span class="s2">"Production"</span><span class="w"> </span><span class="nt">-BaseUrl</span><span class="w"> </span><span class="s2">"http://localhost:5154"</span><span class="w">
</span></code></pre></div></div>

<p><strong>Step 12: Environment Diagnostics and CORS Configuration</strong></p>

<p><strong>Add Environment Diagnostics (Development only):</strong></p>
<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Add to Program.cs for debugging</span>
<span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">Environment</span><span class="p">.</span><span class="nf">IsDevelopment</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">MapGet</span><span class="p">(</span><span class="s">"/env"</span><span class="p">,</span> <span class="p">(</span><span class="n">IConfiguration</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">IWebHostEnvironment</span> <span class="n">env</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="p">{</span>
        <span class="n">Environment</span> <span class="p">=</span> <span class="n">env</span><span class="p">.</span><span class="n">EnvironmentName</span><span class="p">,</span>
        <span class="n">Connection</span> <span class="p">=</span> <span class="n">cfg</span><span class="p">.</span><span class="nf">GetConnectionString</span><span class="p">(</span><span class="s">"DefaultConnection"</span><span class="p">),</span>
        <span class="n">ApiSettings</span> <span class="p">=</span> <span class="n">cfg</span><span class="p">.</span><span class="nf">GetSection</span><span class="p">(</span><span class="s">"ApiSettings"</span><span class="p">).</span><span class="n">Get</span><span class="p">&lt;</span><span class="kt">object</span><span class="p">&gt;()</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Configure CORS per Environment:</strong>
Update <code class="language-plaintext highlighter-rouge">appsettings.json</code> files to include CORS settings:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"SecuritySettings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"EnableCors"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="nl">"AllowedOrigins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"http://localhost:3000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"https://localhost:3001"</span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Step 13: CI/CD Deployment Strategy</strong></p>

<p><strong>Build and Deployment Pipeline:</strong></p>
<ul>
  <li>Build once, promote through Dev ‚Üí QA ‚Üí Prod</li>
  <li>Override connection strings using environment variables in deployment</li>
  <li>Execute database migrations during deployment with proper approvals</li>
  <li>Run automated smoke tests after each deployment</li>
</ul>

<p><strong>Environment Variable Overrides:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Override connection string in production</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ConnectionStrings__DefaultConnection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Server=prod-server;Database=HRM_Prod;..."</span><span class="w">

</span><span class="c"># Override API settings</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ApiSettings__EnableSwagger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
</span><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ApiSettings__EnableDetailedErrors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"false"</span><span class="w">
</span></code></pre></div></div>

<p><strong>Post-Deployment Smoke Tests:</strong></p>
<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Verify deployment with automated tests</span><span class="w">
</span><span class="o">.</span><span class="n">\Test-HRM-API.ps1</span><span class="w"> </span><span class="nt">-Environment</span><span class="w"> </span><span class="s2">"Production"</span><span class="w"> </span><span class="nt">-BaseUrl</span><span class="w"> </span><span class="s2">"https://api.company.com"</span><span class="w">

</span><span class="c"># Expected: GET /api/departments returns 200 with seeded data</span><span class="w">
</span><span class="c"># Expected: All critical endpoints respond within acceptable time limits</span><span class="w">
</span></code></pre></div></div>

<p><strong>Step 10: Troubleshooting</strong></p>
<ul>
  <li>SQL connection errors: verify port 1433, credentials, and <code class="language-plaintext highlighter-rouge">TrustServerCertificate=true</code> (or configure certificates).</li>
  <li>Missing tables: ensure migrations applied; consider switching from <code class="language-plaintext highlighter-rouge">EnsureCreated()</code> to <code class="language-plaintext highlighter-rouge">Database.Migrate()</code>.</li>
  <li>No Swagger: available only in Development via <code class="language-plaintext highlighter-rouge">MapOpenApi()</code>.</li>
</ul>

<hr />

<p><strong>Appendix: Quick command reference (PowerShell)</strong></p>

<pre><code class="language-ps1"># Set environment
$env:ASPNETCORE_ENVIRONMENT = "Development"  # QA | Production

# Apply migrations
dotnet ef database update --project HRM.API.csproj --startup-project HRM.API.csproj

# Run
dotnet run
</code></pre>

<p>That‚Äôs it‚Äîyour HRM API now has a clear, repeatable multi-environment workflow with ASP.NET Core and SQL Server.</p>

<hr />

<p><strong>Note: How to use VS Code REST Client</strong></p>

<p><strong>Step 1: Install REST Client Extension</strong></p>
<ol>
  <li>Open VS Code</li>
  <li>Go to Extensions (Ctrl+Shift+X)</li>
  <li>Search for ‚ÄúREST Client‚Äù by Huachao Mao</li>
  <li>Click Install</li>
</ol>

<p><strong>Step 2: Create HTTP Request Files</strong>
Create <code class="language-plaintext highlighter-rouge">HRM.API/Tests/api-tests.http</code> in your project:</p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@baseUrl = http://localhost:5152
@contentType = application/json

### Development Environment Variables
# @name dev
@devUrl = http://localhost:5152

### QA Environment Variables  
# @name qa
@qaUrl = http://localhost:5153

### Production Environment Variables
# @name prod
@prodUrl = http://localhost:5154

### ============================================
### DEPARTMENT ENDPOINTS
### ============================================

### Get all departments (Development)
GET /api/departments
Accept: 

### Get all departments (QA)
GET /api/departments
Accept: 

### Get department by ID
GET /api/departments/1
Accept: 

### Create new department
POST /api/departments
Content-Type: 

{
  "name": "Quality Assurance",
  "description": "Software testing and quality control",
  "isActive": true
}

### ============================================
### EMPLOYEE ENDPOINTS  
### ============================================

### Get all employees
GET /api/employees
Accept: 

### Get employee by ID
GET /api/employees/1
Accept: 

### Create new employee
POST /api/employees
Content-Type: 

{
  "firstName": "Jane",
  "lastName": "Smith", 
  "email": "jane.smith@company.com",
  "phoneNumber": "+1-555-5678",
  "hireDate": "2024-10-12T00:00:00",
  "salary": 80000.00,
  "departmentId": 1
}

### Update employee
PUT /api/employees/1
Content-Type: 

{
  "employeeId": 1,
  "firstName": "Jane",
  "lastName": "Smith-Updated",
  "email": "jane.smith@company.com", 
  "phoneNumber": "+1-555-5678",
  "hireDate": "2024-10-12T00:00:00",
  "salary": 85000.00,
  "departmentId": 1
}

### Delete employee
DELETE /api/employees/1

### ============================================
### ENVIRONMENT-SPECIFIC TESTING
### ============================================

### Test Development Environment Health
GET /env
Accept: 

### Test QA Environment
GET /api/departments
Accept: 

### Test Production Environment  
GET /api/departments
Accept: 
</span></code></pre></div></div>

<p><strong>Step 3: Create Environment-Specific Request Files</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.API/Tests/development.http</code>:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@baseUrl = http://localhost:5152
@environment = Development

### Get all departments
GET /api/departments

### Environment diagnostics (Development only)
GET /env

### Create test department
POST /api/departments
Content-Type: application/json

{
  "name": "Test Dept ",
  "description": "Auto-generated test department",
  "isActive": true
}
</span></code></pre></div></div>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.API/Tests/qa.http</code>:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@baseUrl = http://localhost:5153
@environment = QA

### Get all departments
GET /api/departments

### Get all employees
GET /api/employees

### Create QA test data
POST /api/departments
Content-Type: application/json

{
  "name": "QA Test Department",
  "description": "Department for QA testing purposes",
  "isActive": true
}
</span></code></pre></div></div>

<p><strong>Step 4: How to Use REST Client</strong></p>

<ol>
  <li><strong>Start your API in the desired environment:</strong>
    <div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$</span><span class="nn">env</span><span class="p">:</span><span class="nv">ASPNETCORE_ENVIRONMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
</span><span class="n">dotnet</span><span class="w"> </span><span class="nx">run</span><span class="w"> </span><span class="nt">--launch-profile</span><span class="w"> </span><span class="nx">development</span><span class="w">
</span></code></pre></div>    </div>
  </li>
  <li><strong>Open the .http file in VS Code</strong></li>
  <li><strong>Click ‚ÄúSend Request‚Äù above any HTTP request</strong>
    <ul>
      <li>You‚Äôll see a clickable ‚ÄúSend Request‚Äù link above each <code class="language-plaintext highlighter-rouge">###</code> section</li>
      <li>Or use <code class="language-plaintext highlighter-rouge">Ctrl+Alt+R</code> keyboard shortcut</li>
    </ul>
  </li>
  <li><strong>View responses in the right panel:</strong>
    <ul>
      <li>Response status, headers, and body will appear</li>
      <li>JSON responses are automatically formatted</li>
    </ul>
  </li>
  <li><strong>Use variables for different environments:</strong>
    <ul>
      <li>Change <code class="language-plaintext highlighter-rouge">@baseUrl</code> variable to switch environments</li>
      <li>Use `` for dynamic test data</li>
    </ul>
  </li>
</ol>

<p><strong>Step 5: Advanced REST Client Features</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">HRM.API/Tests/advanced-tests.http</code>:</p>
<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">@baseUrl = http://localhost:5152

### Create department and store ID for later use
# @name createDept
POST /api/departments
Content-Type: application/json

{
  "name": "REST Client Test Dept",
  "description": "Created via REST Client",
  "isActive": true
}

### Use the created department ID in subsequent requests
@deptId = 

### Create employee in the new department
POST /api/employees
Content-Type: application/json

{
  "firstName": "REST",
  "lastName": "Client",
  "email": "rest.client@company.com",
  "phoneNumber": "+1-555-",
  "hireDate": "",
  "salary": 75000.00,
  "departmentId": 
}

### Clean up - delete the test department
DELETE /api/departments/
</span></code></pre></div></div>

<p><strong>Step 6: REST Client Settings</strong></p>

<p>Create <code class="language-plaintext highlighter-rouge">.vscode/settings.json</code> in your HRM project:</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"rest-client.environmentVariables"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"development"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"baseUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:5152"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"environment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Development"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"qa"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"baseUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:5153"</span><span class="p">,</span><span class="w"> 
      </span><span class="nl">"environment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QA"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"baseUrl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:5154"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"environment"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Production"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"rest-client.defaultHeaders"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"Accept"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Content-Type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/json"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Step 7: Switch Between Environments</strong></p>

<ol>
  <li><strong>Use Command Palette:</strong> <code class="language-plaintext highlighter-rouge">Ctrl+Shift+P</code> ‚Üí ‚ÄúREST Client: Switch Environment‚Äù</li>
  <li><strong>Select environment:</strong> development, qa, or production</li>
  <li><strong>All requests will use the selected environment variables</strong></li>
</ol>

<p><strong>Benefits of REST Client vs PowerShell:</strong></p>
<ul>
  <li>‚úÖ <strong>Visual responses:</strong> Formatted JSON, status codes, headers</li>
  <li>‚úÖ <strong>Request history:</strong> All past requests saved automatically</li>
  <li>‚úÖ <strong>Variables:</strong> Chain requests and reuse response data</li>
  <li>‚úÖ <strong>Environment switching:</strong> Easy toggle between Dev/QA/Prod</li>
  <li>‚úÖ <strong>Syntax highlighting:</strong> Better readability than command line</li>
  <li>‚úÖ <strong>Save/share:</strong> Commit .http files to version control for team sharing</li>
</ul>

<p><strong><a href="https://github.com/mahedee/code-sample02/tree/master/multi-env-app">Source code</a></strong></p>]]></content><author><name>Mahedee Hasan</name></author><category term="ASP.NET Core" /><category term="C#" /><category term="Web API" /><category term="Software Architecture" /><category term="Tutorials" /><category term="asp-net-core" /><category term="csharp" /><category term="web-api" /><category term="entity-framework" /><category term="sql-server" /><category term="configuration" /><category term="tutorial" /><category term="best-practices" /><category term="devops" /><category term="ci-cd" /><summary type="html"><![CDATA[In enterprise applications, we need to continuously switch between different environments for testing and running applications. In this article, I will show you how to create an application and configure it for testing in different environments like Dev, QA, and Prod without conflicts between environments. This is an ASP.NET Core Web API application using SQL Server with automated API testing.]]></summary></entry><entry><title type="html">Building a Professional Report Export API in ASP.NET Core: Excel, PDF &amp;amp; Word Generation with Template Architecture</title><link href="https://mahedee.net/Building-Professional-Report-Export-API-ASP-NET-Core-Excel-PDF-Word-Template-Architecture/" rel="alternate" type="text/html" title="Building a Professional Report Export API in ASP.NET Core: Excel, PDF &amp;amp; Word Generation with Template Architecture" /><published>2025-05-08T00:00:00-04:00</published><updated>2025-05-08T00:00:00-04:00</updated><id>https://mahedee.net/Building-Professional-Report-Export-API-ASP-NET-Core-Excel-PDF-Word-Template-Architecture</id><content type="html" xml:base="https://mahedee.net/Building-Professional-Report-Export-API-ASP-NET-Core-Excel-PDF-Word-Template-Architecture/"><![CDATA[<p><strong>Introduction</strong></p>

<p>In modern enterprise applications, the ability to export data into professional reports is essential for business operations, compliance, and decision-making. Whether it‚Äôs generating employee reports, financial statements, or operational dashboards, having a robust and scalable report generation system is crucial for any business application.</p>

<p>A Report Export API serves as a centralized solution that can transform your application data into professionally formatted documents across multiple formats. This approach not only ensures consistency in branding and styling but also provides flexibility for different use cases and user preferences.</p>

<p>This comprehensive guide demonstrates how to build a robust Report Export API in ASP.NET Core using a template-based architecture that supports Excel, PDF, and Word formats with professional branding and enterprise-ready features.</p>

<p><strong>Why Report Export APIs are Important</strong></p>

<p>Report export functionality is critical in enterprise applications for several reasons:</p>

<ul>
  <li><strong>Business Intelligence</strong>: Enables stakeholders to analyze data offline and create presentations</li>
  <li><strong>Compliance &amp; Auditing</strong>: Provides documentation trails required by regulatory frameworks</li>
  <li><strong>Data Sharing</strong>: Facilitates sharing of structured data across different teams and departments</li>
  <li><strong>Professional Presentation</strong>: Creates polished, branded reports for client-facing communications</li>
  <li><strong>Backup &amp; Archival</strong>: Provides data snapshots for historical reference and backup purposes</li>
  <li><strong>Integration</strong>: Enables data exchange with external systems and third-party applications</li>
  <li><strong>User Experience</strong>: Gives users flexibility to consume data in their preferred format</li>
</ul>

<p><strong>What You‚Äôll Learn</strong></p>

<p>In this tutorial, you will learn how to:</p>

<ul>
  <li>Design a scalable template-based architecture for report generation</li>
  <li>Implement professional Excel reports with EPPlus</li>
  <li>Create PDF documents with iTextSharp</li>
  <li>Generate Word documents with OpenXML</li>
  <li>Add company branding and professional styling</li>
  <li>Implement dependency injection for better testability</li>
  <li>Create reusable templates for different data types</li>
  <li>Build RESTful API endpoints for report downloads</li>
  <li>Handle multiple export formats efficiently</li>
</ul>

<p><strong>Tools and Technology Used</strong></p>

<ul>
  <li><strong>ASP.NET Core 8.0</strong>: Core framework for building the Web API</li>
  <li><strong>Entity Framework Core</strong>: Data access and in-memory database for demo</li>
  <li><strong>EPPlus 7.5.1</strong>: Excel file generation and manipulation</li>
  <li><strong>iTextSharp.LGPLv2.Core 3.4.22</strong>: PDF document generation</li>
  <li><strong>DocumentFormat.OpenXml 3.2.0</strong>: Word document generation</li>
  <li><strong>Swagger/OpenAPI</strong>: API documentation and testing</li>
  <li><strong>Visual Studio 2022</strong> or <strong>Visual Studio Code</strong>: Development environment</li>
  <li><strong>C# 12</strong>: Programming language</li>
  <li><strong>SQL Server</strong> (optional): Production database</li>
</ul>

<p><strong>Architecture Overview</strong></p>

<p>Our Report Export API follows a clean, template-based architecture that separates concerns and ensures maintainability:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ExportReportAPI/
‚îú‚îÄ‚îÄ Controllers/
‚îÇ   ‚îî‚îÄ‚îÄ EmployeesController.cs          # API endpoints
‚îú‚îÄ‚îÄ Data/
‚îÇ   ‚îú‚îÄ‚îÄ ApplicationDbContext.cs         # Database context
‚îÇ   ‚îî‚îÄ‚îÄ DatabaseSeeder.cs              # Sample data
‚îú‚îÄ‚îÄ Generator/
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IReportTemplate.cs          # Base template interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IExcelTemplate.cs           # Excel template interface
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IPDFTemplate.cs             # PDF template interface
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ IWordTemplate.cs            # Word template interface
‚îÇ   ‚îî‚îÄ‚îÄ Templates/
‚îÇ       ‚îú‚îÄ‚îÄ ExcelTemplate.cs            # Excel implementation
‚îÇ       ‚îú‚îÄ‚îÄ PDFTemplate.cs              # PDF implementation
‚îÇ       ‚îî‚îÄ‚îÄ WordTemplate.cs             # Word implementation
‚îú‚îÄ‚îÄ Models/
‚îÇ   ‚îú‚îÄ‚îÄ Employee.cs                     # Data model
‚îÇ   ‚îî‚îÄ‚îÄ ExportResult.cs                 # Export result wrapper
‚îú‚îÄ‚îÄ Services/
‚îÇ   ‚îú‚îÄ‚îÄ IExportService.cs              # Export service interface
‚îÇ   ‚îî‚îÄ‚îÄ ExportService.cs               # Export service implementation
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ mahedeedotnet_log.png          # Company logo
‚îî‚îÄ‚îÄ Program.cs                         # Application configuration
</code></pre></div></div>

<p><strong>Key Features</strong></p>

<ul>
  <li><strong>Template-Based Architecture</strong>: Reusable templates for different formats</li>
  <li><strong>Professional Branding</strong>: Company logo, headers, and consistent styling</li>
  <li><strong>Dependency Injection</strong>: Loosely coupled, testable components</li>
  <li><strong>Multiple Export Formats</strong>: Excel, PDF, and Word support</li>
  <li><strong>RESTful API Design</strong>: Clean, intuitive endpoints</li>
  <li><strong>Enterprise-Ready</strong>: Professional formatting and error handling</li>
</ul>

<hr />

<h2 id="step-1-create-aspnet-core-web-api-project">Step 1: Create ASP.NET Core Web API Project</h2>

<p>First, create a new ASP.NET Core Web API project:</p>

<p><strong>Option 1: Using Visual Studio</strong></p>
<ol>
  <li>Open Visual Studio 2022</li>
  <li>Click ‚ÄúCreate a new project‚Äù</li>
  <li>Select ‚ÄúASP.NET Core Web API‚Äù</li>
  <li>Name your project ‚ÄúExportReportAPI‚Äù</li>
  <li>Choose ‚Äú.NET 8.0‚Äù as the target framework</li>
  <li>Enable ‚ÄúUse controllers‚Äù and ‚ÄúEnable OpenAPI support‚Äù</li>
</ol>

<p><strong>Option 2: Using .NET CLI</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet new webapi <span class="nt">-n</span> ExportReportAPI
<span class="nb">cd </span>ExportReportAPI
</code></pre></div></div>

<hr />

<h2 id="step-2-install-required-nuget-packages">Step 2: Install Required NuGet Packages</h2>

<p>Install the necessary NuGet packages for report generation:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"DocumentFormat.OpenXml"</span> <span class="na">Version=</span><span class="s">"3.2.0"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"EPPlus"</span> <span class="na">Version=</span><span class="s">"7.5.1"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"iTextSharp.LGPLv2.Core"</span> <span class="na">Version=</span><span class="s">"3.4.22"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Microsoft.EntityFrameworkCore.InMemory"</span> <span class="na">Version=</span><span class="s">"8.0.11"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Swashbuckle.AspNetCore"</span> <span class="na">Version=</span><span class="s">"6.6.2"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<p><strong>Using Package Manager Console:</strong></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Install-Package</span><span class="w"> </span><span class="nx">EPPlus</span><span class="w"> </span><span class="nt">-Version</span><span class="w"> </span><span class="nx">7.5.1</span><span class="w">
</span><span class="n">Install-Package</span><span class="w"> </span><span class="nx">iTextSharp.LGPLv2.Core</span><span class="w"> </span><span class="nt">-Version</span><span class="w"> </span><span class="nx">3.4.22</span><span class="w">
</span><span class="n">Install-Package</span><span class="w"> </span><span class="nx">DocumentFormat.OpenXml</span><span class="w"> </span><span class="nt">-Version</span><span class="w"> </span><span class="nx">3.2.0</span><span class="w">
</span><span class="n">Install-Package</span><span class="w"> </span><span class="nx">Microsoft.EntityFrameworkCore.InMemory</span><span class="w"> </span><span class="nt">-Version</span><span class="w"> </span><span class="nx">8.0.11</span><span class="w">
</span></code></pre></div></div>

<p><strong>Using .NET CLI:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet add package EPPlus <span class="nt">--version</span> 7.5.1
dotnet add package iTextSharp.LGPLv2.Core <span class="nt">--version</span> 3.4.22
dotnet add package DocumentFormat.OpenXml <span class="nt">--version</span> 3.2.0
dotnet add package Microsoft.EntityFrameworkCore.InMemory <span class="nt">--version</span> 8.0.11
</code></pre></div></div>

<hr />

<h2 id="step-3-create-data-models">Step 3: Create Data Models</h2>

<p>Create the core data models for our application.</p>

<p><strong>Models/Employee.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ExportReportAPI.Models</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Employee</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">FullName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Designation</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Department</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Email</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">Phone</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">decimal</span> <span class="n">Salary</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">JoinDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Models/ExportResult.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ExportReportAPI.Models</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Represents the result of an export operation</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExportResult</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">byte</span><span class="p">[]</span> <span class="n">Data</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="n">Array</span><span class="p">.</span><span class="n">Empty</span><span class="p">&lt;</span><span class="kt">byte</span><span class="p">&gt;();</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">ContentType</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
        <span class="k">public</span> <span class="kt">string</span> <span class="n">FileName</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-4-setup-database-context-and-seeding">Step 4: Setup Database Context and Seeding</h2>

<p><strong>Data/ApplicationDbContext.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Data</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ApplicationDbContext</span> <span class="p">:</span> <span class="n">DbContext</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="nf">ApplicationDbContext</span><span class="p">(</span><span class="n">DbContextOptions</span><span class="p">&lt;</span><span class="n">ApplicationDbContext</span><span class="p">&gt;</span> <span class="n">options</span><span class="p">)</span> <span class="p">:</span> <span class="k">base</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="n">DbSet</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">Employees</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="k">protected</span> <span class="k">override</span> <span class="k">void</span> <span class="nf">OnModelCreating</span><span class="p">(</span><span class="n">ModelBuilder</span> <span class="n">modelBuilder</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">base</span><span class="p">.</span><span class="nf">OnModelCreating</span><span class="p">(</span><span class="n">modelBuilder</span><span class="p">);</span>

            <span class="c1">// Configure Employee entity</span>
            <span class="n">modelBuilder</span><span class="p">.</span><span class="n">Entity</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;(</span><span class="n">entity</span> <span class="p">=&gt;</span>
            <span class="p">{</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">HasKey</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Id</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">FullName</span><span class="p">).</span><span class="nf">IsRequired</span><span class="p">().</span><span class="nf">HasMaxLength</span><span class="p">(</span><span class="m">100</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Designation</span><span class="p">).</span><span class="nf">IsRequired</span><span class="p">().</span><span class="nf">HasMaxLength</span><span class="p">(</span><span class="m">50</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Department</span><span class="p">).</span><span class="nf">IsRequired</span><span class="p">().</span><span class="nf">HasMaxLength</span><span class="p">(</span><span class="m">50</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Email</span><span class="p">).</span><span class="nf">IsRequired</span><span class="p">().</span><span class="nf">HasMaxLength</span><span class="p">(</span><span class="m">100</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Phone</span><span class="p">).</span><span class="nf">HasMaxLength</span><span class="p">(</span><span class="m">20</span><span class="p">);</span>
                <span class="n">entity</span><span class="p">.</span><span class="nf">Property</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Salary</span><span class="p">).</span><span class="nf">HasPrecision</span><span class="p">(</span><span class="m">18</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Data/DatabaseSeeder.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Data</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">DatabaseSeeder</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">SeedDatabase</span><span class="p">(</span><span class="n">ApplicationDbContext</span> <span class="n">context</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="k">return</span><span class="p">;</span> <span class="c1">// Database already seeded</span>
            <span class="p">}</span>

            <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span>
            <span class="p">{</span>
                <span class="k">new</span> <span class="n">Employee</span>
                <span class="p">{</span>
                    <span class="n">FullName</span> <span class="p">=</span> <span class="s">"John Doe"</span><span class="p">,</span>
                    <span class="n">Designation</span> <span class="p">=</span> <span class="s">"Software Engineer"</span><span class="p">,</span>
                    <span class="n">Department</span> <span class="p">=</span> <span class="s">"IT"</span><span class="p">,</span>
                    <span class="n">Email</span> <span class="p">=</span> <span class="s">"john.doe@company.com"</span><span class="p">,</span>
                    <span class="n">Phone</span> <span class="p">=</span> <span class="s">"+1-555-0101"</span><span class="p">,</span>
                    <span class="n">Salary</span> <span class="p">=</span> <span class="m">75000</span><span class="p">,</span>
                    <span class="n">JoinDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"2022-01-15"</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span>
                <span class="p">{</span>
                    <span class="n">FullName</span> <span class="p">=</span> <span class="s">"Jane Smith"</span><span class="p">,</span>
                    <span class="n">Designation</span> <span class="p">=</span> <span class="s">"Senior Developer"</span><span class="p">,</span>
                    <span class="n">Department</span> <span class="p">=</span> <span class="s">"IT"</span><span class="p">,</span>
                    <span class="n">Email</span> <span class="p">=</span> <span class="s">"jane.smith@company.com"</span><span class="p">,</span>
                    <span class="n">Phone</span> <span class="p">=</span> <span class="s">"+1-555-0102"</span><span class="p">,</span>
                    <span class="n">Salary</span> <span class="p">=</span> <span class="m">85000</span><span class="p">,</span>
                    <span class="n">JoinDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"2021-03-10"</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span>
                <span class="p">{</span>
                    <span class="n">FullName</span> <span class="p">=</span> <span class="s">"Michael Johnson"</span><span class="p">,</span>
                    <span class="n">Designation</span> <span class="p">=</span> <span class="s">"Project Manager"</span><span class="p">,</span>
                    <span class="n">Department</span> <span class="p">=</span> <span class="s">"PMO"</span><span class="p">,</span>
                    <span class="n">Email</span> <span class="p">=</span> <span class="s">"michael.johnson@company.com"</span><span class="p">,</span>
                    <span class="n">Phone</span> <span class="p">=</span> <span class="s">"+1-555-0103"</span><span class="p">,</span>
                    <span class="n">Salary</span> <span class="p">=</span> <span class="m">95000</span><span class="p">,</span>
                    <span class="n">JoinDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"2020-07-22"</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span>
                <span class="p">{</span>
                    <span class="n">FullName</span> <span class="p">=</span> <span class="s">"Sarah Wilson"</span><span class="p">,</span>
                    <span class="n">Designation</span> <span class="p">=</span> <span class="s">"UI/UX Designer"</span><span class="p">,</span>
                    <span class="n">Department</span> <span class="p">=</span> <span class="s">"Design"</span><span class="p">,</span>
                    <span class="n">Email</span> <span class="p">=</span> <span class="s">"sarah.wilson@company.com"</span><span class="p">,</span>
                    <span class="n">Phone</span> <span class="p">=</span> <span class="s">"+1-555-0104"</span><span class="p">,</span>
                    <span class="n">Salary</span> <span class="p">=</span> <span class="m">70000</span><span class="p">,</span>
                    <span class="n">JoinDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"2022-09-05"</span><span class="p">)</span>
                <span class="p">},</span>
                <span class="k">new</span> <span class="n">Employee</span>
                <span class="p">{</span>
                    <span class="n">FullName</span> <span class="p">=</span> <span class="s">"David Brown"</span><span class="p">,</span>
                    <span class="n">Designation</span> <span class="p">=</span> <span class="s">"DevOps Engineer"</span><span class="p">,</span>
                    <span class="n">Department</span> <span class="p">=</span> <span class="s">"IT"</span><span class="p">,</span>
                    <span class="n">Email</span> <span class="p">=</span> <span class="s">"david.brown@company.com"</span><span class="p">,</span>
                    <span class="n">Phone</span> <span class="p">=</span> <span class="s">"+1-555-0105"</span><span class="p">,</span>
                    <span class="n">Salary</span> <span class="p">=</span> <span class="m">80000</span><span class="p">,</span>
                    <span class="n">JoinDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"2021-11-18"</span><span class="p">)</span>
                <span class="p">}</span>
            <span class="p">};</span>

            <span class="n">context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">AddRange</span><span class="p">(</span><span class="n">employees</span><span class="p">);</span>
            <span class="n">context</span><span class="p">.</span><span class="nf">SaveChanges</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-5-create-template-interfaces">Step 5: Create Template Interfaces</h2>

<p>Design the template interfaces that define the contract for each export format.</p>

<p><strong>Generator/Interfaces/IReportTemplate.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Base interface for all report templates</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IReportTemplate</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">T</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Generator/Interfaces/IExcelTemplate.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Interface for Excel report generation</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IExcelTemplate</span> <span class="p">:</span> <span class="n">IReportTemplate</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateExcelReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Generator/Interfaces/IPDFTemplate.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Interface for PDF report generation</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IPDFTemplate</span> <span class="p">:</span> <span class="n">IReportTemplate</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GeneratePDFReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Generator/Interfaces/IWordTemplate.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Interface for Word document generation</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IWordTemplate</span> <span class="p">:</span> <span class="n">IReportTemplate</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateWordReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-6-implement-excel-template">Step 6: Implement Excel Template</h2>

<p>Create a professional Excel template with company branding and styling.</p>

<p><strong>Generator/Templates/ExcelTemplate.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">OfficeOpenXml</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Generator.Templates</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Professional Excel report template with company branding</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExcelTemplate</span> <span class="p">:</span> <span class="n">IExcelTemplate</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">_logoPath</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">ExcelTemplate</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_logoPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">AppContext</span><span class="p">.</span><span class="n">BaseDirectory</span><span class="p">,</span> <span class="s">"images"</span><span class="p">,</span> <span class="s">"mahedeedotnet_log.png"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">data</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="nf">GenerateExcelReportAsync</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">reportTitle</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateExcelReportAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="nn">var</span> <span class="n">package</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ExcelPackage</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">worksheet</span> <span class="p">=</span> <span class="n">package</span><span class="p">.</span><span class="n">Workbook</span><span class="p">.</span><span class="n">Worksheets</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"Employees"</span><span class="p">);</span>
            
            <span class="kt">int</span> <span class="n">currentRow</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
            
            <span class="c1">// Add company header section</span>
            <span class="n">currentRow</span> <span class="p">=</span> <span class="nf">AddCompanyHeader</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">);</span>
            
            <span class="c1">// Add report title</span>
            <span class="n">currentRow</span> <span class="p">=</span> <span class="nf">AddReportTitle</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">reportTitle</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">);</span>
            
            <span class="c1">// Add additional info if provided</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">additionalInfo</span> <span class="p">!=</span> <span class="k">null</span> <span class="p">&amp;&amp;</span> <span class="n">additionalInfo</span><span class="p">.</span><span class="nf">Any</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">currentRow</span> <span class="p">=</span> <span class="nf">AddAdditionalInfo</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="c1">// Add data table</span>
            <span class="n">currentRow</span> <span class="p">=</span> <span class="nf">AddDataTable</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">employees</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">);</span>
            
            <span class="c1">// Add footer</span>
            <span class="nf">AddFooter</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">);</span>
            
            <span class="c1">// Apply styling and formatting</span>
            <span class="nf">ApplyWorksheetFormatting</span><span class="p">(</span><span class="n">worksheet</span><span class="p">);</span>

            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ExportResult</span>
            <span class="p">{</span>
                <span class="n">Data</span> <span class="p">=</span> <span class="n">package</span><span class="p">.</span><span class="nf">GetAsByteArray</span><span class="p">(),</span>
                <span class="n">ContentType</span> <span class="p">=</span> <span class="s">"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"</span><span class="p">,</span>
                <span class="n">FileName</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">reportTitle</span><span class="p">.</span><span class="nf">Replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">"_"</span><span class="p">)}</span><span class="s">_</span><span class="p">{</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">:</span><span class="n">yyyyMMdd_HHmmss</span><span class="p">}</span><span class="s">.xlsx"</span>
            <span class="p">};</span>

            <span class="k">return</span> <span class="k">await</span> <span class="n">Task</span><span class="p">.</span><span class="nf">FromResult</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">int</span> <span class="nf">AddCompanyHeader</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startRow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Add company logo</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">_logoPath</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">picture</span> <span class="p">=</span> <span class="n">worksheet</span><span class="p">.</span><span class="n">Drawings</span><span class="p">.</span><span class="nf">AddPicture</span><span class="p">(</span><span class="s">"CompanyLogo"</span><span class="p">,</span> <span class="k">new</span> <span class="nf">FileInfo</span><span class="p">(</span><span class="n">_logoPath</span><span class="p">));</span>
                <span class="n">picture</span><span class="p">.</span><span class="nf">SetPosition</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
                <span class="n">picture</span><span class="p">.</span><span class="nf">SetSize</span><span class="p">(</span><span class="m">150</span><span class="p">,</span> <span class="m">75</span><span class="p">);</span>
            <span class="p">}</span>
            
            <span class="kt">int</span> <span class="n">currentRow</span> <span class="p">=</span> <span class="n">startRow</span> <span class="p">+</span> <span class="m">4</span><span class="p">;</span> <span class="c1">// Leave space for logo</span>
            
            <span class="c1">// Company name</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"Mahedee.net"</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Bold</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="m">16</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Merge</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">HorizontalAlignment</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelHorizontalAlignment</span><span class="p">.</span><span class="n">Center</span><span class="p">;</span>
            <span class="n">currentRow</span><span class="p">++;</span>
            
            <span class="c1">// Company slogan</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"Think Simple"</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="m">12</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Merge</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">HorizontalAlignment</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelHorizontalAlignment</span><span class="p">.</span><span class="n">Center</span><span class="p">;</span>
            <span class="n">currentRow</span><span class="p">++;</span>
            
            <span class="c1">// Company address</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="s">"Toronto, ON, Canada"</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">currentRow</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Merge</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">currentRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">HorizontalAlignment</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelHorizontalAlignment</span><span class="p">.</span><span class="n">Center</span><span class="p">;</span>
            <span class="n">currentRow</span> <span class="p">+=</span> <span class="m">2</span><span class="p">;</span>
            
            <span class="k">return</span> <span class="n">currentRow</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">int</span> <span class="nf">AddReportTitle</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">,</span> <span class="kt">string</span> <span class="n">title</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startRow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">title</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Bold</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="m">14</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">startRow</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Merge</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">HorizontalAlignment</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelHorizontalAlignment</span><span class="p">.</span><span class="n">Center</span><span class="p">;</span>
            
            <span class="k">return</span> <span class="n">startRow</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">int</span> <span class="nf">AddAdditionalInfo</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span> <span class="n">additionalInfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startRow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">info</span> <span class="k">in</span> <span class="n">additionalInfo</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">info</span><span class="p">.</span><span class="n">Key</span><span class="p">}</span><span class="s">:"</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Bold</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">2</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">info</span><span class="p">.</span><span class="n">Value</span><span class="p">?.</span><span class="nf">ToString</span><span class="p">();</span>
                <span class="n">startRow</span><span class="p">++;</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="n">startRow</span> <span class="p">+</span> <span class="m">1</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">int</span> <span class="nf">AddDataTable</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">,</span> <span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startRow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Add headers</span>
            <span class="kt">string</span><span class="p">[]</span> <span class="n">headers</span> <span class="p">=</span> <span class="p">{</span> <span class="s">"ID"</span><span class="p">,</span> <span class="s">"Full Name"</span><span class="p">,</span> <span class="s">"Designation"</span><span class="p">,</span> <span class="s">"Department"</span><span class="p">,</span> <span class="s">"Email"</span><span class="p">,</span> <span class="s">"Phone"</span><span class="p">,</span> <span class="s">"Salary"</span><span class="p">,</span> <span class="s">"Join Date"</span> <span class="p">};</span>
            
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">headers</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="n">i</span> <span class="p">+</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">headers</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="p">}</span>
            
            <span class="c1">// Style headers</span>
            <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">range</span> <span class="p">=</span> <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">startRow</span><span class="p">,</span> <span class="n">headers</span><span class="p">.</span><span class="n">Length</span><span class="p">])</span>
            <span class="p">{</span>
                <span class="n">range</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Bold</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">range</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">Fill</span><span class="p">.</span><span class="n">PatternType</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelFillStyle</span><span class="p">.</span><span class="n">Solid</span><span class="p">;</span>
                <span class="n">range</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">Fill</span><span class="p">.</span><span class="n">BackgroundColor</span><span class="p">.</span><span class="nf">SetColor</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">Drawing</span><span class="p">.</span><span class="n">Color</span><span class="p">.</span><span class="n">LightBlue</span><span class="p">);</span>
                <span class="n">range</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="nf">BorderAround</span><span class="p">(</span><span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelBorderStyle</span><span class="p">.</span><span class="n">Thin</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">startRow</span><span class="p">++;</span>
            
            <span class="c1">// Add data</span>
            <span class="kt">var</span> <span class="n">employeeList</span> <span class="p">=</span> <span class="n">employees</span><span class="p">.</span><span class="nf">ToList</span><span class="p">();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">employeeList</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="kt">var</span> <span class="n">emp</span> <span class="p">=</span> <span class="n">employeeList</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Id</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">2</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">FullName</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">3</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Designation</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">4</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Department</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">5</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Email</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">6</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Phone</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">7</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">Salary</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">7</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Numberformat</span><span class="p">.</span><span class="n">Format</span> <span class="p">=</span> <span class="s">"$#,##0.00"</span><span class="p">;</span>
                <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="n">emp</span><span class="p">.</span><span class="n">JoinDate</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"yyyy-MM-dd"</span><span class="p">);</span>
                
                <span class="c1">// Add borders</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">range</span> <span class="p">=</span> <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">startRow</span> <span class="p">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">headers</span><span class="p">.</span><span class="n">Length</span><span class="p">])</span>
                <span class="p">{</span>
                    <span class="n">range</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="nf">BorderAround</span><span class="p">(</span><span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelBorderStyle</span><span class="p">.</span><span class="n">Thin</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
            
            <span class="k">return</span> <span class="n">startRow</span> <span class="p">+</span> <span class="n">employeeList</span><span class="p">.</span><span class="n">Count</span> <span class="p">+</span> <span class="m">2</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">AddFooter</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">,</span> <span class="kt">int</span> <span class="n">startRow</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Value</span> <span class="p">=</span> <span class="s">$"Generated on: </span><span class="p">{</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">:</span><span class="n">yyyy</span><span class="p">-</span><span class="n">MM</span><span class="p">-</span><span class="n">dd</span> <span class="n">HH</span><span class="p">:</span><span class="n">mm</span><span class="p">}</span><span class="s">"</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">startRow</span><span class="p">,</span> <span class="m">8</span><span class="p">].</span><span class="n">Merge</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="p">=</span> <span class="m">9</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">HorizontalAlignment</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">Style</span><span class="p">.</span><span class="n">ExcelHorizontalAlignment</span><span class="p">.</span><span class="n">Center</span><span class="p">;</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">[</span><span class="n">startRow</span><span class="p">,</span> <span class="m">1</span><span class="p">].</span><span class="n">Style</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Italic</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="nf">ApplyWorksheetFormatting</span><span class="p">(</span><span class="n">ExcelWorksheet</span> <span class="n">worksheet</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Auto-fit columns</span>
            <span class="n">worksheet</span><span class="p">.</span><span class="n">Cells</span><span class="p">.</span><span class="nf">AutoFitColumns</span><span class="p">();</span>
            
            <span class="c1">// Set minimum column widths</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">col</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span> <span class="n">col</span> <span class="p">&lt;=</span> <span class="m">8</span><span class="p">;</span> <span class="n">col</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">worksheet</span><span class="p">.</span><span class="nf">Column</span><span class="p">(</span><span class="n">col</span><span class="p">).</span><span class="n">Width</span> <span class="p">&lt;</span> <span class="m">10</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">worksheet</span><span class="p">.</span><span class="nf">Column</span><span class="p">(</span><span class="n">col</span><span class="p">).</span><span class="n">Width</span> <span class="p">=</span> <span class="m">10</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-7-create-export-service">Step 7: Create Export Service</h2>

<p>Create a service that orchestrates the different template implementations.</p>

<p><strong>Services/IExportService.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Services</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IExportService</span>
    <span class="p">{</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToExcelAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToPdfAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
        <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToWordAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Services/ExportService.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Services</span>
<span class="p">{</span>
    <span class="c1">/// &lt;summary&gt;</span>
    <span class="c1">/// Main export service that coordinates different template implementations</span>
    <span class="c1">/// &lt;/summary&gt;</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ExportService</span> <span class="p">:</span> <span class="n">IExportService</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IExcelTemplate</span> <span class="n">_excelTemplate</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IPDFTemplate</span> <span class="n">_pdfTemplate</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IWordTemplate</span> <span class="n">_wordTemplate</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">ExportService</span><span class="p">(</span>
            <span class="n">IExcelTemplate</span> <span class="n">excelTemplate</span><span class="p">,</span>
            <span class="n">IPDFTemplate</span> <span class="n">pdfTemplate</span><span class="p">,</span>
            <span class="n">IWordTemplate</span> <span class="n">wordTemplate</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_excelTemplate</span> <span class="p">=</span> <span class="n">excelTemplate</span><span class="p">;</span>
            <span class="n">_pdfTemplate</span> <span class="p">=</span> <span class="n">pdfTemplate</span><span class="p">;</span>
            <span class="n">_wordTemplate</span> <span class="p">=</span> <span class="n">wordTemplate</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToExcelAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">_excelTemplate</span><span class="p">.</span><span class="nf">GenerateExcelReportAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">reportTitle</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToPdfAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">_pdfTemplate</span><span class="p">.</span><span class="nf">GeneratePDFReportAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">reportTitle</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">ExportToWordAsync</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">,</span> <span class="kt">string</span> <span class="n">reportTitle</span> <span class="p">=</span> <span class="s">"Employee Report"</span><span class="p">,</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;?</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">_wordTemplate</span><span class="p">.</span><span class="nf">GenerateWordReportAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="n">reportTitle</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-8-create-api-controller">Step 8: Create API Controller</h2>

<p>Implement the RESTful API endpoints for report generation.</p>

<p><strong>Controllers/EmployeesController.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Data</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Services</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.AspNetCore.Mvc</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ExportReportAPI.Controllers</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">ApiController</span><span class="p">]</span>
    <span class="p">[</span><span class="nf">Route</span><span class="p">(</span><span class="s">"api/[controller]"</span><span class="p">)]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">EmployeesController</span> <span class="p">:</span> <span class="n">ControllerBase</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">ApplicationDbContext</span> <span class="n">_context</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">IExportService</span> <span class="n">_exportService</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">EmployeesController</span><span class="p">(</span><span class="n">ApplicationDbContext</span> <span class="n">context</span><span class="p">,</span> <span class="n">IExportService</span> <span class="n">exportService</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_context</span> <span class="p">=</span> <span class="n">context</span><span class="p">;</span>
            <span class="n">_exportService</span> <span class="p">=</span> <span class="n">exportService</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Get all employees</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;returns&gt;List of employees&lt;/returns&gt;</span>
        <span class="p">[</span><span class="n">HttpGet</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;&gt;&gt;</span> <span class="nf">GetEmployees</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">ToListAsync</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Get employee by ID</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="id"&gt;Employee ID&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;Employee details&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;&gt;</span> <span class="nf">GetEmployee</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">employee</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">FindAsync</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">employee</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nf">NotFound</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="n">employee</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Export employees to Excel format</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;returns&gt;Excel file download&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"export/excel"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">ExportToExcel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">ToListAsync</span><span class="p">();</span>
            
            <span class="kt">var</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
            <span class="p">{</span>
                <span class="p">{</span> <span class="s">"Report Type"</span><span class="p">,</span> <span class="s">"Employee Directory"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Total Records"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="n">Count</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Generated By"</span><span class="p">,</span> <span class="s">"Export Report API"</span> <span class="p">}</span>
            <span class="p">};</span>
            
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_exportService</span><span class="p">.</span><span class="nf">ExportToExcelAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="s">"Employee Directory Report"</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
            
            <span class="k">return</span> <span class="nf">File</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Export employees to PDF format</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;returns&gt;PDF file download&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"export/pdf"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">ExportToPdf</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">ToListAsync</span><span class="p">();</span>
            
            <span class="kt">var</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
            <span class="p">{</span>
                <span class="p">{</span> <span class="s">"Report Type"</span><span class="p">,</span> <span class="s">"Employee Directory"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Total Records"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="n">Count</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Generated By"</span><span class="p">,</span> <span class="s">"Export Report API"</span> <span class="p">}</span>
            <span class="p">};</span>
            
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_exportService</span><span class="p">.</span><span class="nf">ExportToPdfAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="s">"Employee Directory Report"</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
            
            <span class="k">return</span> <span class="nf">File</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Export employees to Word format</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;returns&gt;Word document file download&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"export/word"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">ExportToWord</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">ToListAsync</span><span class="p">();</span>
            
            <span class="kt">var</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
            <span class="p">{</span>
                <span class="p">{</span> <span class="s">"Report Type"</span><span class="p">,</span> <span class="s">"Employee Directory"</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Total Records"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="n">Count</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s">"Generated By"</span><span class="p">,</span> <span class="s">"Export Report API"</span> <span class="p">}</span>
            <span class="p">};</span>
            
            <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_exportService</span><span class="p">.</span><span class="nf">ExportToWordAsync</span><span class="p">(</span><span class="n">employees</span><span class="p">,</span> <span class="s">"Employee Directory Report"</span><span class="p">,</span> <span class="n">additionalInfo</span><span class="p">);</span>
            
            <span class="k">return</span> <span class="nf">File</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Create a new employee</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="employee"&gt;Employee data&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;Created employee&lt;/returns&gt;</span>
        <span class="p">[</span><span class="n">HttpPost</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ActionResult</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;&gt;</span> <span class="nf">PostEmployee</span><span class="p">(</span><span class="n">Employee</span> <span class="n">employee</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">employee</span><span class="p">);</span>
            <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="nf">SaveChangesAsync</span><span class="p">();</span>

            <span class="k">return</span> <span class="nf">CreatedAtAction</span><span class="p">(</span><span class="s">"GetEmployee"</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">id</span> <span class="p">=</span> <span class="n">employee</span><span class="p">.</span><span class="n">Id</span> <span class="p">},</span> <span class="n">employee</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Update an existing employee</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="id"&gt;Employee ID&lt;/param&gt;</span>
        <span class="c1">/// &lt;param name="employee"&gt;Updated employee data&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;No content on success&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpPut</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">PutEmployee</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">,</span> <span class="n">Employee</span> <span class="n">employee</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="p">!=</span> <span class="n">employee</span><span class="p">.</span><span class="n">Id</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nf">BadRequest</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">_context</span><span class="p">.</span><span class="nf">Entry</span><span class="p">(</span><span class="n">employee</span><span class="p">).</span><span class="n">State</span> <span class="p">=</span> <span class="n">EntityState</span><span class="p">.</span><span class="n">Modified</span><span class="p">;</span>

            <span class="k">try</span>
            <span class="p">{</span>
                <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="nf">SaveChangesAsync</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">catch</span> <span class="p">(</span><span class="n">DbUpdateConcurrencyException</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(!</span><span class="nf">EmployeeExists</span><span class="p">(</span><span class="n">id</span><span class="p">))</span>
                <span class="p">{</span>
                    <span class="k">return</span> <span class="nf">NotFound</span><span class="p">();</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="k">throw</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">return</span> <span class="nf">NoContent</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;</span>
        <span class="c1">/// Delete an employee</span>
        <span class="c1">/// &lt;/summary&gt;</span>
        <span class="c1">/// &lt;param name="id"&gt;Employee ID&lt;/param&gt;</span>
        <span class="c1">/// &lt;returns&gt;No content on success&lt;/returns&gt;</span>
        <span class="p">[</span><span class="nf">HttpDelete</span><span class="p">(</span><span class="s">"{id}"</span><span class="p">)]</span>
        <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">DeleteEmployee</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">employee</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">FindAsync</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">employee</span> <span class="p">==</span> <span class="k">null</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">return</span> <span class="nf">NotFound</span><span class="p">();</span>
            <span class="p">}</span>

            <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">employee</span><span class="p">);</span>
            <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="nf">SaveChangesAsync</span><span class="p">();</span>

            <span class="k">return</span> <span class="nf">NoContent</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="kt">bool</span> <span class="nf">EmployeeExists</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span><span class="p">.</span><span class="nf">Any</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">id</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="step-9-configure-application-startup">Step 9: Configure Application Startup</h2>

<p>Configure dependency injection and application settings.</p>

<p><strong>Program.cs</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">ExportReportAPI.Data</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Generator.Interfaces</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Generator.Templates</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Models</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">ExportReportAPI.Services</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Microsoft.EntityFrameworkCore</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Reflection</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">WebApplication</span><span class="p">.</span><span class="nf">CreateBuilder</span><span class="p">(</span><span class="n">args</span><span class="p">);</span>

<span class="c1">// Add services to the container.</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddDbContext</span><span class="p">&lt;</span><span class="n">ApplicationDbContext</span><span class="p">&gt;(</span><span class="n">options</span> <span class="p">=&gt;</span>
    <span class="n">options</span><span class="p">.</span><span class="nf">UseInMemoryDatabase</span><span class="p">(</span><span class="s">"EmployeeDb"</span><span class="p">));</span>

<span class="c1">// Register template services</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IExcelTemplate</span><span class="p">,</span> <span class="n">ExcelTemplate</span><span class="p">&gt;();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IPDFTemplate</span><span class="p">,</span> <span class="n">PDFTemplate</span><span class="p">&gt;();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IWordTemplate</span><span class="p">,</span> <span class="n">WordTemplate</span><span class="p">&gt;();</span>

<span class="c1">// Register main export service</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddScoped</span><span class="p">&lt;</span><span class="n">IExportService</span><span class="p">,</span> <span class="n">ExportService</span><span class="p">&gt;();</span>

<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddControllers</span><span class="p">();</span>

<span class="c1">// Learn more about configuring Swagger/OpenAPI at https://aka.ms/aspnetcore/swashbuckle</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddEndpointsApiExplorer</span><span class="p">();</span>
<span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">AddSwaggerGen</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span>
<span class="p">{</span>
    <span class="n">c</span><span class="p">.</span><span class="nf">SwaggerDoc</span><span class="p">(</span><span class="s">"v1"</span><span class="p">,</span> <span class="k">new</span><span class="p">()</span> <span class="p">{</span> 
        <span class="n">Title</span> <span class="p">=</span> <span class="s">"Export Report API"</span><span class="p">,</span> 
        <span class="n">Version</span> <span class="p">=</span> <span class="s">"v1"</span><span class="p">,</span>
        <span class="n">Description</span> <span class="p">=</span> <span class="s">"ASP.NET Core Web API for exporting reports in multiple formats (Excel, PDF, Word)"</span>
    <span class="p">});</span>
    
    <span class="c1">// Include XML comments for better documentation</span>
    <span class="kt">var</span> <span class="n">xmlFile</span> <span class="p">=</span> <span class="s">$"</span><span class="p">{</span><span class="n">Assembly</span><span class="p">.</span><span class="nf">GetExecutingAssembly</span><span class="p">().</span><span class="nf">GetName</span><span class="p">().</span><span class="n">Name</span><span class="p">}</span><span class="s">.xml"</span><span class="p">;</span>
    <span class="kt">var</span> <span class="n">xmlPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">AppContext</span><span class="p">.</span><span class="n">BaseDirectory</span><span class="p">,</span> <span class="n">xmlFile</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">File</span><span class="p">.</span><span class="nf">Exists</span><span class="p">(</span><span class="n">xmlPath</span><span class="p">))</span>
    <span class="p">{</span>
        <span class="n">c</span><span class="p">.</span><span class="nf">IncludeXmlComments</span><span class="p">(</span><span class="n">xmlPath</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Configure EPPlus license</span>
<span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">ExcelPackage</span><span class="p">.</span><span class="n">LicenseContext</span> <span class="p">=</span> <span class="n">OfficeOpenXml</span><span class="p">.</span><span class="n">LicenseContext</span><span class="p">.</span><span class="n">NonCommercial</span><span class="p">;</span>

<span class="kt">var</span> <span class="n">app</span> <span class="p">=</span> <span class="n">builder</span><span class="p">.</span><span class="nf">Build</span><span class="p">();</span>

<span class="c1">// Seed database with sample data</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">scope</span> <span class="p">=</span> <span class="n">app</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="nf">CreateScope</span><span class="p">())</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">context</span> <span class="p">=</span> <span class="n">scope</span><span class="p">.</span><span class="n">ServiceProvider</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="p">&lt;</span><span class="n">ApplicationDbContext</span><span class="p">&gt;();</span>
    <span class="n">DatabaseSeeder</span><span class="p">.</span><span class="nf">SeedDatabase</span><span class="p">(</span><span class="n">context</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Configure the HTTP request pipeline.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">app</span><span class="p">.</span><span class="n">Environment</span><span class="p">.</span><span class="nf">IsDevelopment</span><span class="p">())</span>
<span class="p">{</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">UseSwagger</span><span class="p">();</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">UseSwaggerUI</span><span class="p">(</span><span class="n">c</span> <span class="p">=&gt;</span>
    <span class="p">{</span>
        <span class="n">c</span><span class="p">.</span><span class="nf">SwaggerEndpoint</span><span class="p">(</span><span class="s">"/swagger/v1/swagger.json"</span><span class="p">,</span> <span class="s">"Export Report API V1"</span><span class="p">);</span>
        <span class="n">c</span><span class="p">.</span><span class="n">RoutePrefix</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span> <span class="c1">// Set Swagger UI at the app's root</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseHttpsRedirection</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">UseAuthorization</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">MapControllers</span><span class="p">();</span>

<span class="n">app</span><span class="p">.</span><span class="nf">Run</span><span class="p">();</span>
</code></pre></div></div>

<hr />

<h2 id="step-10-update-project-configuration">Step 10: Update Project Configuration</h2>

<p>Update the project file to include proper settings and logo copying.</p>

<p><strong>ExportReportAPI.csproj</strong></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;Project</span> <span class="na">Sdk=</span><span class="s">"Microsoft.NET.Sdk.Web"</span><span class="nt">&gt;</span>

  <span class="nt">&lt;PropertyGroup&gt;</span>
    <span class="nt">&lt;TargetFramework&gt;</span>net8.0<span class="nt">&lt;/TargetFramework&gt;</span>
    <span class="nt">&lt;Nullable&gt;</span>enable<span class="nt">&lt;/Nullable&gt;</span>
    <span class="nt">&lt;ImplicitUsings&gt;</span>enable<span class="nt">&lt;/ImplicitUsings&gt;</span>
    <span class="nt">&lt;GenerateDocumentationFile&gt;</span>true<span class="nt">&lt;/GenerateDocumentationFile&gt;</span>
    <span class="nt">&lt;NoWarn&gt;</span>$(NoWarn);1591<span class="nt">&lt;/NoWarn&gt;</span>
  <span class="nt">&lt;/PropertyGroup&gt;</span>

  <span class="nt">&lt;ItemGroup&gt;</span>
    <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"DocumentFormat.OpenXml"</span> <span class="na">Version=</span><span class="s">"3.2.0"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"EPPlus"</span> <span class="na">Version=</span><span class="s">"7.5.1"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"iTextSharp.LGPLv2.Core"</span> <span class="na">Version=</span><span class="s">"3.4.22"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Microsoft.EntityFrameworkCore.InMemory"</span> <span class="na">Version=</span><span class="s">"8.0.11"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;PackageReference</span> <span class="na">Include=</span><span class="s">"Swashbuckle.AspNetCore"</span> <span class="na">Version=</span><span class="s">"6.6.2"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/ItemGroup&gt;</span>

  <span class="nt">&lt;ItemGroup&gt;</span>
    <span class="nt">&lt;Content</span> <span class="na">Include=</span><span class="s">"images\**"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;CopyToOutputDirectory&gt;</span>PreserveNewest<span class="nt">&lt;/CopyToOutputDirectory&gt;</span>
    <span class="nt">&lt;/Content&gt;</span>
  <span class="nt">&lt;/ItemGroup&gt;</span>

<span class="nt">&lt;/Project&gt;</span>
</code></pre></div></div>

<hr />

<h2 id="step-11-add-company-logo">Step 11: Add Company Logo</h2>

<ol>
  <li>Create an <code class="language-plaintext highlighter-rouge">images</code> folder in your project root</li>
  <li>Add your company logo file (e.g., <code class="language-plaintext highlighter-rouge">mahedeedotnet_log.png</code>)</li>
  <li>The logo will be automatically included in the reports</li>
</ol>

<p><strong>Folder Structure:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ExportReportAPI/
‚îú‚îÄ‚îÄ images/
‚îÇ   ‚îî‚îÄ‚îÄ mahedeedotnet_log.png
</code></pre></div></div>

<hr />

<h2 id="step-12-run-and-test-the-application">Step 12: Run and Test the Application</h2>

<ol>
  <li><strong>Build and Run the Application:</strong></li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dotnet build
dotnet run
</code></pre></div></div>

<ol>
  <li><strong>Access Swagger UI:</strong>
    <ul>
      <li>Open your browser and navigate to <code class="language-plaintext highlighter-rouge">https://localhost:7xxx</code> (port will vary)</li>
      <li>You‚Äôll see the Swagger UI with all available endpoints</li>
    </ul>
  </li>
  <li><strong>Test Export Endpoints:</strong>
    <ul>
      <li><strong>Excel Export</strong>: <code class="language-plaintext highlighter-rouge">GET /api/employees/export/excel</code></li>
      <li><strong>PDF Export</strong>: <code class="language-plaintext highlighter-rouge">GET /api/employees/export/pdf</code></li>
      <li><strong>Word Export</strong>: <code class="language-plaintext highlighter-rouge">GET /api/employees/export/word</code></li>
    </ul>
  </li>
  <li><strong>Test with Sample Data:</strong>
    <ul>
      <li>The application automatically seeds sample employee data</li>
      <li>You can also add/modify employees through the CRUD endpoints</li>
    </ul>
  </li>
</ol>

<hr />

<h2 id="key-features-implemented">Key Features Implemented</h2>

<h3 id="1-template-based-architecture">1. <strong>Template-Based Architecture</strong></h3>
<ul>
  <li><strong>Reusable Templates</strong>: Each format has its own dedicated template class</li>
  <li><strong>Interface-Driven Design</strong>: Clear contracts for different export formats</li>
  <li><strong>Dependency Injection</strong>: Loosely coupled components for better testability</li>
</ul>

<h3 id="2-professional-branding">2. <strong>Professional Branding</strong></h3>
<ul>
  <li><strong>Company Logo</strong>: Automatically embedded in all report formats</li>
  <li><strong>Consistent Headers</strong>: Company name, slogan, and address</li>
  <li><strong>Professional Styling</strong>: Colors, fonts, and layout consistency</li>
</ul>

<h3 id="3-multi-format-support">3. <strong>Multi-Format Support</strong></h3>
<ul>
  <li><strong>Excel</strong>: Rich formatting with EPPlus</li>
  <li><strong>PDF</strong>: Professional layout with iTextSharp</li>
  <li><strong>Word</strong>: Structured documents with OpenXML</li>
</ul>

<h3 id="4-enterprise-features">4. <strong>Enterprise Features</strong></h3>
<ul>
  <li><strong>Custom Titles</strong>: Dynamic report titles</li>
  <li><strong>Additional Information</strong>: Support for metadata and extra details</li>
  <li><strong>Timestamp Footers</strong>: Generation timestamps and page numbers</li>
  <li><strong>Error Handling</strong>: Robust error handling and validation</li>
</ul>

<h3 id="5-api-design">5. <strong>API Design</strong></h3>
<ul>
  <li><strong>RESTful Endpoints</strong>: Clean, intuitive API design</li>
  <li><strong>Swagger Documentation</strong>: Comprehensive API documentation</li>
  <li><strong>File Downloads</strong>: Proper file response handling</li>
</ul>

<hr />

<h2 id="benefits-of-this-architecture">Benefits of This Architecture</h2>

<h3 id="1-maintainability">1. <strong>Maintainability</strong></h3>
<ul>
  <li>Each report format has its own dedicated class</li>
  <li>Clear separation of concerns</li>
  <li>Easy to modify individual formats without affecting others</li>
</ul>

<h3 id="2-reusability">2. <strong>Reusability</strong></h3>
<ul>
  <li>Templates can be reused for different data types</li>
  <li>Common branding and styling logic is encapsulated</li>
  <li>Easy to create new report types using existing templates</li>
</ul>

<h3 id="3-testability">3. <strong>Testability</strong></h3>
<ul>
  <li>Each template can be unit tested independently</li>
  <li>Mock dependencies easily for testing</li>
  <li>Clean interfaces make testing straightforward</li>
</ul>

<h3 id="4-extensibility">4. <strong>Extensibility</strong></h3>
<ul>
  <li>Easy to add new report formats (e.g., CSV, JSON)</li>
  <li>Simple to extend existing templates with new features</li>
  <li>Support for different data types beyond Employee</li>
</ul>

<h3 id="5-performance">5. <strong>Performance</strong></h3>
<ul>
  <li>Efficient memory usage with proper disposal</li>
  <li>Streaming for large datasets</li>
  <li>Asynchronous operations for better scalability</li>
</ul>

<hr />

<h2 id="advanced-usage-examples">Advanced Usage Examples</h2>

<h3 id="custom-report-with-additional-information">Custom Report with Additional Information</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="nf">HttpGet</span><span class="p">(</span><span class="s">"export/excel/custom"</span><span class="p">)]</span>
<span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">IActionResult</span><span class="p">&gt;</span> <span class="nf">ExportCustomExcel</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">var</span> <span class="n">employees</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_context</span><span class="p">.</span><span class="n">Employees</span>
        <span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Department</span> <span class="p">==</span> <span class="s">"IT"</span><span class="p">)</span>
        <span class="p">.</span><span class="nf">ToListAsync</span><span class="p">();</span>
    
    <span class="kt">var</span> <span class="n">additionalInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
    <span class="p">{</span>
        <span class="p">{</span> <span class="s">"Department Filter"</span><span class="p">,</span> <span class="s">"IT Department Only"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s">"Report Period"</span><span class="p">,</span> <span class="s">"Q4 2025"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s">"Generated By"</span><span class="p">,</span> <span class="s">"John Doe"</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s">"Total Records"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="n">Count</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s">"Average Salary"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="nf">Average</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Salary</span><span class="p">).</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"C"</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">};</span>
    
    <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="k">await</span> <span class="n">_exportService</span><span class="p">.</span><span class="nf">ExportToExcelAsync</span><span class="p">(</span>
        <span class="n">employees</span><span class="p">,</span> 
        <span class="s">"IT Department Employee Report"</span><span class="p">,</span> 
        <span class="n">additionalInfo</span>
    <span class="p">);</span>
    
    <span class="k">return</span> <span class="nf">File</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">Data</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">ContentType</span><span class="p">,</span> <span class="n">result</span><span class="p">.</span><span class="n">FileName</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="direct-template-usage">Direct Template Usage</h3>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">CustomReportService</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="k">readonly</span> <span class="n">IExcelTemplate</span> <span class="n">_excelTemplate</span><span class="p">;</span>
    
    <span class="k">public</span> <span class="nf">CustomReportService</span><span class="p">(</span><span class="n">IExcelTemplate</span> <span class="n">excelTemplate</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_excelTemplate</span> <span class="p">=</span> <span class="n">excelTemplate</span><span class="p">;</span>
    <span class="p">}</span>
    
    <span class="k">public</span> <span class="k">async</span> <span class="n">Task</span><span class="p">&lt;</span><span class="n">ExportResult</span><span class="p">&gt;</span> <span class="nf">GenerateMonthlyReport</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Employee</span><span class="p">&gt;</span> <span class="n">employees</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">var</span> <span class="n">customInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">,</span> <span class="kt">object</span><span class="p">&gt;</span>
        <span class="p">{</span>
            <span class="p">{</span> <span class="s">"Report Type"</span><span class="p">,</span> <span class="s">"Monthly Employee Report"</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s">"Period"</span><span class="p">,</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"MMMM yyyy"</span><span class="p">)</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s">"Department Count"</span><span class="p">,</span> <span class="n">employees</span><span class="p">.</span><span class="nf">GroupBy</span><span class="p">(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Department</span><span class="p">).</span><span class="nf">Count</span><span class="p">()</span> <span class="p">}</span>
        <span class="p">};</span>
        
        <span class="k">return</span> <span class="k">await</span> <span class="n">_excelTemplate</span><span class="p">.</span><span class="nf">GenerateExcelReportAsync</span><span class="p">(</span>
            <span class="n">employees</span><span class="p">,</span> 
            <span class="s">"Monthly Employee Report"</span><span class="p">,</span> 
            <span class="n">customInfo</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="future-enhancements">Future Enhancements</h2>

<p>The template-based architecture enables easy implementation of:</p>

<h3 id="1-additional-format-support">1. <strong>Additional Format Support</strong></h3>
<ul>
  <li>CSV export for data analysis</li>
  <li>JSON export for API integration</li>
  <li>XML export for legacy systems</li>
</ul>

<h3 id="2-advanced-features">2. <strong>Advanced Features</strong></h3>
<ul>
  <li>Charts and graphs integration</li>
  <li>Multiple worksheets/pages</li>
  <li>Dynamic template selection</li>
  <li>Custom report layouts</li>
</ul>

<h3 id="3-enterprise-features">3. <strong>Enterprise Features</strong></h3>
<ul>
  <li>Multi-language support</li>
  <li>Theme-based styling</li>
  <li>User-specific branding</li>
  <li>Report scheduling and automation</li>
</ul>

<h3 id="4-performance-optimizations">4. <strong>Performance Optimizations</strong></h3>
<ul>
  <li>Streaming for large datasets</li>
  <li>Background processing</li>
  <li>Caching for frequently generated reports</li>
  <li>Compression for large files</li>
</ul>

<hr />

<h2 id="conclusion">Conclusion</h2>

<p>This comprehensive guide demonstrated how to build a professional Report Export API in ASP.NET Core using a template-based architecture. The solution provides:</p>

<ul>
  <li><strong>Multiple Export Formats</strong>: Excel, PDF, and Word support</li>
  <li><strong>Professional Branding</strong>: Consistent company branding across all formats</li>
  <li><strong>Scalable Architecture</strong>: Template-based design for easy extension</li>
  <li><strong>Enterprise-Ready Features</strong>: Professional styling, error handling, and performance optimization</li>
  <li><strong>Clean API Design</strong>: RESTful endpoints with comprehensive documentation</li>
</ul>

<p>The template-based approach ensures that your report generation system is maintainable, testable, and easily extensible for future requirements. Whether you‚Äôre building internal business applications or client-facing systems, this architecture provides a solid foundation for professional report generation.</p>

<p>The complete source code provides a working example that you can customize and extend based on your specific business requirements. The separation of concerns and dependency injection make it easy to add new features, modify existing templates, or integrate with different data sources.</p>

<p><strong><a href="https://github.com/mahedee/code-sample02/tree/main/export-report-api">Complete Source Code Available</a></strong></p>]]></content><author><name>Mahedee Hasan</name></author><category term="ASP.NET" /><category term="ASP.NET Core" /><category term="C#" /><category term="Web API" /><category term="Reports" /><category term="csharp" /><category term="aspnetcore" /><category term="webapi" /><category term="excel" /><category term="pdf" /><category term="word" /><category term="reports" /><category term="epplus" /><category term="itextsharp" /><category term="openxml" /><summary type="html"><![CDATA[In modern enterprise applications, the ability to export data into professional reports is essential for business operations, compliance, and decision-making. This comprehensive guide demonstrates how to build a robust Report Export API in ASP.NET Core using a template-based architecture that supports Excel, PDF, and Word formats with professional branding and enterprise-ready features.]]></summary></entry><entry><title type="html">Structuring Agile Work Using Epics, Stories, Tasks, DoR, DoD, Artifact and more</title><link href="https://mahedee.net/structuring-agile-work-epics-stories-artifacts/" rel="alternate" type="text/html" title="Structuring Agile Work Using Epics, Stories, Tasks, DoR, DoD, Artifact and more" /><published>2025-04-01T00:00:00-04:00</published><updated>2025-04-01T00:00:00-04:00</updated><id>https://mahedee.net/structuring-agile-work-epics-stories-artifacts</id><content type="html" xml:base="https://mahedee.net/structuring-agile-work-epics-stories-artifacts/"><![CDATA[<!-- Article banner image (optional) -->
<!-- ![Binary Tree Traversal Banner](./images/binary-tree-traversal-banner.png) -->

<h2 id="introduction">Introduction</h2>

<p>In Agile product development, clearly defined Epics and User Stories are essential for delivering value efficiently, yet many teams face challenges like vague requirements, scope creep, and misaligned expectations. This guide provides a practical approach to defining, structuring, and using Epics and User Stories effectively, ensuring teams deliver the right value with clarity and speed. It covers how to define Epics with real examples, apply the INVEST framework for well-structured User Stories, and decompose Epics into coherent stories. You‚Äôll learn how to use a reusable Story template, handle questions and requirement gaps, assign work across skills without losing user value, and apply the Definition of Ready and Definition of Done. By mastering these practices, teams can prevent scope drift, speed up estimation and planning, improve testability and acceptance alignment, enhance stakeholder transparency, and meet compliance requirements. All examples in this guide use a <strong>School Management System (SMS)</strong> domain, chosen for its multiple personas (admins, teachers, students, parents), regulated data (attendance, grades), and measurable outcomes (engagement, timeliness, accuracy), making it ideal for illustrating good Epic and Story design.
This guide is structured to provide a snapshot of core concepts, followed by detailed sections on Epics, User Stories, acceptance criteria, and quality gates. It includes practical templates, checklists, and examples to help teams implement these practices effectively. Whether you are new to Agile or looking to refine your existing processes, this guide serves as a comprehensive resource for mastering Epics and User Stories in your product development lifecycle.</p>

<h2 id="table-of-contents">Table of Contents</h2>
<ul>
  <li><a href="#what-is-an-epic">What Is an Epic?</a>
    <ul>
      <li><a href="#practical-steps-to-define-an-epic">Practical Steps to Define an Epic</a></li>
      <li><a href="#epic-template">Epic Template</a></li>
      <li><a href="#example-epic-school-management-system">Example Epic (School Management System)</a></li>
      <li><a href="#epic-dod-template">Epic DoD Template</a></li>
      <li><a href="#epic-dod-example--automated-attendance-tracking--alerts">Epic DoD Example ‚Äì Automated Attendance Tracking &amp; Alerts</a></li>
    </ul>
  </li>
  <li><a href="#decomposing-epics-into-user-stories">Decomposing Epics into User Stories</a>
    <ul>
      <li><a href="#slicing-principles">Slicing Principles</a></li>
      <li><a href="#example-user-stories-based-on-the-epic-above">Example User Stories</a></li>
      <li><a href="#the-invest-framework">The INVEST Framework</a></li>
      <li><a href="#user-story-template">User Story Template</a></li>
      <li><a href="#example-functional-user-story-school-management-system">Example Functional User Story</a></li>
      <li><a href="#example-non-functional-user-story-school-management-system">Example Non-Functional User Story</a></li>
    </ul>
  </li>
  <li><a href="#decomposing-user-stories-into-tasks-and-subtasks">Decomposing User Stories into Tasks &amp; Subtasks</a>
    <ul>
      <li><a href="#why-decompose">Why Decompose</a></li>
      <li><a href="#definitions">Definitions</a></li>
      <li><a href="#task-template">Task Template</a></li>
      <li><a href="#subtask-template">Subtask Template</a></li>
      <li><a href="#example-based-on-secure-attendance-data-storage-user-story">Example Breakdown</a>
        <ul>
          <li><a href="#implement-data-encryption">Implement Data Encryption</a></li>
          <li><a href="#subtasks-for-task-1">Subtasks for Task 1</a></li>
          <li><a href="#implement-role-based-access-control-rbac">Implement Role-Based Access Control (RBAC)</a></li>
          <li><a href="#subtasks-for-task-2">Subtasks for Task 2</a></li>
          <li><a href="#setup-audit-logging-for-attendance-data-access">Setup Audit Logging</a></li>
          <li><a href="#subtasks-for-task-3">Subtasks for Task 3</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#important-notes--definition-of-ready">Important Notes / Definition of Ready</a>
    <ul>
      <li><a href="#definition-of-ready-dor">Definition of Ready (DoR)</a></li>
      <li><a href="#what-is-definition-of-ready">What is Definition of Ready?</a></li>
      <li><a href="#where-should-definition-of-ready-be-written">Where Should Definition of Ready Be Written?</a></li>
      <li><a href="#when-is-definition-of-ready-dor-used">When is Definition of Ready Used?</a></li>
      <li><a href="#sample-definition-of-ready-dor-checklist">Sample DoR Checklist</a></li>
    </ul>
  </li>
  <li><a href="#maintaining-clarification-logs">Maintaining Clarification Logs</a>
    <ul>
      <li><a href="#capturing-change-tracking">Capturing Change Tracking</a></li>
      <li><a href="#accommodating-wireframes-or-design-documents">Accommodating Wireframes / Design Docs</a></li>
      <li><a href="#summary-workflow-example">Summary Workflow Example</a></li>
      <li><a href="#tools-that-support-this-process">Tools that Support This Process</a></li>
    </ul>
  </li>
  <li><a href="#tooling--traceability">Tooling &amp; Traceability</a>
    <ul>
      <li><a href="#user-story-readiness-checklist">User Story Readiness Checklist</a></li>
      <li><a href="#agilescrum-artifacts">Agile/Scrum Artifacts</a></li>
    </ul>
  </li>
</ul>

<hr />

<h2 id="what-is-an-epic">What Is an Epic?</h2>
<p>In Agile, an <strong>Epic</strong> is a large, high-level body of work that represents a significant deliverable or business objective, too big to complete in a single iteration, and therefore broken down into multiple smaller, related 
<strong>User Stories</strong>.</p>

<p>It describes <em>what</em> needs to be achieved from a business perspective, without detailing the step-by-step tasks. Epics provide a broad context and vision, helping teams align on the ‚Äúbig picture‚Äù before diving into granular requirements.</p>

<p><strong>Example (School Management System):</strong>
Epic: <em>‚ÄúEnable online student attendance tracking for teachers‚Äù</em> ‚Äî This could later be decomposed into stories like ‚ÄúMark daily attendance,‚Äù ‚ÄúGenerate attendance reports,‚Äù and ‚ÄúNotify parents of absences.‚Äù</p>

<p>Would you like me to also give you <strong>a formal template for writing Epics</strong> so it stays consistent in your article?</p>

<h3 id="practical-steps-to-define-an-epic">Practical Steps to Define an Epic</h3>
<ol>
  <li>Start with a clear business objective (outcome wording).</li>
  <li>Express the problem in user or operational terms.</li>
  <li>Draft success metrics (target + baseline if known).</li>
  <li>Bound scope explicitly (what‚Äôs in / deferred).</li>
  <li>List personas impacted.</li>
  <li>Sketch capability slices (proto-stories).</li>
  <li>Capture dependencies &amp; risks.</li>
  <li>Define closure criteria (Epic DoD).</li>
</ol>

<h3 id="epic-template">Epic Template</h3>

<table>
  <thead>
    <tr>
      <th>Field</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr><td>Title</td><td>Outcome-oriented name</td></tr>
    <tr><td>Problem / Context</td><td>Current pain, constraint, opportunity</td></tr>
    <tr><td>Desired Outcome</td><td>Qualitative value statement</td></tr>
    <tr><td>Success Metrics</td><td>Quantified targets (KPI / leading indicators)</td></tr>
    <tr><td>Primary Personas</td><td>Direct beneficiaries</td></tr>
    <tr><td>Secondary Personas</td><td>Indirect stakeholders</td></tr>
    <tr><td>In Scope</td><td>Capabilities included now</td></tr>
    <tr><td>Out of Scope / Later</td><td>Deferred elements to prevent creep</td></tr>
    <tr><td>Capability Slices</td><td>Seed list of candidate stories</td></tr>
    <tr><td>Dependencies</td><td>External systems / other epics</td></tr>
    <tr><td>Risks / Assumptions</td><td>Key uncertainties</td></tr>
    <tr><td>Epic Definition of Done</td><td>Closure conditions (stories + metrics + docs)</td></tr>
  </tbody>
</table>

<h3 id="example-epic-school-management-system">Example Epic (School Management System)</h3>
<ul>
  <li><strong>Title:</strong> Automated Attendance Tracking &amp; Alerts</li>
  <li><strong>Problem:</strong> Teachers spend ~8 mins per class on manual attendance; late parent awareness drives support tickets.</li>
  <li><strong>Desired Outcome:</strong> Streamline attendance submission &amp; accelerate parent notification.</li>
  <li><strong>Success Metrics:</strong>
    <ul>
      <li>Median attendance submission time ‚â§ 2 minutes</li>
      <li>‚â• 75% unexcused absence notifications &lt; 10 minutes from class start</li>
      <li>Attendance-related support tickets ‚àí30%</li>
    </ul>
  </li>
  <li><strong>In Scope:</strong> Roster pre-population, bulk marking, correction window, absence notification, audit log.</li>
  <li><strong>Out of Scope (Now):</strong> Historical analytics dashboard, absence appeals workflow.</li>
  <li><strong>Capability Slices:</strong> Pre-populated roster; bulk remaining absent; parent notification; late arrival adjustment; incomplete attendance dashboard; anomaly detection; audit export.</li>
  <li><strong>Dependencies:</strong> Enrollment API, Notification Service, Authentication Service.</li>
  <li><strong>Risks / Assumptions:</strong> Parent contact data completeness ‚â• 95%; stable network in classrooms.</li>
  <li><strong>Epic DoD:</strong> All linked stories DoD met; metrics validated in staging baseline; documentation &amp; runbook updated; operations dashboard live.</li>
</ul>

<h3 id="epic-dod-template"><strong>Epic DoD Template</strong></h3>

<p>You can adapt this for any epic by filling in the specifics:</p>

<p><strong>Epic Definition of Done Template</strong></p>

<ol>
  <li>‚úÖ All linked user stories have met their respective DoD.</li>
  <li>üìä Success metrics for the epic validated in staging (or pre-production) against baseline targets.</li>
  <li>üìÑ User-facing documentation (release notes, help articles, FAQs) completed and approved.</li>
  <li>üõ†Ô∏è Technical documentation and runbooks updated for operations/support teams.</li>
  <li>üìà Monitoring &amp; operational dashboards live and reviewed by stakeholders.</li>
  <li>üîí Security, performance, and compliance checks passed.</li>
  <li>üöÄ Epic-level UAT (User Acceptance Testing) completed with sign-off.</li>
  <li>üìÖ Deployment plan created and communicated to all stakeholders.</li>
</ol>

<h3 id="epic-dod-example--automated-attendance-tracking--alerts"><strong>Epic DoD Example ‚Äì Automated Attendance Tracking &amp; Alerts</strong></h3>

<p><strong>Epic DoD:</strong></p>

<ol>
  <li>‚úÖ All linked user stories (roster pre-population, bulk absent marking, parent notifications, etc.) have passed their DoD including acceptance criteria, testing, and reviews.</li>
  <li>
    <p>üìä Success metrics validated in staging:</p>

    <ul>
      <li>Median attendance submission time ‚â§ 2 minutes</li>
      <li>‚â• 75% unexcused absence notifications sent in under 10 minutes</li>
      <li>Attendance-related support tickets projected to drop by 30%</li>
    </ul>
  </li>
  <li>üìÑ Teacher guide updated with steps for using bulk marking and correction windows; parent FAQ for absence notifications published.</li>
  <li>üõ†Ô∏è Support team runbook updated for troubleshooting notification failures; escalation paths documented.</li>
  <li>üìà Attendance operations dashboard live in production and verified by school admin team.</li>
  <li>üîí Privacy compliance checks passed for student data under education regulations.</li>
  <li>üöÄ UAT completed with school pilot group and sign-off obtained from product owner.</li>
  <li>üìÖ Deployment plan created and communicated to all stakeholders.</li>
</ol>

<hr />

<h2 id="decomposing-epics-into-user-stories">Decomposing Epics into User Stories</h2>

<h3 id="slicing-principles">Slicing Principles</h3>

<ul>
  <li><strong>Think vertical, not just technical:</strong> Each story should deliver something the user can actually see or use, instead of splitting only by backend, frontend, or database work.</li>
  <li><strong>One goal, one story:</strong> Focus each story on one user or system goal at a time.</li>
  <li><strong>Show real change:</strong> Every story should make something different in the product ‚Äî whether it‚Äôs a new feature, a visible improvement, or a behavior change.</li>
  <li><strong>Separate the tricky bits:</strong> If exceptions or edge cases make a story too big, pull them out into their own smaller stories.</li>
  <li><strong>Keep them as independent as possible:</strong> Try to write stories that can be built and released in any order, using things like mocks or feature flags to avoid blockers.</li>
</ul>

<h3 id="example-user-stories-based-on-the-epic-above">Example User Stories (Based on the Epic Above)</h3>

<ol>
  <li><strong>View Class Roster:</strong> As a teacher, I can see a pre-filled list of my students so I can start marking attendance right away.</li>
  <li><strong>Bulk Mark Absences:</strong> As a teacher, I can mark all unmarked students as absent in one step to save time.</li>
  <li><strong>Notify Parents Automatically:</strong> When a student is marked absent, the system sends a notification to their parent.</li>
  <li><strong>Parent Sends Excuse:</strong> As a parent, I can submit an absence excuse directly from the notification I receive.</li>
  <li><strong>Late Arrival Adjustment:</strong> As a teacher, I can change a student‚Äôs status from absent to late within a set grace period.</li>
  <li><strong>Track Incomplete Attendance:</strong> As an admin, I can see a dashboard of classes with missing attendance records after 15 minutes of class start.</li>
  <li><strong>Flag Attendance Anomalies:</strong> The system alerts staff when a student has three unexcused absences in a row.</li>
</ol>

<h3 id="33-the-invest-framework">3.3 The INVEST Framework</h3>

<p>The <strong>INVEST framework</strong> is a quick way to check if a user story is truly ready for development.
It was created by <em>Bill Wake</em> and acts like a quality checklist so your stories are clear, valuable, and doable.</p>

<p><strong>INVEST</strong> stands for:</p>

<table>
  <thead>
    <tr>
      <th>Letter</th>
      <th>Meaning</th>
      <th>Ask Yourself</th>
      <th>Watch Out For</th>
      <th>How to Fix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>I</strong></td>
      <td><strong>Independent</strong></td>
      <td>Can this story be built without waiting for another?</td>
      <td>Strong dependencies or shared acceptance criteria</td>
      <td>Use mocks/stubs, or split/merge stories logically</td>
    </tr>
    <tr>
      <td><strong>N</strong></td>
      <td><strong>Negotiable</strong></td>
      <td>Is the focus on <em>what</em> to achieve, not <em>how</em> to build it?</td>
      <td>Story forces a fixed design or tech choice</td>
      <td>Move technical details to notes; reframe around the value</td>
    </tr>
    <tr>
      <td><strong>V</strong></td>
      <td><strong>Valuable</strong></td>
      <td>Will a user (or system) gain clear value immediately?</td>
      <td>‚ÄúPlumbing only‚Äù or invisible backend work</td>
      <td>Add a thin, visible slice or combine with a related story</td>
    </tr>
    <tr>
      <td><strong>E</strong></td>
      <td><strong>Estimable</strong></td>
      <td>Can the team guess the effort with reasonable confidence?</td>
      <td>External API unknowns, unclear scope</td>
      <td>Do a research spike and capture assumptions</td>
    </tr>
    <tr>
      <td><strong>S</strong></td>
      <td><strong>Small</strong></td>
      <td>Can it be done comfortably within one sprint?</td>
      <td>Multiple workflows bundled together</td>
      <td>Break it into smaller stories by workflow or state</td>
    </tr>
    <tr>
      <td><strong>T</strong></td>
      <td><strong>Testable</strong></td>
      <td>Can we write clear pass/fail criteria?</td>
      <td>Vague terms like ‚Äúfast‚Äù or ‚Äúsecure‚Äù</td>
      <td>Define measurable criteria and include negative cases</td>
    </tr>
  </tbody>
</table>

<p><strong>Definition of Ready rule:</strong>
If a story fails any one of the INVEST checks, refine it before the sprint starts. A good story should pass all six.</p>

<p><strong>Why is it required?</strong></p>
<ul>
  <li>The INVEST framework helps:</li>
  <li>Improve clarity of user stories.</li>
  <li>Avoid ambiguity that leads to misunderstandings during development.</li>
  <li>Enable better planning because stories are easier to estimate and prioritize.</li>
  <li>Ensure quality so that stories are complete and testable.</li>
</ul>

<p><strong>When to use it?</strong></p>
<ul>
  <li>During backlog refinement to check the quality of new or existing user stories.</li>
  <li>Before development starts to confirm stories are ready for the team.</li>
  <li>During sprint planning to ensure each story is truly ‚Äúready to work on.‚Äù</li>
</ul>

<h3 id="34-user-story-template">3.4 <strong>User Story Template</strong></h3>

<p><strong>Title:</strong>
<em>A short, clear description of the goal (avoid technical jargon).</em></p>

<p><strong>Story:</strong>
<em>As a</em> <strong>[role/persona]</strong>
<em>I want</em> <strong>[what they want to do]</strong>
<em>So that</em> <strong>[why they want it / benefit / outcome]</strong></p>

<p><strong>Business Value / Metric Link:</strong>
What business value does this story deliver? How does it link to measurable success or outcomes?</p>

<p><strong>Background / Policy Context:</strong>
Any relevant context, policies, or business rules that impact this story.</p>

<p><strong>Acceptance Criteria:(Gherkin or bullets)</strong></p>

<ol>
  <li><em>[First clear, measurable condition that must be true for the story to be accepted]</em></li>
  <li><em>[Second condition]</em></li>
  <li><em>[Negative or edge case]</em></li>
  <li>Given ‚Ä¶ When ‚Ä¶ Then ‚Ä¶ (Gherkin format)</li>
  <li>Or bullet points specifying expected behavior.</li>
</ol>

<p><strong>Non-Functional Requirements (Story-specific):</strong>
Performance, usability, security, or other non-functional expectations specific to this story.</p>

<p><strong>Definition of Done (DoD) Checklist:</strong></p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Code developed and peer-reviewed</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Unit tests written and passing</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Integrated and tested in staging</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Documentation updated (user + technical)</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Meets performance/security requirements</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Accepted by Product Owner</li>
</ul>

<p><strong>Data/Fields / Notes / Constraints:</strong></p>

<ul>
  <li><em>Any design references, API contracts, or business rules that apply.</em></li>
  <li>Important data elements involved and any validation rules.</li>
</ul>

<p><strong>Assumptions:</strong>
Conditions or dependencies assumed true for this story.</p>

<p><strong>Out of Scope:</strong></p>
<ul>
  <li>What is explicitly excluded from this story‚Äôs scope?</li>
</ul>

<p><strong>Dependencies/Links:</strong></p>

<ul>
  <li><em>List of other stories, systems, or services needed.</em></li>
  <li>Other stories, features, APIs, or external services that this story depends on or relates to.</li>
</ul>

<p><strong>Security &amp; Privacy Notes:</strong>
Any security, authorization, or privacy considerations relevant to this story.</p>

<p><strong>Priority:</strong></p>

<ul>
  <li><em>High / Medium / Low</em></li>
</ul>

<h3 id="35-example-functional-user-story-school-management-system">3.5 <strong>Example Functional User Story (School Management System)</strong></h3>

<p><strong>Title:</strong>
Bulk Mark Remaining Students Absent</p>

<p><strong>Story:</strong>
<em>As a</em> <strong>teacher</strong>
<em>I want</em> <strong>to mark all remaining unmarked students as absent with a single click</strong>
<em>So that</em> <strong>I can save time during attendance and focus more on teaching</strong></p>

<p><strong>Business Value / Metric Link:</strong>
Reduces attendance marking time, improving teacher efficiency and classroom management. Targets reducing manual entry time by at least 50%.</p>

<p><strong>Background / Policy Context:</strong>
Attendance must be recorded daily as per school policy. Teachers often have limited time; bulk marking helps streamline the process. The feature integrates with existing roster pre-population.</p>

<p><strong>Acceptance Criteria (Gherkin or bullets):</strong></p>

<ul>
  <li>Bulk mark button is visible only after attendance marking has started.</li>
  <li>Clicking the bulk mark button marks all unmarked students as absent instantly.</li>
  <li>A confirmation prompt appears before bulk marking is applied to prevent mistakes.</li>
  <li>System logs bulk marking actions for audit purposes.</li>
</ul>

<p><strong>Non-Functional Requirements (Story-specific):</strong></p>

<ul>
  <li>Feature must work on both desktop and mobile web interfaces.</li>
  <li>Response time for bulk marking should be under 2 seconds for a class of up to 50 students.</li>
</ul>

<p><strong>Definition of Done (DoD) Checklist:</strong></p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Code developed and peer-reviewed</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Unit tests written and passing</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Integrated and tested in staging environment</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />User documentation and help guides updated</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Meets accessibility standards</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Approved by Product Owner</li>
</ul>

<p><strong>Data / Fields &amp; Validation Notes:</strong></p>

<ul>
  <li>Unmarked students identified by null attendance status.</li>
  <li>Confirmation dialog requires explicit user acceptance before applying changes.</li>
</ul>

<p><strong>Assumptions:</strong></p>

<ul>
  <li>The roster is pre-populated before attendance marking begins.</li>
  <li>Teacher is authenticated and authorized to mark attendance.</li>
</ul>

<p><strong>Out of Scope:</strong></p>

<ul>
  <li>Handling corrections or edits post bulk-marking (covered in separate stories).</li>
  <li>Notifications to parents based on attendance changes.</li>
</ul>

<p><strong>Dependencies / Links:</strong></p>

<ul>
  <li>Roster API for student lists</li>
  <li>Authentication Service for user identity</li>
</ul>

<p><strong>Security &amp; Privacy Notes:</strong></p>

<ul>
  <li>Only authorized teachers can perform bulk marking.</li>
  <li>Audit logs must be securely stored and accessible to admins only.</li>
</ul>

<p><strong>Priority:</strong>
High</p>

<h3 id="35-example-non-functional-user-story-school-management-system">3.5 Example Non-Functional User Story (School Management System)</h3>

<p><strong>Title:</strong>
Secure Attendance Data Storage</p>

<p><strong>Story:</strong>
<em>As a</em> <strong>compliance officer</strong>
<em>I want</em> <strong>all attendance data to be encrypted and access-controlled</strong>
<em>So that</em> <strong>sensitive student information is protected and the system complies with privacy regulations</strong></p>

<p><strong>Business Value / Metric Link:</strong>
Ensures compliance with data privacy laws such as GDPR and FERPA, reducing legal risks and building trust with parents and stakeholders.</p>

<p><strong>Background / Policy Context:</strong>
School data policies mandate strict handling of student records. Attendance data contains personally identifiable information (PII) that must be safeguarded.</p>

<p><strong>Acceptance Criteria (Gherkin or bullets):</strong></p>

<ul>
  <li>Attendance data is encrypted both at rest and in transit using industry-standard encryption.</li>
  <li>Role-based access control restricts attendance data access to authorized users only (teachers, admins).</li>
  <li>Audit logs track all access and modifications to attendance records.</li>
  <li>System passes security audits with no critical vulnerabilities.</li>
</ul>

<p><strong>Non-Functional Requirements (Story-specific):</strong></p>

<ul>
  <li>Encryption must comply with AES-256 standards or equivalent.</li>
  <li>Access control should integrate with existing authentication and authorization systems.</li>
  <li>Audit logs must be immutable and retained for at least 12 months.</li>
</ul>

<p><strong>Definition of Done (DoD) Checklist:</strong></p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Encryption implemented and verified in staging environment</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Access controls tested with positive and negative cases</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Audit logging operational and verified</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Security documentation updated</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Approved by Security and Compliance teams</li>
</ul>

<p><strong>Data / Fields &amp; Validation Notes:</strong></p>

<ul>
  <li>Sensitive fields: student name, attendance status, timestamps.</li>
  <li>Validation of encryption keys rotation policy.</li>
</ul>

<p><strong>Assumptions:</strong></p>

<ul>
  <li>Authentication system provides reliable user identity and roles.</li>
  <li>Encryption libraries are up-to-date and maintained.</li>
</ul>

<p><strong>Out of Scope:</strong></p>

<ul>
  <li>Encryption of other unrelated school data (handled separately).</li>
  <li>User training on security policies.</li>
</ul>

<p><strong>Dependencies / Links:</strong></p>

<ul>
  <li>Authentication Service</li>
  <li>Logging/Audit Service</li>
  <li>Security compliance standards (GDPR, FERPA)</li>
</ul>

<p><strong>Security &amp; Privacy Notes:</strong></p>

<ul>
  <li>Compliance with all applicable data protection regulations.</li>
  <li>Regular vulnerability scans and audits required.</li>
</ul>

<p><strong>Priority:</strong>
High</p>

<hr />

<h2 id="decomposing-user-stories-into-tasks-and-subtasks">Decomposing User Stories into Tasks and Subtasks</h2>

<h3 id="41-why-decompose">4.1 Why Decompose?</h3>

<p>User stories define <em>what</em> needs to be done, but tasks and subtasks break down the <em>how</em> ‚Äî the actual work units needed to implement the story. This helps with clear assignment, estimation, and tracking during development.</p>

<h3 id="42-definitions">4.2 Definitions:</h3>

<ul>
  <li><strong>Task:</strong> A distinct piece of work needed to complete a user story. Usually assigned to a developer or team member.</li>
  <li><strong>Subtask:</strong> Smaller steps or checks within a task, often used to track progress or ensure quality.</li>
</ul>

<h3 id="43-task-template">4.3 Task Template</h3>

<p><strong>Title:</strong>
Clear, concise description of the work to be done.</p>

<p><strong>Description:</strong>
Detailed explanation of what the task involves.</p>

<p><strong>Assigned To:</strong>
Person or role responsible.</p>

<p><strong>Estimated Effort:</strong>
Time estimate (hours/days).</p>

<p><strong>Acceptance Criteria:</strong>
Conditions for considering the task complete.</p>

<p><strong>Dependencies:</strong>
Other tasks or resources needed.</p>

<p><strong>Status:</strong>
Not started / In progress / Completed.</p>

<h3 id="44-subtask-template">4.4 Subtask Template</h3>

<p><strong>Title:</strong>
Brief description of the sub-step or check.</p>

<p><strong>Description:</strong>
Details on the subtask specifics.</p>

<p><strong>Assigned To:</strong>
Person or role.</p>

<p><strong>Estimated Effort:</strong>
Short time estimate.</p>

<p><strong>Status:</strong>
Not started / In progress / Completed.</p>

<h3 id="45-example-based-on-secure-attendance-data-storage-user-story">4.5 Example Based on Secure Attendance Data Storage User Story</h3>

<p><strong>User Story Recap: Secure Attendance Data Storage</strong> ‚Äî encrypt attendance data and enforce access control to protect student privacy.</p>

<h4 id="task-451-implement-data-encryption">Task 4.5.1: Implement Data Encryption</h4>

<p><strong>Description:</strong>
Apply AES-256 encryption for attendance data at rest and ensure data in transit is encrypted via TLS.</p>

<p><strong>Assigned To:</strong>
Backend Developer</p>

<p><strong>Estimated Effort:</strong>
2 days</p>

<p><strong>Acceptance Criteria:</strong></p>

<ul>
  <li>Data stored in the database is encrypted.</li>
  <li>Data transmitted over network uses TLS.</li>
  <li>Encryption keys management follows security guidelines.</li>
</ul>

<p><strong>Dependencies:</strong>
Security library, Database encryption support</p>

<h5 id="task-4511-subtasks-for-task-1">Task 4.5.1.1: Subtasks for Task 1</h5>

<ul>
  <li><strong>Subtask 1.1:</strong> Research AES-256 encryption library for .NET</li>
  <li><strong>Subtask 1.2:</strong> Implement encryption for attendance data before saving to database</li>
  <li><strong>Subtask 1.3:</strong> Implement decryption logic for retrieving data</li>
  <li><strong>Subtask 1.4:</strong> Configure TLS for all API endpoints handling attendance data</li>
  <li><strong>Subtask 1.5:</strong> Write unit tests to validate encryption and decryption</li>
</ul>

<h4 id="task-452-implement-role-based-access-control-rbac">Task 4.5.2: Implement Role-Based Access Control (RBAC)</h4>

<p><strong>Description:</strong>
Restrict access to attendance records based on user roles (Teacher, Admin, Compliance Officer).</p>

<p><strong>Assigned To:</strong>
Backend Developer</p>

<p><strong>Estimated Effort:</strong>
1.5 days</p>

<p><strong>Acceptance Criteria:</strong></p>

<ul>
  <li>Unauthorized users cannot access attendance data.</li>
  <li>Role permissions configurable and testable.</li>
  <li>Access attempts are logged.</li>
</ul>

<p><strong>Dependencies:</strong>
Authentication system, User roles definitions</p>

<h5 id="task-4521-subtasks-for-task-2">Task 4.5.2.1: Subtasks for Task 2</h5>

<ul>
  <li><strong>Subtask 2.1:</strong> Define role permissions matrix</li>
  <li><strong>Subtask 2.2:</strong> Implement access control middleware</li>
  <li><strong>Subtask 2.3:</strong> Integrate with existing authentication service</li>
  <li><strong>Subtask 2.4:</strong> Write tests for authorized and unauthorized access</li>
  <li><strong>Subtask 2.5:</strong> Implement access logging</li>
</ul>

<h3 id="453-task-3-setup-audit-logging-for-attendance-data-access">4.5.3 Task 3: Setup Audit Logging for Attendance Data Access</h3>

<p><strong>Description:</strong>
Track all access and modifications to attendance data for compliance.</p>

<p><strong>Assigned To:</strong>
DevOps / Backend Developer</p>

<p><strong>Estimated Effort:</strong>
1 day</p>

<p><strong>Acceptance Criteria:</strong></p>

<ul>
  <li>All access and change events are logged with timestamp and user ID.</li>
  <li>Logs are immutable and stored securely.</li>
  <li>Audit trail accessible for review.</li>
</ul>

<p><strong>Dependencies:</strong>
Logging infrastructure, Security policies</p>

<h5 id="task-4531-subtasks-for-task-3">Task 4.5.3.1: Subtasks for Task 3</h5>

<ul>
  <li><strong>Subtask 3.1:</strong> Configure audit logging service</li>
  <li><strong>Subtask 3.2:</strong> Instrument attendance data access points for logging</li>
  <li><strong>Subtask 3.3:</strong> Secure log storage setup</li>
  <li><strong>Subtask 3.4:</strong> Test audit log retrieval and integrity</li>
</ul>

<hr />

<h2 id="important-notes--definition-of-ready">Important Notes / Definition of Ready</h2>

<p><a id="definition-of-ready-dor"></a></p>
<h3 id="51-definition-of-ready-dor">5.1 Definition of Ready (DoR)</h3>

<p><strong>Definition of Ready (DoR)</strong> is a clear checklist or set of criteria that a user story (or work item) must meet before the team can confidently start working on it in a sprint or iteration. It ensures that the story is well-understood, actionable, and has everything needed to begin development without blockers.</p>

<hr />

<p><a id="what-is-definition-of-ready"></a></p>
<h4 id="511-what-is-definition-of-ready">5.1.1 What is Definition of Ready?</h4>

<ul>
  <li><strong>Purpose:</strong> To confirm that the user story is fully prepared for implementation.</li>
  <li><strong>Focus:</strong> Completeness of requirements, clarity, dependencies resolved, acceptance criteria defined, and any necessary designs or approvals available.</li>
  <li>
    <p><strong>Benefits:</strong></p>

    <ul>
      <li>Prevents starting work on vague or incomplete stories.</li>
      <li>Improves sprint planning accuracy.</li>
      <li>Reduces mid-sprint interruptions for clarifications.</li>
    </ul>
  </li>
</ul>

<hr />

<p><a id="where-should-definition-of-ready-be-written"></a></p>
<h4 id="512-where-should-definition-of-ready-be-written">5.1.2 Where Should Definition of Ready Be Written?</h4>

<ul>
  <li>
    <p><strong>In the Agile Tool or Backlog Management System:</strong>
Usually, DoR is maintained alongside user stories in tools like Jira, Azure DevOps, or Trello. It can be part of the story‚Äôs description, a checklist, or a linked artifact.</p>
  </li>
  <li>
    <p><strong>Team Documentation or Wiki:</strong>
Teams often document the <em>standard</em> DoR checklist in a shared space (e.g., Confluence, SharePoint) to align everyone on expectations.</p>
  </li>
  <li>
    <p><strong>In the Definition of Ready Policy or Team Working Agreement:</strong>
Formal Agile teams might maintain a DoR policy document as part of their team norms or working agreements.</p>
  </li>
</ul>

<hr />

<p><a id="when-is-definition-of-ready-dor-used"></a></p>
<h4 id="513-when-is-definition-of-ready-dor-used">5.1.3 When is Definition of Ready (DoR) Used?</h4>

<ul>
  <li>
    <p><strong>Before Sprint Planning:</strong>
To decide which user stories are ready to be included in the upcoming sprint backlog.</p>
  </li>
  <li>
    <p><strong>During Backlog Refinement/Grooming:</strong>
To review and prepare stories so they meet the readiness criteria before the sprint planning session.</p>
  </li>
  <li>
    <p><strong>Prior to Starting Development:</strong>
Ensures the development team has enough clarity and resources to start work without delays.</p>
  </li>
</ul>

<p><a id="sample-definition-of-ready-dor-checklist"></a></p>
<h4 id="514-sample-definition-of-ready-dor-checklist">5.1.4 Sample Definition of Ready (DoR) Checklist</h4>

<p>Before a user story can be marked as ‚ÄúReady‚Äù to work on, it should meet these criteria:</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Story description is clear, complete, and understandable.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Acceptance criteria are well-defined and testable.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Story scope is small enough to be completed within a sprint.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Dependencies are identified and resolved or planned.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />UX/UI designs, wireframes, or mockups are available if needed.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Non-functional requirements (performance, security, compliance) are specified.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Business value or user impact is clear.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Product Owner has reviewed and approved the story.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Story is estimated or ready for estimation.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Necessary environments, tools, and data are accessible to the team.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />Any risks or constraints are identified and communicated.</li>
</ul>

<hr />

<p><a id="maintaining-clarification-logs"></a></p>
<h2 id="maintaining-clarification-logs">Maintaining Clarification Logs</h2>

<ul>
  <li><strong>Purpose:</strong> Capture all questions, clarifications, and answers related to user stories or epics.</li>
  <li>
    <p><strong>Where to maintain:</strong></p>

    <ul>
      <li>In your project management tool (like Jira, Azure DevOps, or Trello), use a dedicated field or comment thread within the User Story or Epic.</li>
      <li>Alternatively, maintain a shared document or spreadsheet (e.g., Confluence page or Google Sheet) linked from the story.</li>
    </ul>
  </li>
  <li>
    <p><strong>Content to include:</strong></p>

    <ul>
      <li>Date and time of the question</li>
      <li>Person who raised the question</li>
      <li>Detailed description of the question or gap</li>
      <li>Clarification or answer provided</li>
      <li>Status (open, resolved)</li>
      <li>Link to relevant documentation if available</li>
    </ul>
  </li>
</ul>

<hr />

<p><a id="capturing-change-tracking"></a></p>
<h3 id="61-capturing-change-tracking">6.1 Capturing Change Tracking</h3>

<ul>
  <li><strong>Purpose:</strong> Track any scope changes or requirement updates discovered during development.</li>
  <li>
    <p><strong>How to do it:</strong></p>

    <ul>
      <li><strong>Change Request Process:</strong> Use your PM tool to raise change requests or create new user stories linked to the original.</li>
      <li><strong>Version Control:</strong> Update acceptance criteria and documentation with version history or timestamps.</li>
      <li><strong>Comments and Tags:</strong> Clearly tag stories or tasks with labels like ‚Äúchange-request‚Äù or ‚Äúscope-update.‚Äù</li>
      <li><strong>Approval Workflow:</strong> Changes should ideally go through Product Owner or Stakeholder approval before implementation.</li>
    </ul>
  </li>
  <li><strong>Why:</strong> This ensures transparency, auditability, and controlled scope management.</li>
</ul>

<hr />

<p><a id="accommodating-wireframes-or-design-documents"></a></p>
<h3 id="62-accommodating-wireframes-or-design-documents">6.2 Accommodating Wireframes or Design Documents</h3>

<ul>
  <li>
    <p><strong>Where to store:</strong></p>

    <ul>
      <li>
        <p>Use a centralized, accessible location such as:</p>

        <ul>
          <li>A Confluence page or SharePoint document library</li>
          <li>A cloud storage folder (Google Drive, OneDrive)</li>
          <li>Embedded attachments or links within the project management tool user story/task.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>How to associate:</strong></p>

    <ul>
      <li>Link design docs directly in the user story or task description.</li>
      <li>Mention version numbers or dates to avoid confusion with older files.</li>
      <li>Notify the development team about updates via comments or messaging channels.</li>
    </ul>
  </li>
  <li>
    <p><strong>Best Practices:</strong></p>

    <ul>
      <li>Keep wireframes/designs updated alongside requirements.</li>
      <li>Include annotations or notes on design changes relevant to development.</li>
    </ul>
  </li>
</ul>

<hr />

<p><a id="summary-workflow-example"></a></p>
<h3 id="63-summary-workflow-example">6.3 Summary Workflow Example</h3>

<ol>
  <li>Developer identifies a <strong>requirement gap</strong> or <strong>needs clarification</strong> ‚Üí logs a question in the clarification log or comments on the story.</li>
  <li>Product Owner or Business Analyst reviews and provides a <strong>clarification or decision</strong> ‚Üí updates the clarification log.</li>
  <li>If a <strong>change</strong> is required, a formal change request or additional user story is created, linked back to the original.</li>
  <li>Any new or updated <strong>wireframes/design docs</strong> are uploaded to the shared repository and linked in the relevant story.</li>
  <li>Team members are notified, and updates are tracked through the project management tool.</li>
</ol>

<hr />

<p><a id="tools-that-support-this-process"></a></p>
<h3 id="64-tools-that-support-this-process">6.4 Tools that Support This Process</h3>

<ul>
  <li><strong>Jira:</strong> Comments, custom fields, attachments, linked issues, change logs.</li>
  <li><strong>Azure DevOps:</strong> Work item discussions, attachments, version control.</li>
  <li><strong>Confluence:</strong> Collaborative pages for clarifications and design documentation.</li>
  <li><strong>Slack/Microsoft Teams:</strong> Real-time notifications linked to tasks.</li>
</ul>

<hr />

<p><a id="tooling--traceability"></a></p>
<h2 id="tooling--traceability">Tooling &amp; Traceability</h2>

<table>
  <thead>
    <tr>
      <th>Purpose</th>
      <th>Tool Type</th>
      <th>Examples</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Managing Backlog &amp; Hierarchy</td>
      <td>Work Tracking</td>
      <td>Jira, Azure DevOps</td>
    </tr>
    <tr>
      <td>Documenting Decisions &amp; Knowledge</td>
      <td>Wiki / Knowledge Base</td>
      <td>Confluence, Notion</td>
    </tr>
    <tr>
      <td>Source Code &amp; Story Linking</td>
      <td>Version Control System (VCS)</td>
      <td>GitHub, GitLab (with commit referencing story IDs)</td>
    </tr>
    <tr>
      <td>Automating Builds &amp; Deployments</td>
      <td>CI/CD Pipelines</td>
      <td>GitHub Actions, Azure Pipelines</td>
    </tr>
    <tr>
      <td>Creating &amp; Sharing Design Assets</td>
      <td>UI/UX Design Tools</td>
      <td>Figma</td>
    </tr>
    <tr>
      <td>Managing Test Cases &amp; Coverage</td>
      <td>Test Management</td>
      <td>Azure Test Plans, Xray, TestRail</td>
    </tr>
    <tr>
      <td>Monitoring Performance &amp; Logs</td>
      <td>Observability Tools</td>
      <td>Grafana, Elastic Stack, Datadog</td>
    </tr>
    <tr>
      <td>Checking Code Security &amp; Dependencies</td>
      <td>Security Scanning</td>
      <td>SonarQube, Dependabot</td>
    </tr>
  </tbody>
</table>

<p>Certainly! Here‚Äôs a rewritten version of the traceability chain with a simple text-based diagram to illustrate the flow:</p>

<hr />

<p><strong>Traceability Chain:</strong>
Objective / OKR ‚Üí Epic ‚Üí User Stories ‚Üí Tasks ‚Üí Commits / Tests ‚Üí Build / Deploy ‚Üí Telemetry ‚Üí Metric Dashboard.</p>

<p>Each step links to the next, ensuring full visibility from business goals through to live system metrics, helping teams track progress, quality, and impact end-to-end.</p>

<hr />

<p><a id="user-story-readiness-checklist"></a></p>
<h3 id="71-user-story-readiness-checklist">7.1 User Story Readiness Checklist</h3>

<ul>
  <li>
    <p><strong>Clear and Understandable</strong>
The story is clearly written and easy to understand by all team members.</p>
  </li>
  <li>
    <p><strong>Well Defined Acceptance Criteria</strong>
Acceptance criteria are specific, measurable, and testable.</p>
  </li>
  <li>
    <p><strong>Small and Scoped</strong>
The story is sized appropriately to fit within a sprint and focused on one goal.</p>
  </li>
  <li>
    <p><strong>Value Driven</strong>
The story delivers clear business or user value.</p>
  </li>
  <li>
    <p><strong>Dependencies Identified</strong>
Any external or internal dependencies are known and documented.</p>
  </li>
  <li>
    <p><strong>Testable</strong>
The story can be tested with clear pass/fail criteria.</p>
  </li>
  <li>
    <p><strong>Prioritized</strong>
The story is prioritized in the backlog according to business needs.</p>
  </li>
  <li>
    <p><strong>No Blocking Issues</strong>
There are no known blockers or unclear requirements preventing progress.</p>
  </li>
  <li>
    <p><strong>Team Agreement</strong>
The team has reviewed and agrees the story is ready to be worked on.</p>
  </li>
  <li>
    <p><strong>Non-Functional Requirements Included</strong>
Relevant performance, security, usability, or compliance needs are specified.</p>
  </li>
  <li>
    <p><strong>Data and Validation Needs Defined</strong>
Required data fields and validation rules are documented.</p>
  </li>
  <li>
    <p><strong>Design and Wireframes Provided</strong>
Necessary UI/UX designs or wireframes are attached or accessible.</p>
  </li>
  <li>
    <p><strong>Dependencies on Other Stories/Systems Are Tracked</strong>
Related stories or system integrations are noted.</p>
  </li>
</ul>

<hr />

<p><a id="agilescrum-artifacts"></a></p>
<h3 id="72-agilescrum-artifacts">7.2 Agile/Scrum Artifacts</h3>

<ol>
  <li>
    <p><strong>Product Backlog</strong></p>

    <ul>
      <li>A prioritized list of features, enhancements, bug fixes, and requirements for the product.</li>
    </ul>
  </li>
  <li>
    <p><strong>Sprint Backlog</strong></p>

    <ul>
      <li>The set of product backlog items selected for a sprint, plus a plan for delivering the product increment.</li>
    </ul>
  </li>
  <li>
    <p><strong>User Stories</strong></p>

    <ul>
      <li>Short, simple descriptions of a feature told from the perspective of the user.</li>
    </ul>
  </li>
  <li>
    <p><strong>Epics</strong></p>

    <ul>
      <li>Large user stories that can be broken down into smaller stories.</li>
    </ul>
  </li>
  <li>
    <p><strong>Tasks</strong></p>

    <ul>
      <li>Work items that break down user stories into actionable pieces for team members.</li>
    </ul>
  </li>
  <li>
    <p><strong>Burndown Chart</strong></p>

    <ul>
      <li>A graphical representation of work left to do versus time.</li>
    </ul>
  </li>
  <li>
    <p><strong>Increment (Potentially Shippable Product Increment)</strong></p>

    <ul>
      <li>The sum of all completed backlog items during a sprint that meets the Definition of Done.</li>
    </ul>
  </li>
  <li>
    <p><strong>Definition of Done (DoD)</strong></p>

    <ul>
      <li>A shared understanding of what it means for work to be complete.</li>
    </ul>
  </li>
  <li>
    <p><strong>Definition of Ready (DoR)</strong></p>

    <ul>
      <li>Criteria that a backlog item must meet before it can be worked on in a sprint.</li>
    </ul>
  </li>
  <li>
    <p><strong>Sprint Goal</strong></p>

    <ul>
      <li>The objective set for the sprint that guides the team.</li>
    </ul>
  </li>
  <li>
    <p><strong>Release Plan</strong></p>

    <ul>
      <li>A schedule for when features or increments will be delivered.</li>
    </ul>
  </li>
  <li>
    <p><strong>Impediment Log</strong></p>

    <ul>
      <li>A list of blockers or issues impacting the team‚Äôs progress.</li>
    </ul>
  </li>
  <li>
    <p><strong>Test Cases / Test Plans</strong></p>

    <ul>
      <li>Documentation of tests to verify backlog items meet requirements.</li>
    </ul>
  </li>
  <li>
    <p><strong>Retrospective Notes / Action Items</strong></p>

    <ul>
      <li>Insights and improvement tasks identified during sprint retrospectives.</li>
    </ul>
  </li>
  <li>
    <p><strong>Story Maps</strong></p>

    <ul>
      <li>Visual mapping of user stories to understand workflows and priorities.</li>
    </ul>
  </li>
  <li>
    <p><strong>Wireframes / Mockups</strong></p>

    <ul>
      <li>Visual designs or sketches of user interfaces.</li>
    </ul>
  </li>
  <li>
    <p><strong>Release Notes</strong></p>

    <ul>
      <li>Documentation of changes and new features in a product release.</li>
    </ul>
  </li>
</ol>

<hr />

<p><strong>Connect with me</strong>:</p>
<ul>
  <li>üíº <a href="https://www.linkedin.com/in/mahedee/">LinkedIn</a></li>
  <li>üêô <a href="https://github.com/mahedee">GitHub</a></li>
  <li>
    <h2 id="-blog">üìù <a href="https://mahedee.net/">Blog</a></h2>
  </li>
</ul>

<p>üåü <em>Found this helpful? Please share it with others who might benefit from understanding binary tree traversal algorithms.</em> üåü</p>]]></content><author><name>Mahedee Hasan</name></author><category term="Agile Practices" /><category term="Product Management" /><category term="Software Engineering" /><category term="Delivery Excellence" /><category term="agile" /><category term="epics" /><category term="user-stories" /><category term="tasks" /><category term="dod" /><category term="dor" /><category term="scrum-artifacts" /><summary type="html"><![CDATA[End-to-end practical reference for structuring agile work using epics, user stories, tasks, DoR, DoD, templates, and traceability.]]></summary></entry><entry><title type="html">Simplifying E-Commerce Order Processing with the Facade Design Pattern in C#</title><link href="https://mahedee.net/simplifying-e-commerce-order-processing-with-the-facade-design-pattern-in-csharp/" rel="alternate" type="text/html" title="Simplifying E-Commerce Order Processing with the Facade Design Pattern in C#" /><published>2025-03-05T00:00:00-05:00</published><updated>2025-03-05T00:00:00-05:00</updated><id>https://mahedee.net/simplifying-e-commerce-order-processing-with-the-facade-design-pattern-in-csharp</id><content type="html" xml:base="https://mahedee.net/simplifying-e-commerce-order-processing-with-the-facade-design-pattern-in-csharp/"><![CDATA[<p>Managing the complexity of modern software systems can be a daunting task, especially when interacting with multiple interconnected subsystems. One practical approach to handle this challenge is the Facade Design Pattern, which provides a simplified interface to access complex subsystems. In this article, we‚Äôll explore how the Facade Design Pattern can streamline the processing of orders in an e-commerce platform, using C# for implementation.</p>

<p><strong>What is the Facade Design Pattern?</strong>
The Facade Design Pattern is a structural pattern that simplifies the interaction between a client and multiple subsystems by providing a unified interface. It hides the complexities of the subsystems and offers a cleaner, more maintainable way for the client to access their functionality.</p>

<p><strong>Key components of the Facade Design Pattern</strong></p>

<ul>
  <li><strong>Facade</strong>: The interface that provides a simplified access to the subsystems.</li>
  <li><strong>Subsystem</strong>: The individual components or classes that make up the complex system.</li>
  <li><strong>Client</strong>: The code that interacts with the Facade to access the subsystems‚Äô functionality.</li>
</ul>

<p><strong>Problem Statement: E-Commerce Order Processing</strong>
In an e-commerce platform, order processing involves multiple systems:</p>

<ul>
  <li>Inventory Management: To check stock availability.</li>
  <li>Payment Gateway: To process payments securely.</li>
  <li>Shipping System: To schedule deliveries.</li>
  <li>Notification Service: To send order confirmation emails.</li>
</ul>

<p>Directly managing these subsystems can lead to:</p>

<ul>
  <li>Complex Code: Multiple layers of logic and interdependencies.</li>
  <li>Error-Prone Processes: Increased chances of bugs.</li>
  <li>Reduced Maintainability: Difficult to adapt to future changes.</li>
</ul>

<p><strong>Solution: Using the Facade Design Pattern</strong></p>

<p>By introducing a Facade, we encapsulate the complexity of these subsystems into a single interface, allowing the client to interact with them seamlessly.</p>

<p><strong>Key Components of the Solution</strong></p>

<ul>
  <li>Subsystems:
    <ul>
      <li>Handle individual responsibilities (e.g., Inventory, Payment, Shipping, Notification).</li>
    </ul>
  </li>
  <li>Facade:
    <ul>
      <li>Acts as the unified interface for the client.</li>
    </ul>
  </li>
  <li>Client:
    <ul>
      <li>Interacts only with the Facade for simplified order processing.</li>
    </ul>
  </li>
</ul>

<p><strong>UML Class Diagram of the Facade Design Pattern:</strong></p>

<p><img src="/assets/images/posts/2025/facade-ecommerce.drawio.png" alt="" /></p>

<p><strong>Implementation in C#</strong></p>

<p>Let‚Äôs implement the Facade Design Pattern for e-commerce order processing in C#.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ECommerceFacade</span>
<span class="p">{</span>

    <span class="c1">// Define subsystems</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">InventorySystem</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">CheckStock</span><span class="p">(</span><span class="kt">string</span> <span class="n">item</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Checking stock for </span><span class="p">{</span><span class="n">item</span><span class="p">}</span><span class="s">..."</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// Assume stock is available</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">UpdateInventory</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Updating inventory..."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">PaymentGateway</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">bool</span> <span class="nf">ProcessPayment</span><span class="p">(</span><span class="kt">string</span> <span class="n">cardDetails</span><span class="p">,</span> <span class="kt">decimal</span> <span class="n">amount</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Processing payment of $</span><span class="p">{</span><span class="n">amount</span><span class="p">}</span><span class="s"> using </span><span class="p">{</span><span class="n">cardDetails</span><span class="p">}</span><span class="s">..."</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">true</span><span class="p">;</span> <span class="c1">// Assume payment is successful</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">public</span> <span class="k">class</span> <span class="nc">ShippingSystem</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">ScheduleDelivery</span><span class="p">(</span><span class="kt">string</span> <span class="n">item</span><span class="p">,</span> <span class="kt">string</span> <span class="n">address</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Scheduling delivery of </span><span class="p">{</span><span class="n">item</span><span class="p">}</span><span class="s"> to </span><span class="p">{</span><span class="n">address</span><span class="p">}</span><span class="s">..."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">NotificationService</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">SendOrderConfirmation</span><span class="p">(</span><span class="kt">string</span> <span class="n">email</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Sending order confirmation email to </span><span class="p">{</span><span class="n">email</span><span class="p">}</span><span class="s">..."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Define Facade</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">OrderProcessingFacade</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">InventorySystem</span> <span class="n">_inventorySystem</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">PaymentGateway</span> <span class="n">_paymentGateway</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">ShippingSystem</span> <span class="n">_shippingSystem</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">readonly</span> <span class="n">NotificationService</span> <span class="n">_notificationService</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">OrderProcessingFacade</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">_inventorySystem</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">InventorySystem</span><span class="p">();</span>
            <span class="n">_paymentGateway</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PaymentGateway</span><span class="p">();</span>
            <span class="n">_shippingSystem</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ShippingSystem</span><span class="p">();</span>
            <span class="n">_notificationService</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">NotificationService</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">PlaceOrder</span><span class="p">(</span><span class="kt">string</span> <span class="n">item</span><span class="p">,</span> <span class="kt">string</span> <span class="n">cardDetails</span><span class="p">,</span> <span class="kt">decimal</span> <span class="n">amount</span><span class="p">,</span> <span class="kt">string</span> <span class="n">address</span><span class="p">,</span> <span class="kt">string</span> <span class="n">email</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Starting order processing..."</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(!</span><span class="n">_inventorySystem</span><span class="p">.</span><span class="nf">CheckStock</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Item is out of stock."</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">_inventorySystem</span><span class="p">.</span><span class="nf">UpdateInventory</span><span class="p">();</span>

            <span class="k">if</span> <span class="p">(!</span><span class="n">_paymentGateway</span><span class="p">.</span><span class="nf">ProcessPayment</span><span class="p">(</span><span class="n">cardDetails</span><span class="p">,</span> <span class="n">amount</span><span class="p">))</span>
            <span class="p">{</span>
                <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Payment failed."</span><span class="p">);</span>
                <span class="k">return</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">_shippingSystem</span><span class="p">.</span><span class="nf">ScheduleDelivery</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">address</span><span class="p">);</span>
            <span class="n">_notificationService</span><span class="p">.</span><span class="nf">SendOrderConfirmation</span><span class="p">(</span><span class="n">email</span><span class="p">);</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Order processed successfully!"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Client</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">var</span> <span class="n">orderFacade</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">OrderProcessingFacade</span><span class="p">();</span>

            <span class="c1">// Order details</span>
            <span class="kt">string</span> <span class="n">item</span> <span class="p">=</span> <span class="s">"Laptop"</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">cardDetails</span> <span class="p">=</span> <span class="s">"1234-5678-9876-5432"</span><span class="p">;</span>
            <span class="kt">decimal</span> <span class="n">amount</span> <span class="p">=</span> <span class="m">1200.00m</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">address</span> <span class="p">=</span> <span class="s">"123 Main St, Toronto, ON"</span><span class="p">;</span>
            <span class="kt">string</span> <span class="n">email</span> <span class="p">=</span> <span class="s">"customer@example.com"</span><span class="p">;</span>

            <span class="c1">// Place the order</span>
            <span class="n">orderFacade</span><span class="p">.</span><span class="nf">PlaceOrder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">cardDetails</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">email</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p><strong>Output</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting order processing...
Checking stock for Laptop...
Updating inventory...
Processing payment of $1200.00 using 1234-5678-9876-5432...
Scheduling delivery of Laptop to 123 Main St, Toronto, ON...
Sending order confirmation email to customer@example.com...
Order processed successfully!
</code></pre></div></div>

<p><strong>How it Works:</strong></p>
<ul>
  <li>Subsystems handle specific operations like checking stocks, processing payments, scheduling deliveries, and sending notifications.</li>
  <li>The <code class="language-plaintext highlighter-rouge">OrderProcessingFacade</code> encapsulates the interactions with these subsystems, providing a single entry point for order processing using the <code class="language-plaintext highlighter-rouge">PlaceOrder</code> method.</li>
  <li>The client interacts with the <code class="language-plaintext highlighter-rouge">OrderProcessingFacade</code> to place an order, simplifying the complex workflow into a single method call.</li>
</ul>

<p><strong>Benefits of the Facade Design Pattern</strong></p>
<ul>
  <li>Simplified Client Interaction: The client only needs to call one method.</li>
  <li>Encapsulation of Complexity: Subsystems are hidden from the client.</li>
  <li>Improved Maintainability: Changes to subsystems are isolated from the client.</li>
  <li>Code Reusability: The Facade can be reused across different parts of the application.</li>
</ul>

<p><strong>Conclusion</strong>
The Facade Design Pattern is an essential tool for developers to manage complex systems in a scalable and maintainable way. In our e-commerce example, it transformed a complicated order-processing workflow into a straightforward client interaction. By applying this pattern, you can make your applications more user-friendly and robust, whether you‚Äôre working on e-commerce platforms, multimedia systems, or any other domain.</p>

<p>Happy coding!</p>

<p><strong><a href="https://github.com/mahedee/code-sample02/tree/master/ECommerceFacade">Source code</a></strong></p>]]></content><author><name>Mahedee Hasan</name></author><category term="C#" /><category term="Design Pattern" /><category term="Software Architecture" /><category term="csharp" /><category term="design-pattern" /><category term="software-architecture" /><category term="facade-pattern" /><summary type="html"><![CDATA[Discover how the Facade Design Pattern simplifies e-commerce order processing by unifying complex subsystems into a single interface. This article provides a step-by-step C# implementation to streamline order workflows and enhance maintainability.]]></summary></entry><entry><title type="html">Simplifying Complex Systems: 10 Real-World Use Cases of the Facade Design Pattern</title><link href="https://mahedee.net/facade_design_pattern_real_world_use_cases/" rel="alternate" type="text/html" title="Simplifying Complex Systems: 10 Real-World Use Cases of the Facade Design Pattern" /><published>2025-02-04T00:00:00-05:00</published><updated>2025-02-04T00:00:00-05:00</updated><id>https://mahedee.net/facade_design_pattern_real_world_use_cases</id><content type="html" xml:base="https://mahedee.net/facade_design_pattern_real_world_use_cases/"><![CDATA[<p>In software development, complexity is often a necessary evil. Large systems typically consist of multiple components that interact with one another in intricate ways. The Facade Design Pattern offers a simple yet powerful solution to manage this complexity by providing a unified interface to a set of subsystems. This article explores the essence of the Facade Pattern and its application in 10 real-world scenarios.</p>

<p><strong>What is the Facade Design Pattern?</strong>
The Facade Design Pattern is a structural design pattern that simplifies interactions with complex systems. It introduces a single class, called the Facade, which provides a streamlined interface to underlying subsystems. This pattern promotes ease of use, enhances maintainability, and decouples high-level modules from low-level implementation details.</p>

<p><strong>Key Components of the Facade Pattern</strong></p>
<ul>
  <li><strong>Facade:</strong> The central interface that interacts with the client and coordinates with subsystems.</li>
  <li><strong>Subsystems:</strong> The complex internal modules that perform specific functionalities.</li>
  <li><strong>Client:</strong> The external entity that uses the facade to interact with the system.</li>
</ul>

<p><strong>How the Facade Pattern Works</strong></p>
<ul>
  <li>The client sends a request to the facade.</li>
  <li>The facade coordinates with relevant subsystems to fulfill the request.</li>
  <li>The subsystems execute their specific tasks, abstracted from the client.
This process simplifies interactions and allows the client to focus on the primary functionalities without being burdened by the system‚Äôs complexities.</li>
</ul>

<p><strong>Real World Use Cases of the Facade Pattern</strong></p>

<p><strong>Home Automation System</strong></p>

<p><strong>Problem:</strong> A home automation system consists of various components such as lighting, security, and temperature control. Managing these subsystems individually can be cumbersome.</p>

<p><strong>Solution:</strong> A facade class encapsulates the interactions with each subsystem, providing a unified interface for controlling the entire home environment.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade:  HomeAutomationFacade</li>
  <li>Subsystems: LightingSystem, SecuritySystem, TemperatureControlSystem</li>
  <li>Client: HomeOwner</li>
</ul>

<p><strong>How It Works:</strong> The HomeAutomationFacade class exposes methods like turnOnLights(), enableSecurity(), and setTemperature() to the client. These methods internally coordinate with the respective subsystems to perform the desired actions.</p>

<p><strong>Benefits:</strong> Simplified control of multiple home automation components, reduced complexity for the homeowner, and improved system maintainability.</p>

<p><strong>Payment Gateway Integration</strong></p>

<p><strong>Problem:</strong> Integrating multiple payment gateways with different APIs and protocols can be challenging for e-commerce platforms.</p>

<p><strong>Solution:</strong> A facade class abstracts the complexities of payment gateway integration, providing a unified interface for processing payments.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: PaymentGatewayFacade</li>
  <li>Subsystems: PayPalGateway, StripeGateway, AuthorizeNetGateway</li>
  <li>Client: E-commerce Platform</li>
</ul>

<p><strong>How It Works:</strong> The PaymentGatewayFacade class exposes methods like processPayment() and refundPayment() to the client. These methods internally interact with the specific payment gateway subsystems based on the payment method chosen by the customer.</p>

<p><strong>Benefits:</strong> Seamless integration of multiple payment gateways, reduced development effort, and improved scalability for e-commerce platforms.</p>

<p><strong>E-commerce Checkout System</strong></p>

<p><strong>Problem:</strong> Managing the complexities of checkout processes, including payment, shipping, and order management, can be overwhelming for e-commerce applications.</p>

<p><strong>Solution:</strong> A facade class simplifies the checkout process by coordinating interactions with payment, shipping, and order subsystems.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: Checkout Manager</li>
  <li>Subsystems: Payment Gateway, Inventory, Shipping</li>
  <li>Client: E-commerce Customer</li>
</ul>

<p><strong>How It Works:</strong> During checkout, the facade manages inventory verification, payment processing, and shipping arrangements, abstracting these tasks from the user.</p>

<p><strong>Benefits:</strong> Streamlined checkout process, improved user experience, and enhanced maintainability of e-commerce applications.</p>

<p><strong>Operating System Interface</strong></p>

<p><strong>Problem:</strong> Interacting with low-level operating system functionalities can be complex and platform-dependent.</p>

<p><strong>Solution:</strong> A facade class provides a high-level interface to common operating system operations, shielding the client from underlying complexities.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: OSInterface</li>
  <li>Subsystems: Filesystem, Network, Process Management</li>
  <li>Client: Application Developer</li>
</ul>

<p><strong>How It Works:</strong> The OSInterface facade exposes methods like readFile(), writeFile(), and createProcess() to the client, which internally interact with the respective subsystems.</p>

<p><strong>Benefits:</strong> Platform-independent access to operating system functionalities, simplified development of system-level applications, and improved code portability.</p>

<p><strong>Travel Booking System</strong></p>

<p><strong>Problem:</strong> Coordinating bookings across multiple travel services, including flights, hotels, and car rentals, requires handling diverse APIs and data formats.</p>

<p><strong>Solution:</strong> A facade class abstracts the complexities of travel booking, providing a unified interface for managing reservations.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: TravelBookingFacade</li>
  <li>Subsystems: FlightBooking, HotelBooking, CarRental</li>
  <li>Client: Traveler</li>
</ul>

<p><strong>How It Works:</strong> The user selects a travel package through the Facade. The Facade communicates with each subsystem to finalize reservations and generate a single booking confirmation.</p>

<p><strong>Benefits:</strong> Simplified travel booking process, reduced complexity for travelers, and improved scalability for travel</p>

<p><strong>Social Media Integration</strong></p>

<p><strong>Problem:</strong> Integrating social media platforms for sharing content and user authentication involves managing multiple APIs and authorization mechanisms.</p>

<p><strong>Solution:</strong> A facade class abstracts the intricacies of social media integration, providing a unified interface for interacting with various platforms.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: SocialMediaFacade</li>
  <li>Subsystems: Facebook, Twitter, Instagram</li>
  <li>Client: Application User</li>
</ul>

<p><strong>How It Works:</strong> The SocialMediaFacade class exposes methods like sharePost(), authenticateUser(), and fetchProfile() to the client, which internally interacts with the respective social media subsystems.</p>

<p><strong>Benefits:</strong> Simplified social media integration, enhanced user engagement, and improved cross-platform compatibility for applications.</p>

<p><strong>Customer Relationship Management (CRM) System</strong></p>

<p><strong>Problem:</strong> Managing customer interactions, sales pipelines, and marketing campaigns across multiple channels can be complex for CRM applications.</p>

<p><strong>Solution:</strong> A facade class simplifies CRM operations by providing a unified interface for customer data management and communication.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: CRMFacade</li>
  <li>Subsystems: CustomerDatabase, SalesPipeline, MarketingCampaign</li>
  <li>Client: CRM User</li>
</ul>

<p><strong>How It Works:</strong> The CRMFacade class exposes methods like addCustomer(), createOpportunity(), and launchCampaign() to the client, which internally interacts with the CRM subsystems.</p>

<p><strong>Benefits:</strong> Streamlined customer management, improved sales efficiency, and enhanced marketing automation for CRM applications.</p>

<p><strong>Healthcare Management System</strong></p>

<p><strong>Problem:</strong> Healthcare systems involve managing patient records, appointment scheduling, and medical billing, which can be complex and time-consuming.</p>

<p><strong>Solution:</strong> A facade class simplifies healthcare operations by providing a unified interface for managing patient data and medical processes.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: HealthcareFacade</li>
  <li>Subsystems: PatientRecords, AppointmentScheduling, MedicalBilling</li>
  <li>Client: Healthcare Provider</li>
</ul>

<p><strong>How It Works:</strong> Doctors and staff interact with the Facade to fetch patient histories, book appointments, and generate bills, reducing complexity. For example, the HealthcareFacade class exposes methods like getPatientRecord(), scheduleAppointment(), and generateBill() to the client.</p>

<p><strong>Banking Transaction Systems</strong></p>

<p><strong>Problem:</strong> Banking systems need to coordinate account verification, balance checking, transaction execution, and notifications.</p>

<p><strong>Solution:</strong> A facade class simplifies banking transactions by providing a unified interface for managing account operations.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: BankingFacade</li>
  <li>Subsystems: AccountVerificationSystem, BalanceChecker, TransactionProcessor, NotificationSystem</li>
  <li>Client: Bank Customer</li>
</ul>

<p><strong>How It Works:</strong> The Facade ensures smooth execution of transactions by validating accounts, ensuring sufficient balance, completing the transaction, and notifying users. For example, the BankingFacade class exposes methods like verifyAccount(), checkBalance(), and processTransaction() to the client, which internally interacts with the respective banking subsystems.</p>

<p><strong>Benefits:</strong> Streamlined banking operations, improved transaction security, and enhanced user experience for bank customers.</p>

<p><strong>Enterprise Resource Planning (ERP) Systems</strong></p>

<p><strong>Problem:</strong> Managing supply chain, HR, finance, and production through separate modules can be overwhelming.</p>

<p><strong>Solution:</strong> A Facade offers a unified interface for employees to interact with the ERP system‚Äôs diverse modules.</p>

<p><strong>Key Components:</strong></p>
<ul>
  <li>Facade: ERPSystemFacade</li>
  <li>Subsystems: SupplyChainManagement, HRManagement, FinancialManagement, ProductionManagement</li>
  <li>Client: ERP User</li>
</ul>

<p><strong>How It Works:</strong> The Facade simplifies ERP operations by providing a single interface for accessing supply chain data, managing HR processes, tracking financial transactions, and monitoring production schedules.</p>

<p><strong>Benefits:</strong> Enhanced productivity, improved data visibility, and streamlined business processes for organizations.</p>

<p><strong>Conclusion</strong>
The Facade design pattern simplifies complex systems by providing a unified interface to interact with multiple subsystems. The Facade pattern is a structural design pattern that simplifies complex systems by providing a unified interface to interact with multiple subsystems. The Facade pattern is a structural design pattern that simplifies complex systems by providing a unified interface to interact with multiple subsystems.</p>]]></content><author><name>Mahedee Hasan</name></author><category term="Design Pattern" /><category term="Software Architecture" /><category term="design-pattern" /><category term="software-architecture" /><category term="facade-pattern" /><summary type="html"><![CDATA[Simplify complex software systems with the Facade Design Pattern. Explore its key components and discover 10 real-world use cases where it streamlines operations and enhances maintainability.]]></summary></entry><entry><title type="html">Simplifying Complex Systems with the Facade Design Pattern in C#</title><link href="https://mahedee.net/simplifying_complex_systems_with_the_facade_design_pattern_in_csharp/" rel="alternate" type="text/html" title="Simplifying Complex Systems with the Facade Design Pattern in C#" /><published>2025-01-03T00:00:00-05:00</published><updated>2025-01-03T00:00:00-05:00</updated><id>https://mahedee.net/simplifying_complex_systems_with_the_facade_design_pattern_in_csharp</id><content type="html" xml:base="https://mahedee.net/simplifying_complex_systems_with_the_facade_design_pattern_in_csharp/"><![CDATA[<p><strong>What is the Facade Design Pattern?</strong>
Facade pronounce as fuh-sahd (/f…ôÀàs…ëÀêd/) is a structural design pattern that provides a simplified interface to a complex system of classes, libraries, or APIs. It acts as a unified interface that hides the complexities of the underlying system and provides a more straightforward way to interact with it.</p>

<p><strong>Why use the Facade Design Pattern?</strong></p>
<ul>
  <li>Simplifies complex systems by providing a more intuitive interface.</li>
  <li>Decouples client code from implementation details.</li>
  <li>Makes code easier to understand, maintain, and extend.</li>
  <li>Promotes code reusability, modularity, and flexibility by encapsulating complex logic behind a simple interface.</li>
</ul>

<p><strong>Key components of the Facade Design Pattern:</strong></p>
<ul>
  <li><strong>Facade:</strong> The facade is a class that provides a simplified interface to the complex system. It delegates client requests to the appropriate subsystems.</li>
  <li><strong>Subsystem:</strong> These are the classes or components that make up the complex system. The facade delegates requests to these subsystems to perform specific tasks.</li>
  <li><strong>Client:</strong> The client is the code that interacts with the facade to access the system‚Äôs functionality. The client doesn‚Äôt need to know the details of the subsystems.</li>
</ul>

<p><strong>UML Class Diagram of the Facade Design Pattern:</strong></p>

<p><img src="/assets/images/posts/2025/facade-design-pattern.drawio.png" alt="" /></p>

<p><strong>How to implement the Observer Facade Pattern in C#?</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">FacadePattern</span>
<span class="p">{</span>
    <span class="c1">// Subsystem 1</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SubsystemA</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">OperationA</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"SubsystemA: OperationA executed."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Subsystem 2</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SubsystemB</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">OperationB</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"SubsystemB: OperationB executed."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Subsystem 3</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SubsystemC</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">OperationC</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"SubsystemC: OperationC executed."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Subsystem 4</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SubsystemD</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">OperationD</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"SubsystemD: OperationD executed."</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Facade</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Facade</span>
    <span class="p">{</span>
        <span class="k">private</span> <span class="n">SubsystemA</span> <span class="n">_subsystemA</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">SubsystemB</span> <span class="n">_subsystemB</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">SubsystemC</span> <span class="n">_subsystemC</span><span class="p">;</span>
        <span class="k">private</span> <span class="n">SubsystemD</span> <span class="n">_subsystemD</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">Facade</span><span class="p">(</span><span class="n">SubsystemA</span> <span class="n">subsystemA</span><span class="p">,</span> <span class="n">SubsystemB</span> <span class="n">subsystemB</span><span class="p">,</span> 
            <span class="n">SubsystemC</span> <span class="n">subsystemC</span><span class="p">,</span> <span class="n">SubsystemD</span> <span class="n">subsystemD</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_subsystemA</span> <span class="p">=</span> <span class="n">subsystemA</span><span class="p">;</span>
            <span class="n">_subsystemB</span> <span class="p">=</span> <span class="n">subsystemB</span><span class="p">;</span>
            <span class="n">_subsystemC</span> <span class="p">=</span> <span class="n">subsystemC</span><span class="p">;</span>
            <span class="n">_subsystemD</span> <span class="p">=</span> <span class="n">subsystemD</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">PerformOperation1</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Operation 1\n"</span> <span class="p">+</span>
                              <span class="s">"-----------"</span><span class="p">);</span>
            <span class="n">_subsystemA</span><span class="p">.</span><span class="nf">OperationA</span><span class="p">();</span>
            <span class="n">_subsystemB</span><span class="p">.</span><span class="nf">OperationB</span><span class="p">();</span>
            <span class="n">_subsystemC</span><span class="p">.</span><span class="nf">OperationC</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">PerformOperation2</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Operation 2\n"</span> <span class="p">+</span>
                              <span class="s">"-----------"</span><span class="p">);</span>
            <span class="n">_subsystemA</span><span class="p">.</span><span class="nf">OperationA</span><span class="p">();</span>
            <span class="n">_subsystemD</span><span class="p">.</span><span class="nf">OperationD</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="c1">// Client</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Create subsystems</span>
            <span class="kt">var</span> <span class="n">subsystemA</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SubsystemA</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">subsystemB</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SubsystemB</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">subsystemC</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SubsystemC</span><span class="p">();</span>
            <span class="kt">var</span> <span class="n">subsystemD</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SubsystemD</span><span class="p">();</span>

            <span class="c1">// Create facade</span>
            <span class="kt">var</span> <span class="n">facade</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Facade</span><span class="p">(</span><span class="n">subsystemA</span><span class="p">,</span> <span class="n">subsystemB</span><span class="p">,</span> <span class="n">subsystemC</span><span class="p">,</span> <span class="n">subsystemD</span><span class="p">);</span>

            <span class="c1">// Use facade to perform operations</span>
            <span class="n">facade</span><span class="p">.</span><span class="nf">PerformOperation1</span><span class="p">();</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">();</span>
            <span class="n">facade</span><span class="p">.</span><span class="nf">PerformOperation2</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p><strong>Output</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Operation 1
-----------
SubsystemA: OperationA executed.
SubsystemB: OperationB executed.
SubsystemC: OperationC executed.

Operation 2
-----------
SubsystemA: OperationA executed.
SubsystemD: OperationD executed.

</code></pre></div></div>

<p><strong>Conclusion</strong>
At the end of this article, you should have a good understanding of the Facade Design Pattern and how to implement it in C#. By using the Facade pattern, you can simplify complex systems, improve code readability, and make your codebase more maintainable and extensible. In the next article, I will discuss with some real-world examples of the Facade pattern.</p>

<p>Happy coding!</p>

<p><strong><a href="https://github.com/mahedee/code-sample02/tree/master/FacadePattern">Source code</a></strong></p>]]></content><author><name>Mahedee Hasan</name></author><category term="C#" /><category term="Design Pattern" /><category term="Software Architecture" /><category term="csharp" /><category term="design-pattern" /><category term="software-architecture" /><category term="facade-pattern" /><summary type="html"><![CDATA[Learn how to simplify complex systems with the Facade Design Pattern in C#. This article explores the key concepts behind the Facade pattern and demonstrates its implementation with a real-world example. Whether you're new to design patterns or looking to streamline your code, this guide will help you understand how to apply the Facade pattern to create cleaner and more manageable code.]]></summary></entry><entry><title type="html">Real-Time vs Persistent Notifications: Choosing Between Observer Pattern and Databases</title><link href="https://mahedee.net/real_time_vs_persistent_notifications_observer_pattern_or_databases/" rel="alternate" type="text/html" title="Real-Time vs Persistent Notifications: Choosing Between Observer Pattern and Databases" /><published>2024-12-02T00:00:00-05:00</published><updated>2024-12-02T00:00:00-05:00</updated><id>https://mahedee.net/real_time_vs_persistent_notifications_observer_pattern_or_databases</id><content type="html" xml:base="https://mahedee.net/real_time_vs_persistent_notifications_observer_pattern_or_databases/"><![CDATA[<p>In modern application development, delivering timely and accurate notifications is crucial to ensuring a seamless user experience. However, the mechanisms used to handle notifications can vary significantly depending on the application‚Äôs needs. Two commonly used approaches are the <strong>Observer Design Pattern</strong> for real-time notifications and <strong>databases</strong> for persistent notifications. This article delves into the differences between these methods, their practical use cases, and guidance on when to use each.</p>

<p><strong>Understanding the Basics</strong></p>

<p><strong>The Observer Pattern</strong><br />
The Observer pattern is a behavioral design pattern where an object, called the <strong>subject</strong>, maintains a list of its dependents, known as <strong>observers</strong>, and notifies them of any state changes. It is ideal for scenarios requiring <strong>real-time updates</strong>.</p>

<p><strong>Key Characteristics:</strong></p>
<ul>
  <li>Real-time notifications.</li>
  <li>Decouples subjects and observers.</li>
  <li>Flexible for dynamic subscription and unsubscription.</li>
</ul>

<p><strong>Example:</strong> Stock market applications notify registered users of price changes in real-time.</p>

<p><strong>Database-Driven Notifications</strong>
In contrast, databases are used to store notifications persistently. Applications periodically query the database or send notifications based on database triggers. This approach suits scenarios where users may not need immediate updates.</p>

<p><strong>Key Characteristics:</strong></p>
<ul>
  <li>Persistent data storage.</li>
  <li>Reliable for offline access.</li>
  <li>Better for historical data retrieval and reporting.</li>
</ul>

<p><strong>Example:</strong> Email notifications for account activity or billing reminders are generated and stored in a database before being sent to users.</p>

<p><strong>When to Use the Observer Pattern</strong></p>

<p><strong>1. Real-Time Updates</strong><br />
When users need <strong>instant notifications</strong> about events, such as:</p>
<ul>
  <li>Stock price changes.</li>
  <li>Live sports scores.</li>
  <li>Real-time chat applications.</li>
</ul>

<p><strong>Why Use Observer Pattern?</strong><br />
The Observer pattern‚Äôs ability to push updates immediately ensures users receive information without delay.</p>

<p><strong>2. Dynamic User Subscriptions</strong><br />
In scenarios where users frequently subscribe or unsubscribe to updates, such as:</p>
<ul>
  <li>News apps with customizable notifications.</li>
  <li>Weather updates for specific locations.</li>
</ul>

<p><strong>Why Use Observer Pattern?</strong><br />
The pattern dynamically manages subscriptions without requiring extensive database operations.</p>

<p><strong>3. Event-Driven Architectures</strong><br />
Applications with a high volume of <strong>events triggering actions</strong> benefit from the Observer pattern, such as:</p>
<ul>
  <li>IoT systems where sensors notify a central system of status changes.</li>
  <li>Gaming systems providing real-time alerts.</li>
</ul>

<p><strong>When to Use Databases for Notifications</strong></p>

<p><strong>1. Historical Data and Persistent Storage</strong><br />
When notifications need to be stored for later reference or analytics, such as:</p>
<ul>
  <li>Banking apps saving transaction alerts.</li>
  <li>E-commerce platforms storing order updates.</li>
</ul>

<p><strong>Why Use Databases?</strong><br />
Databases ensure data integrity and allow users to access past notifications at any time.</p>

<p><strong>2. Offline Notifications</strong><br />
For applications where users might not always be connected, such as:</p>
<ul>
  <li>Travel apps storing booking confirmations.</li>
  <li>Educational platforms saving course notifications.</li>
</ul>

<p><strong>Why Use Databases?</strong><br />
Databases allow notifications to persist until the user reconnects.</p>

<p><strong>3. Bulk Notifications</strong><br />
When sending notifications to a large user base, such as:</p>
<ul>
  <li>Marketing emails or SMS campaigns.</li>
  <li>System-wide announcements in corporate tools.</li>
</ul>

<p><strong>Why Use Databases?</strong><br />
Databases can batch-process notifications and ensure delivery to all recipients without overwhelming the system.</p>

<p><strong>Combining Observer Pattern and Databases</strong></p>

<p>Many applications blend both approaches for a balanced solution. For example:</p>
<ul>
  <li>A news app uses the Observer pattern to deliver breaking news in real-time and stores all notifications in a database for users to browse later.</li>
  <li>A stock trading app pushes real-time price alerts using the Observer pattern while persisting all alerts in a database for audit purposes.</li>
</ul>

<p><strong>How It Works:</strong></p>
<ol>
  <li>The Observer pattern handles immediate delivery.</li>
  <li>A separate service persists the notifications in a database.</li>
  <li>Users can access past notifications through database queries.</li>
</ol>

<p><strong>Advantages and Limitations</strong></p>

<p><strong>Observer Pattern</strong><br />
<strong>Advantages:</strong></p>
<ul>
  <li>Provides instant updates.</li>
  <li>Decouples components for better scalability.</li>
</ul>

<p><strong>Limitations:</strong></p>
<ul>
  <li>May become complex with too many observers.</li>
  <li>No built-in persistence for notifications.</li>
</ul>

<h3 id="databases">Databases</h3>
<p><strong>Advantages:</strong></p>
<ul>
  <li>Reliable for storing and retrieving data.</li>
  <li>Ensures notifications are available even if users are offline.</li>
</ul>

<p><strong>Limitations:</strong></p>
<ul>
  <li>Cannot deliver real-time updates without additional components like polling or WebSockets.</li>
</ul>

<p><strong>Choosing the Right Approach</strong></p>

<table>
  <thead>
    <tr>
      <th><strong>Criterion</strong></th>
      <th><strong>Observer Pattern</strong></th>
      <th><strong>Database</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Notification Speed</strong></td>
      <td>Real-time</td>
      <td>Slightly delayed</td>
    </tr>
    <tr>
      <td><strong>Persistence</strong></td>
      <td>Not built-in</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>Offline Access</strong></td>
      <td>No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>Dynamic Subscriptions</strong></td>
      <td>Highly suitable</td>
      <td>May require additional logic</td>
    </tr>
    <tr>
      <td><strong>Use Case Examples</strong></td>
      <td>Stock alerts, live sports updates</td>
      <td>Billing reminders, historical logs</td>
    </tr>
  </tbody>
</table>

<h2 id="conclusion">Conclusion</h2>

<p>The Observer pattern and databases serve distinct purposes in handling notifications. While the Observer pattern excels in real-time scenarios, databases provide reliability and persistence. Choosing the right approach‚Äîor combining both‚Äîdepends on your application‚Äôs specific requirements. By understanding their strengths and limitations, you can design a notification system that meets both immediate and long-term needs effectively.</p>]]></content><author><name>Mahedee Hasan</name></author><category term="Design Pattern" /><category term="Software Architecture" /><category term="Database" /><category term="design-pattern" /><category term="software-architecture" /><category term="observer-pattern" /><category term="database" /><summary type="html"><![CDATA[Deciding between real-time notifications with the Observer pattern and persistent updates using databases can be challenging. This article breaks down their differences, practical use cases, and when to choose each approach to optimize your application's performance and user experience.]]></summary></entry><entry><title type="html">Leveraging the Observer Design Pattern : 10 Real-World Examples in Action</title><link href="https://mahedee.net/leveraging_the_observer_design_pattern_10_real_world_examples_in_action/" rel="alternate" type="text/html" title="Leveraging the Observer Design Pattern : 10 Real-World Examples in Action" /><published>2024-11-01T00:00:00-04:00</published><updated>2024-11-01T00:00:00-04:00</updated><id>https://mahedee.net/leveraging_the_observer_design_pattern_10_real_world_examples_in_action</id><content type="html" xml:base="https://mahedee.net/leveraging_the_observer_design_pattern_10_real_world_examples_in_action/"><![CDATA[<p>The Observer Design Pattern is a behavioral design pattern that allows an object (the <strong>subject</strong>) to notify multiple dependent objects (the <strong>observers</strong>) about changes in its state without knowing who or what those observers are. This pattern is widely used in software systems that require real-time updates or notifications. In this article, we will explore 10 real-world applications where the Observer Pattern is used to enable real-time communication, updates, or notifications.</p>

<p><strong>1. Social Media Notifications</strong></p>

<p><strong>Description:</strong>
Social media platforms, such as Facebook, Twitter, and Instagram, notify users of likes, comments, shares, and messages. These notifications keep users engaged and informed of activities on their posts and accounts they follow.</p>

<p><strong>Observer:</strong>
Users who follow posts, pages, or accounts and receive updates about activities on them.</p>

<p><strong>Subject:</strong>
Posts, accounts, or events that trigger notifications.</p>

<p><strong>How It Works:</strong>
When a user subscribes to a post or account, the system treats them as observers. When an activity (like, comment, share) occurs on the post, the platform (subject) notifies all the users observing it.</p>

<p><strong>2. Chat Applications</strong></p>

<p><strong>Description:</strong>
Messaging platforms, like WhatsApp and Slack, send real-time notifications to users when they receive new messages or mentions. This allows users to stay up-to-date with conversations even when they aren‚Äôt actively looking at the app.</p>

<p><strong>Observer:</strong>
Members of a chat group or users in a direct message thread.</p>

<p><strong>Subject:</strong>
The chat group or message thread where new messages are posted.</p>

<p><strong>How It Works:</strong>
Users subscribe to chat groups or message threads. When a new message is posted, the system (subject) notifies all users observing that group or conversation.</p>

<p><strong>3. Online Shopping and Stock Alerts</strong></p>

<p><strong>Description:</strong>
E-commerce platforms such as Amazon and eBay use the Observer Pattern to notify users about price changes, product restocks, or special promotions.</p>

<p><strong>Observer:</strong>
Customers who subscribe to updates for specific products.</p>

<p><strong>Subject:</strong>
The product or offer being tracked by the customer.</p>

<p><strong>How It Works:</strong>
Customers subscribe to specific products, and when any change occurs (e.g., price drop, availability), the platform (subject) notifies all users who have subscribed to that product.</p>

<p><strong>4. Event-Driven Monitoring Systems</strong></p>

<p><strong>Description:</strong>
IT infrastructure monitoring tools, such as Nagios and Datadog, monitor various metrics (e.g., server uptime, CPU usage, or disk space) and alert system administrators when an issue arises.</p>

<p><strong>Observer:</strong>
System administrators or monitoring teams who need real-time alerts.</p>

<p><strong>Subject:</strong>
The monitored system or resource, such as a server or application.</p>

<p><strong>How It Works:</strong>
The system (subject) tracks key metrics (e.g., CPU usage). If the metric crosses a predefined threshold, the system triggers a notification to all observers (admins) who are subscribed to the metric.</p>

<p><strong>5. News Feed Subscriptions</strong></p>

<p><strong>Description:</strong>
News platforms like Google News, BBC, and CNN allow users to follow specific topics, authors, or categories. When a new article is published under a subscribed category or by a followed author, users are notified immediately.</p>

<p><strong>Observer:</strong>
Users who subscribe to categories or authors.</p>

<p><strong>Subject:</strong>
Articles or content within a specific category or published by a specific author.</p>

<p><strong>How It Works:</strong>
When new content is published, the platform (subject) sends real-time updates to all users who are observing the particular topic or author.</p>

<p><strong>6. Gaming Leaderboards</strong></p>

<p><strong>Description:</strong>
Online games, like Fortnite or PUBG, notify players of leaderboard changes, upcoming challenges, or rewards.</p>

<p><strong>Observer:</strong>
Players who track the game‚Äôs leaderboard or their in-game performance.</p>

<p><strong>Subject:</strong>
The game‚Äôs leaderboard or event system.</p>

<p><strong>How It Works:</strong>
Players subscribe to notifications about leaderboard updates. When their rank changes or when a new event is available, the game (subject) sends an update to the players observing the leaderboard.</p>

<p><strong>7. IoT Systems</strong></p>

<p><strong>Description:</strong>
Smart home devices, such as thermostats (Nest), security cameras, and smart lights, notify users of changes or status updates in real time.</p>

<p><strong>Observer:</strong>
Homeowners or users accessing the smart home system via an app or device.</p>

<p><strong>Subject:</strong>
IoT devices, such as cameras, thermostats, or motion detectors.</p>

<p><strong>How It Works:</strong>
The IoT system (subject) monitors connected devices. When a change occurs (e.g., door opens, temperature rises), the system sends notifications to the users (observers) who are subscribed to those events.</p>

<p><strong>8. Auction Platforms</strong></p>

<p><strong>Description:</strong>
Auction platforms, such as eBay, notify participants of new bids, bid price changes, or auction closing times.</p>

<p><strong>Observer:</strong>
Bidders participating in an auction.</p>

<p><strong>Subject:</strong>
The auction itself, including the item being sold.</p>

<p><strong>How It Works:</strong>
When users place bids on an item, they subscribe to updates. If a bid is placed or the auction is about to close, the platform (subject) notifies all active bidders.</p>

<p><strong>9. Real-Time Traffic Updates</strong></p>

<p><strong>Description:</strong>
Navigation apps like Google Maps and Waze notify users about traffic conditions, road closures, or new incidents along their route.</p>

<p><strong>Observer:</strong>
Drivers using the navigation system.</p>

<p><strong>Subject:</strong>
The route being taken by the user and the traffic data related to it.</p>

<p><strong>How It Works:</strong>
When drivers enter a route, they subscribe to real-time updates. The navigation system (subject) continuously monitors traffic data, and when there‚Äôs a change (e.g., a crash or road closure), it sends an update to users along the route.</p>

<p><strong>10. Stock Market and Cryptocurrency Tracking</strong></p>

<p><strong>Description:</strong>
Stock market applications such as Robinhood, E*TRADE, or cryptocurrency platforms like Coinbase notify users of price changes, market trends, or news affecting the stocks or cryptocurrencies they are following.</p>

<p><strong>Observer:</strong>
Investors or traders who are tracking specific financial assets.</p>

<p><strong>Subject:</strong>
The asset (e.g., a stock, cryptocurrency) being tracked.</p>

<p><strong>How It Works:</strong>
Users subscribe to specific stocks or cryptocurrencies. When the price or market trend changes, the system (subject) sends an update to all observers who have subscribed to the asset.</p>

<p><strong>Conclusion</strong></p>

<p>The Observer Design Pattern is invaluable when building systems that require real-time updates or notifications. Whether it‚Äôs used for social media notifications, real-time chat alerts, or system monitoring, the Observer pattern ensures that interested parties are notified as soon as an update occurs, improving responsiveness and interactivity. Understanding its real-world applications can help in architecting software systems that are both efficient and scalable.</p>]]></content><author><name>Mahedee Hasan</name></author><category term="Design Pattern" /><category term="Software Architecture" /><category term="design-pattern" /><category term="software-architecture" /><category term="observer-pattern" /><summary type="html"><![CDATA[Discover how the Observer design pattern transforms real-world applications with real-time updates and notifications. In this article, we explore 10 practical examples, from stock market alerts to weather updates, showcasing how subjects and observers work together seamlessly to deliver dynamic user experiences.]]></summary></entry><entry><title type="html">Observer Design Pattern: Create a Real-Time Stock Market Notification System in C#</title><link href="https://mahedee.net/observer_design_pattern_real_time_stock_market_notification_csharp/" rel="alternate" type="text/html" title="Observer Design Pattern: Create a Real-Time Stock Market Notification System in C#" /><published>2024-10-11T00:00:00-04:00</published><updated>2024-10-11T00:00:00-04:00</updated><id>https://mahedee.net/observer_design_pattern_real_time_stock_market_notification_csharp</id><content type="html" xml:base="https://mahedee.net/observer_design_pattern_real_time_stock_market_notification_csharp/"><![CDATA[<p><strong>What is the Observer Design Pattern?</strong>
The Observer Design Pattern is a behavioral design pattern that allows objects to be notified of changes to other objects‚Äô states. It establishes a one-to-many dependency between objects, where the subject (the object being observed) maintains a list of observers (objects that are interested in its state) and notifies them of any changes.</p>

<p><strong>Why use the Observer Design Pattern?</strong>
The Observer pattern is useful when you need to notify multiple objects of changes to a single object‚Äôs state without tightly coupling them. It promotes loose coupling between objects, making it easier to maintain and extend the system. It is commonly used in event-driven systems, such as GUI frameworks, real-time monitoring systems, and notification systems.</p>

<p><strong>Key components of the Observer Design Pattern:</strong></p>
<ol>
  <li><strong>Subject</strong>: The object being observed, which maintains a list of observers and notifies them of changes to its state.</li>
  <li><strong>Observer</strong>: The object that is interested in the subject‚Äôs state and receives notifications when the subject‚Äôs state changes.</li>
  <li><strong>Concrete Subject</strong>: A specific implementation of the subject that contains the state to be observed.</li>
  <li><strong>Concrete Observer</strong>: A specific implementation of the observer that receives notifications from the subject.</li>
  <li><strong>Attach / Registration</strong>: The process of adding an observer to the subject‚Äôs list of observers.</li>
  <li><strong>Detach / Deregistration</strong>: The process of removing an observer from the subject‚Äôs list of observers.</li>
  <li><strong>Notify</strong>: The process of notifying all observers of changes to the subject‚Äôs state.</li>
</ol>

<p><strong>UML Class Diagram of the Observer Design Pattern:</strong></p>

<p><img src="/assets/images/posts/2024/observer-design-pattern.drawio.png" alt="" /></p>

<p><strong>How to implement the Observer Design Pattern in C#?</strong></p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ObserverPattern</span>
<span class="p">{</span>
    <span class="c1">// IObserver interface is used to update all the observers</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">IObserver</span>
    <span class="p">{</span>
        <span class="c1">// Update method is called when the subject changes</span>
        <span class="k">void</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">state</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Interface for the subject</span>
    <span class="c1">// It has methods to attach, detach and notify the observers</span>
    <span class="k">public</span> <span class="k">interface</span> <span class="nc">ISubject</span>
    <span class="p">{</span>
        <span class="k">void</span> <span class="nf">Attach</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">);</span>
        <span class="k">void</span> <span class="nf">Detach</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">);</span>
        <span class="k">void</span> <span class="nf">Notify</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="c1">// Concreate Subject class</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ConcreateSubject</span> <span class="p">:</span> <span class="n">ISubject</span>
    <span class="p">{</span>
        <span class="c1">// List of observers attached to the subject</span>
        <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&gt;</span> <span class="n">_observers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&gt;();</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_subjectState</span><span class="p">;</span>

        <span class="k">public</span> <span class="kt">string</span> <span class="n">SubjectState</span>
        <span class="p">{</span>
            <span class="k">get</span> <span class="p">=&gt;</span> <span class="n">_subjectState</span><span class="p">;</span>

            <span class="c1">// When the state changes of subject, notify all the observers</span>
            <span class="k">set</span>
            <span class="p">{</span>
                <span class="n">_subjectState</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
                <span class="c1">// Call Notify method to notify all the observers</span>
                <span class="nf">Notify</span><span class="p">();</span> 
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Attach</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_observers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="nf">Detach</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_observers</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// Notify all the observers</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Notify</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">// Call Update method of all the observers attached to the subject</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">observer</span> <span class="k">in</span> <span class="n">_observers</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">observer</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">_subjectState</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Concrete Observer class</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">ConcreateObserver</span> <span class="p">:</span> <span class="n">IObserver</span>
    <span class="p">{</span>
        <span class="c1">// Used to set the name of the observer</span>
        <span class="k">private</span> <span class="kt">string</span> <span class="n">_observerName</span><span class="p">;</span>

        <span class="k">public</span> <span class="nf">ConcreateObserver</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">_observerName</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">state</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"</span><span class="p">{</span><span class="n">_observerName</span><span class="p">}</span><span class="s"> received update: State changed to </span><span class="p">{</span><span class="n">state</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="k">internal</span> <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Create a subject</span>
            <span class="n">ConcreateSubject</span> <span class="n">subject</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConcreateSubject</span><span class="p">();</span>

            <span class="c1">// Create observers</span>
            <span class="n">IObserver</span> <span class="n">observer1</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConcreateObserver</span><span class="p">(</span><span class="s">"Observer-1"</span><span class="p">);</span>
            <span class="n">IObserver</span> <span class="n">observer2</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConcreateObserver</span><span class="p">(</span><span class="s">"Observer-2"</span><span class="p">);</span>
            <span class="n">IObserver</span> <span class="n">observer3</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ConcreateObserver</span><span class="p">(</span><span class="s">"Observer-3"</span><span class="p">);</span>

            <span class="c1">// Attach the observers to the subject</span>
            <span class="n">subject</span><span class="p">.</span><span class="nf">Attach</span><span class="p">(</span><span class="n">observer1</span><span class="p">);</span>
            <span class="n">subject</span><span class="p">.</span><span class="nf">Attach</span><span class="p">(</span><span class="n">observer2</span><span class="p">);</span>
            <span class="n">subject</span><span class="p">.</span><span class="nf">Attach</span><span class="p">(</span><span class="n">observer3</span><span class="p">);</span>

            <span class="c1">// Change the state of the subject</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing state to State 1"</span><span class="p">);</span>
            <span class="n">subject</span><span class="p">.</span><span class="n">SubjectState</span> <span class="p">=</span> <span class="s">"State-1"</span><span class="p">;</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing state to State 2"</span><span class="p">);</span>
            <span class="n">subject</span><span class="p">.</span><span class="n">SubjectState</span> <span class="p">=</span> <span class="s">"State-2"</span><span class="p">;</span>

            <span class="c1">// Detach observer 1</span>
            <span class="n">subject</span><span class="p">.</span><span class="nf">Detach</span><span class="p">(</span><span class="n">observer1</span><span class="p">);</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing state to State 3"</span><span class="p">);</span>
            <span class="n">subject</span><span class="p">.</span><span class="n">SubjectState</span> <span class="p">=</span> <span class="s">"State-3"</span><span class="p">;</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Output</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Changing state to State 1
Observer-1 received update: State changed to State-1
Observer-2 received update: State changed to State-1
Observer-3 received update: State changed to State-1
Changing state to State 2
Observer-1 received update: State changed to State-2
Observer-2 received update: State changed to State-2
Observer-3 received update: State changed to State-2
Changing state to State 3
Observer-2 received update: State changed to State-3
Observer-3 received update: State changed to State-3
</code></pre></div></div>

<p><strong>Use Case: Real-Time Stock Market Notification System</strong>
Imagine a stock market application where traders are notified every time the price of a stock changes. In this scenario, the stock price is the subject, and the traders are the observers. When the price of a stock changes, all the traders who are interested in that stock should be notified of the change. Let‚Äôs implement this use case using the Observer Design Pattern in C#.</p>

<p><strong>UML Class Diagram of the Real-Time Stock Market Notification System:</strong></p>

<p><img src="/assets/images/posts/2024/observer-design-pattern-stock-notification.drawio.png" alt="" /></p>

<p><strong>Implementation of the Real-Time Stock Market Notification System in C#</strong></p>

<p><strong>Step 1: Define the Observer Interface</strong>
The observer interface provides a common contract for all observers to implement.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">interface</span> <span class="nc">IObserver</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">symbol</span><span class="p">,</span> <span class="kt">decimal</span> <span class="n">price</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<p><strong>Step 2: Define the Subject Interface</strong>
The subject interface defines the methods to register, unregister, and notify observers. Here we define it as <code class="language-plaintext highlighter-rouge">IStock</code>.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">interface</span> <span class="nc">IStock</span>
<span class="p">{</span>
    <span class="k">void</span> <span class="nf">Register</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">);</span>
    <span class="k">void</span> <span class="nf">Unregister</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">);</span>
    <span class="k">void</span> <span class="nf">Notify</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Step 3: Implement the Stock Class</strong>
The <code class="language-plaintext highlighter-rouge">Stock</code> class is a concrete subject that maintains the stock price and notifies the observers when the price changes.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Stock</span> <span class="p">:</span> <span class="n">IStock</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">string</span> <span class="n">_symbol</span><span class="p">;</span>
    <span class="k">private</span> <span class="kt">decimal</span> <span class="n">_price</span><span class="p">;</span>
    <span class="k">private</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&gt;</span> <span class="n">_observers</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">IObserver</span><span class="p">&gt;();</span>

    <span class="k">public</span> <span class="nf">Stock</span><span class="p">(</span><span class="kt">string</span> <span class="n">symbol</span><span class="p">,</span> <span class="kt">decimal</span> <span class="n">price</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_symbol</span> <span class="p">=</span> <span class="n">symbol</span><span class="p">;</span>
        <span class="n">_price</span> <span class="p">=</span> <span class="n">price</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Register</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_observers</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">void</span> <span class="nf">Unregister</span><span class="p">(</span><span class="n">IObserver</span> <span class="n">observer</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_observers</span><span class="p">.</span><span class="nf">Remove</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// If the price changes, notify the observers (traders)</span>
    <span class="c1">// Here we are calling the Notify method</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">UpdatePrice</span><span class="p">(</span><span class="kt">decimal</span> <span class="n">price</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">_price</span> <span class="p">=</span> <span class="n">price</span><span class="p">;</span>
        <span class="nf">Notify</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">public</span> <span class="k">void</span> <span class="nf">Notify</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">observer</span> <span class="k">in</span> <span class="n">_observers</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">observer</span><span class="p">.</span><span class="nf">Update</span><span class="p">(</span><span class="n">_symbol</span><span class="p">,</span> <span class="n">_price</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><strong>Step 4: Implement the Trader Class</strong>
The <code class="language-plaintext highlighter-rouge">Trader</code> class is a concrete observer that receives notifications when the stock price changes.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">public</span> <span class="k">class</span> <span class="nc">Trader</span> <span class="p">:</span> <span class="n">IObserver</span>
 <span class="p">{</span>
     <span class="c1">// The observer's name</span>
     <span class="k">private</span> <span class="kt">string</span> <span class="n">_name</span><span class="p">;</span>

     <span class="k">public</span> <span class="nf">Trader</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">_name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
     <span class="p">}</span>
     <span class="k">public</span> <span class="k">void</span> <span class="nf">Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">symbol</span><span class="p">,</span> <span class="kt">decimal</span> <span class="n">price</span><span class="p">)</span>
     <span class="p">{</span>
         <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">$"Notified </span><span class="p">{</span><span class="n">_name</span><span class="p">}</span><span class="s"> of </span><span class="p">{</span><span class="n">symbol</span><span class="p">}</span><span class="s">'s price change to </span><span class="p">{</span><span class="n">price</span><span class="p">}</span><span class="s">"</span><span class="p">);</span>
     <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div></div>

<p><strong>Step 5: Implement the Main Program</strong>
In the main program, we create a stock object and register traders as observers. When the stock price changes, the traders are notified.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>

    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Create a stock</span>
        <span class="n">Stock</span> <span class="n">stock</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Stock</span><span class="p">(</span><span class="s">"MSFT"</span><span class="p">,</span> <span class="m">100.00m</span><span class="p">);</span>

        <span class="c1">// Create some traders</span>
        <span class="n">Trader</span> <span class="n">joe</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Trader</span><span class="p">(</span><span class="s">"Joe"</span><span class="p">);</span>
        <span class="n">Trader</span> <span class="n">sally</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Trader</span><span class="p">(</span><span class="s">"Sally"</span><span class="p">);</span>

        <span class="c1">// Register/subscribe the traders</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Registering Joe and Sally"</span><span class="p">);</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="n">joe</span><span class="p">);</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">Register</span><span class="p">(</span><span class="n">sally</span><span class="p">);</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing stock price to 105.00m"</span><span class="p">);</span>
        <span class="c1">// Change the stock price</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">UpdatePrice</span><span class="p">(</span><span class="m">105.00m</span><span class="p">);</span>

        <span class="c1">// Change the stock price</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing stock price to 110.00m"</span><span class="p">);</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">UpdatePrice</span><span class="p">(</span><span class="m">110.00m</span><span class="p">);</span>

        <span class="c1">// Unregister/unsubscribe a trader</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Unregistering Joe"</span><span class="p">);</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">Unregister</span><span class="p">(</span><span class="n">joe</span><span class="p">);</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Changing stock price to 115.00m"</span><span class="p">);</span>
        <span class="c1">// Change the stock price</span>
        <span class="n">stock</span><span class="p">.</span><span class="nf">UpdatePrice</span><span class="p">(</span><span class="m">115.00m</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Now, when you run the program, you should see the following output:</p>

<p><strong>Output</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Registering Joe and Sally
Changing stock price to 105.00m
Notified Joe of MSFT's price change to 105.00
Notified Sally of MSFT's price change to 105.00
Changing stock price to 110.00m
Notified Joe of MSFT's price change to 110.00
Notified Sally of MSFT's price change to 110.00
Unregistering Joe
Changing stock price to 115.00m
Notified Sally of MSFT's price change to 115.00
</code></pre></div></div>

<p>Happy coding!</p>

<p><strong><a href="https://github.com/mahedee/code-sample02/tree/master/ObserverPattern">Source code</a></strong></p>]]></content><author><name>Mahedee Hasan</name></author><category term="C#" /><category term="Design Pattern" /><category term="Software Architecture" /><category term="csharp" /><category term="design-pattern" /><category term="software-architecture" /><category term="observer-pattern" /><summary type="html"><![CDATA[In this article, we'll explore the Observer Design Pattern and its practical application in building a real-time stock market notification system using C#. You'll learn how to implement this pattern to efficiently manage stock price updates and notify users in real-time. The article provides step-by-step instructions, code examples, and insights into how the Observer pattern can be used to build responsive and scalable notification systems.]]></summary></entry></feed>